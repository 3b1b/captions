1
00:00:00,000 --> 00:00:01,924
Давайте начнем с викторины.

2
00:00:01,924 --> 00:00:06,428
Предположим, я беру нормальное распределение со знакомой формой колоколообразной

3
00:00:06,428 --> 00:00:10,320
кривой и имею случайную величину x, полученную из этого распределения.

4
00:00:10,320 --> 00:00:14,800
Итак, то, на что вы сейчас смотрите, — это повторяющиеся выборки этой случайной величины.

5
00:00:14,800 --> 00:00:18,305
И в качестве быстрого напоминания: способ интерпретации этой кривой, то,

6
00:00:18,305 --> 00:00:20,946
что на самом деле означает функция, заключается в том,

7
00:00:20,946 --> 00:00:24,500
что если вам нужна вероятность того, что ваша выборка попадает в заданный

8
00:00:24,500 --> 00:00:27,765
диапазон значений, скажите вероятность того, что она окажется между

9
00:00:27,765 --> 00:00:31,415
отрицательными единицей и двумя. , ну, это будет равняться площади под этой

10
00:00:31,415 --> 00:00:33,000
кривой в этом диапазоне значений.

11
00:00:33,000 --> 00:00:35,200
Вот что на самом деле означает кривая.

12
00:00:35,200 --> 00:00:39,082
Я также возьму вторую случайную величину, также имеющую нормальное распределение, но,

13
00:00:39,082 --> 00:00:41,384
возможно, на этот раз с немного большим разбросом,

14
00:00:41,384 --> 00:00:43,280
с немного большим стандартным отклонением.

15
00:00:43,280 --> 00:00:44,682
И вот вам викторина.

16
00:00:44,682 --> 00:00:49,457
Если вы неоднократно выбираете обе эти переменные и на каждой итерации суммируете

17
00:00:49,457 --> 00:00:54,000
два результата, тогда эта сумма ведет себя как собственная случайная величина.

18
00:00:54,000 --> 00:00:59,120
И вопрос в том, какое распределение описывает ту сумму, на которую вы смотрите?

19
00:00:59,120 --> 00:01:02,209
Вы думаете об этом на мгновение, может быть, у вас есть предположение,

20
00:01:02,209 --> 00:01:06,126
может быть, вы думаете: я не знаю, это другое нормальное распределение или что-то другое,

21
00:01:06,126 --> 00:01:07,040
имеющее другую форму.

22
00:01:07,040 --> 00:01:09,690
Излишне говорить, что гадать недостаточно.

23
00:01:09,690 --> 00:01:12,859
Настоящая викторина заключается в том, чтобы суметь объяснить,

24
00:01:12,859 --> 00:01:14,720
почему вы получаете именно тот ответ.

25
00:01:14,720 --> 00:01:18,793
В этом случае, если у вас есть до мозга костей интуитивное понимание того,

26
00:01:18,793 --> 00:01:22,594
почему ответ именно такой, вы будете далеко на пути к пониманию того,

27
00:01:22,594 --> 00:01:25,744
почему нормальное распределение выполняет особую функцию,

28
00:01:25,744 --> 00:01:28,080
которую оно выполняет в теории вероятности.

29
00:01:28,080 --> 00:01:32,464
Однако если уменьшить масштаб, то на самом деле это гораздо более общий урок о том,

30
00:01:32,464 --> 00:01:36,482
как складывать две разные случайные величины независимо от их распределения,

31
00:01:36,482 --> 00:01:39,040
а не обязательно только нормально распределенных.

32
00:01:39,040 --> 00:01:43,016
Это представляет собой специальную операцию, которую вы применяете к распределениям,

33
00:01:43,016 --> 00:01:44,560
лежащим в основе этих переменных.

34
00:01:44,560 --> 00:01:47,840
У операции есть специальное название — свертка.

35
00:01:47,840 --> 00:01:52,157
И главное, что мы с вами сделаем сегодня, — это мотивируем и создадим два различных

36
00:01:52,157 --> 00:01:55,908
способа визуализации того, как выглядит свертка для непрерывных функций,

37
00:01:55,908 --> 00:02:00,020
а затем поговорим о том, как каждая из этих двух разных визуализаций может быть

38
00:02:00,020 --> 00:02:04,388
полезна по-разному, с помощью специального сосредоточьтесь на центральной предельной

39
00:02:04,388 --> 00:02:04,800
теореме.

40
00:02:04,800 --> 00:02:08,790
После того, как мы проведем общий урок, я хочу вернуться к вступительному

41
00:02:08,790 --> 00:02:12,080
тесту и предложить необычайно приятный способ ответа на него.

42
00:02:12,080 --> 00:02:15,022
В качестве небольшого примечания: постоянные зрители среди вас,

43
00:02:15,022 --> 00:02:17,920
возможно, знают, что на этом канале уже есть видео о извилинах.

44
00:02:17,920 --> 00:02:20,389
Но у этого случая была совершенно другая направленность:

45
00:02:20,389 --> 00:02:24,071
мы рассматривали только дискретный случай, и я хотел показать не только вероятность,

46
00:02:24,071 --> 00:02:26,800
но и способы, которыми она возникает в самых разных контекстах.

47
00:02:26,800 --> 00:02:30,452
Я нахожусь в некоторой неловкой ситуации, потому что на самом деле нет смысла делать это

48
00:02:30,452 --> 00:02:32,545
обязательным условием для этого видео, но я думаю,

49
00:02:32,545 --> 00:02:35,952
что лучший способ разогреться сегодня - это рассмотреть по существу один из тех же

50
00:02:35,952 --> 00:02:37,840
примеров, которые использовались в этом видео.

51
00:02:37,840 --> 00:02:41,680
Так что, если вы идете прямо оттуда, вы, вероятно, можете смело пропустить вперед.

52
00:02:41,680 --> 00:02:47,040
В противном случае, давайте сразу погрузимся.

53
00:02:47,040 --> 00:02:50,991
В этом вступительном вопросе каждая из случайных величин может принимать значение

54
00:02:50,991 --> 00:02:55,040
в непрерывном бесконечном диапазоне значений — всех возможных действительных числах.

55
00:02:55,040 --> 00:02:59,646
Будет намного проще, если мы разогреемся в более дискретной и ограниченной обстановке,

56
00:02:59,646 --> 00:03:02,400
например, в броске пары взвешенных игральных костей.

57
00:03:02,400 --> 00:03:06,733
Здесь анимация, на которую вы смотрите, имитирует два взвешенных кубика, и вы,

58
00:03:06,733 --> 00:03:11,012
вероятно, можете сказать, что происходит, но просто чтобы объяснить это явно:

59
00:03:11,012 --> 00:03:15,894
синий кубик следует распределению, которое, кажется, смещено в сторону меньших значений,

60
00:03:15,894 --> 00:03:19,899
красный die имеет четкое распределение, и я неоднократно беру выборку из

61
00:03:19,899 --> 00:03:23,520
каждого из них и записываю сумму двух значений на каждой итерации.

62
00:03:23,520 --> 00:03:26,407
Повторение подобных выборок много-много раз может дать вам

63
00:03:26,407 --> 00:03:29,343
эвристическое представление об окончательном распределении,

64
00:03:29,343 --> 00:03:32,720
но наша настоящая задача сегодня — точно вычислить это распределение.

65
00:03:32,720 --> 00:03:39,760
Какова точная вероятность выпадения 2, 3, 4 или 5 для всех возможностей?

66
00:03:39,760 --> 00:03:42,100
Это не слишком сложный вопрос, я бы посоветовал вам

67
00:03:42,100 --> 00:03:44,800
сделать паузу и попытаться разобраться в нем самостоятельно.

68
00:03:44,800 --> 00:03:48,920
Основная цель этого разминочного раздела — рассмотреть два

69
00:03:48,920 --> 00:03:53,040
различных способа визуализации лежащих в основе вычислений.

70
00:03:53,040 --> 00:03:55,999
Например, вы можете начать думать об этом так:

71
00:03:55,999 --> 00:03:58,958
существует 36 различных возможных результатов,

72
00:03:58,958 --> 00:04:02,800
и мы можем организовать эти результаты в небольшой сетке 6x6.

73
00:04:02,800 --> 00:04:07,901
Теперь, если бы я спросил вас, какова вероятность увидеть любой из этих конкретных

74
00:04:07,901 --> 00:04:12,880
результатов, скажем, вероятность увидеть синюю 4 и красную 2, что бы вы ответили?

75
00:04:12,880 --> 00:04:16,625
Мы могли бы сказать, что это должна быть вероятность синей 4,

76
00:04:16,625 --> 00:04:18,800
умноженная на вероятность красной 2.

77
00:04:18,800 --> 00:04:23,440
И это было бы правильно, если предположить, что броски кубика независимы друг от друга.

78
00:04:23,440 --> 00:04:25,988
Вы можете сказать, что это какой-то педантизм, конечно,

79
00:04:25,988 --> 00:04:29,765
броски кубиков должны быть независимы друг от друга, но на этом стоит подчеркнуть,

80
00:04:29,765 --> 00:04:33,087
потому что все, что мы собираемся делать дальше, будет двигаться вперед,

81
00:04:33,087 --> 00:04:37,092
от этого простого примера до самого конца. центральная предельная теорема предполагает,

82
00:04:37,092 --> 00:04:38,640
что случайные величины независимы.

83
00:04:38,640 --> 00:04:41,364
В реальном мире вам следует внимательно следить за тем,

84
00:04:41,364 --> 00:04:43,360
действительно ли это предположение верно.

85
00:04:43,360 --> 00:04:46,446
Теперь я собираюсь взять эту сетку всех возможных

86
00:04:46,446 --> 00:04:49,040
результатов и начать заполнять ее числами.

87
00:04:49,040 --> 00:04:53,641
Возможно, мы поместим числа для всех вероятностей выпадения синего кубика внизу,

88
00:04:53,641 --> 00:04:57,845
все вероятности для красного кубика здесь, слева, а затем заполним сетку,

89
00:04:57,845 --> 00:05:02,048
где вероятность каждого результата внутри сетки выглядит как произведение

90
00:05:02,048 --> 00:05:06,480
одного числа из синего распределения и одного числа из красного распределения.

91
00:05:06,480 --> 00:05:10,640
Другой способ подумать об этом: по сути, мы строим таблицу умножения.

92
00:05:10,640 --> 00:05:13,430
Чтобы сделать все это немного более наглядным,

93
00:05:13,430 --> 00:05:17,823
мы могли бы изобразить каждую из этих вероятностей как высоту столбца над

94
00:05:17,823 --> 00:05:20,080
квадратом на таком трехмерном графике.

95
00:05:20,080 --> 00:05:23,490
В каком-то смысле этот трехмерный график содержит все данные,

96
00:05:23,490 --> 00:05:26,240
которые нам нужно знать о броске игральных костей.

97
00:05:26,240 --> 00:05:30,885
Итак, вопрос в том, как нам извлечь то, что мы хотим знать,

98
00:05:30,885 --> 00:05:33,440
— вероятности для различных сумм?

99
00:05:33,440 --> 00:05:37,406
Что ж, если вы выделите все результаты с определенной суммой, скажем,

100
00:05:37,406 --> 00:05:41,600
шестью, обратите внимание, как все они окажутся на определенной диагонали.

101
00:05:41,600 --> 00:05:44,880
То же самое, если я выделю все пары, сумма которых равна семи.

102
00:05:44,880 --> 00:05:47,120
Они сидят по другой диагонали.

103
00:05:47,120 --> 00:05:50,475
Итак, чтобы вычислить вероятность каждой возможной суммы,

104
00:05:50,475 --> 00:05:54,640
вам нужно сложить все элементы, находящиеся на одной из этих диагоналей.

105
00:05:54,640 --> 00:06:00,987
Подняв трехмерный график, мы можем лучше предвидеть, куда мы пойдем позже,

106
00:06:00,987 --> 00:06:06,997
сказав, что распределение возможных сумм выглядит как объединение всех

107
00:06:06,997 --> 00:06:12,160
высот этого графика вдоль одного из этих диагональных срезов.

108
00:06:12,160 --> 00:06:16,270
Это как если бы мы взяли это полное распределение для всех

109
00:06:16,270 --> 00:06:20,800
возможных исходов и как бы свернули его по одному из направлений.

110
00:06:20,800 --> 00:06:24,878
И, признаться, на данный момент я просто немного развлекаюсь с анимацией, а не так,

111
00:06:24,878 --> 00:06:29,200
как если бы вы работали с карандашом и бумагой, вы бы рисовали какой-то трехмерный сюжет.

112
00:06:29,200 --> 00:06:30,080
Но это весело!

113
00:06:30,080 --> 00:06:33,355
Когда вы сворачиваете его в этом направлении, вы действительно получаете то же

114
00:06:33,355 --> 00:06:36,880
распределение, которое, как я знал, и должно быть, но это все равно интересно видеть.

115
00:06:36,880 --> 00:06:41,216
Кроме того, хотя все это может показаться немного игривым или даже излишне сложным,

116
00:06:41,216 --> 00:06:45,139
я могу обещать вам, что это интуитивное представление о диагональных срезах

117
00:06:45,139 --> 00:06:48,960
вернется к нам позже для действительно удовлетворительного доказательства.

118
00:06:48,960 --> 00:06:52,051
Но остановившись еще немного на простом случае с игральными костями,

119
00:06:52,051 --> 00:06:54,560
вот второй способ, которым мы могли бы об этом подумать.

120
00:06:54,560 --> 00:06:58,712
Возьмите это нижнее распределение и переверните его по горизонтали,

121
00:06:58,712 --> 00:07:02,560
чтобы значения кубика увеличивались при движении справа налево.

122
00:07:02,560 --> 00:07:04,400
Зачем это делать, спросите вы?

123
00:07:04,400 --> 00:07:08,800
Итак, обратите внимание, какие из пар значений костей совпадают.

124
00:07:08,800 --> 00:07:14,960
В его нынешнем положении у нас есть 1 и 6, 2 и 5, 3 и 4 и так далее.

125
00:07:14,960 --> 00:07:18,480
Это все пары значений, сумма которых равна 7.

126
00:07:18,480 --> 00:07:22,308
Итак, если вы хотите подумать о вероятности выпадения 7,

127
00:07:22,308 --> 00:07:26,943
способ сохранить это вычисление в уме — взять все пары вероятностей,

128
00:07:26,943 --> 00:07:32,720
которые совпадают друг с другом, перемножить эти пары, а затем сложить все результаты.

129
00:07:32,720 --> 00:07:36,160
Некоторым из вас может понравиться думать об этом как о своего рода точечном продукте.

130
00:07:36,160 --> 00:07:40,240
Но операция в целом — это не одно скалярное произведение, а множество.

131
00:07:40,240 --> 00:07:43,660
Если бы мы сдвинули это нижнее распределение немного левее,

132
00:07:43,660 --> 00:07:48,619
то в данном случае это выглядело бы так, как будто выстроились в ряд значения кубиков:

133
00:07:48,619 --> 00:07:53,236
1 и 4, 2 и 3, 3 и 2, 4 и 1, другими словами, все те, которые в сумме дают 5, ну,

134
00:07:53,236 --> 00:07:57,682
теперь, если мы возьмем скалярное произведение, мы умножим пары вероятностей,

135
00:07:57,682 --> 00:08:00,589
которые выстраиваются в линию, и сложим их вместе,

136
00:08:00,589 --> 00:08:03,040
что даст нам общую вероятность выпадения 5.

137
00:08:03,040 --> 00:08:08,464
В общем, с этой точки зрения вычисление полного распределения суммы выглядит как

138
00:08:08,464 --> 00:08:14,089
перемещение нижнего распределения в разные позиции и попутное вычисление скалярного

139
00:08:14,089 --> 00:08:14,960
произведения.

140
00:08:14,960 --> 00:08:20,160
Это точно такая же операция, как и диагональные срезы, которые мы рассматривали ранее.

141
00:08:20,160 --> 00:08:27,360
Это всего лишь два разных способа визуализировать одну и ту же основную операцию.

142
00:08:27,360 --> 00:08:30,794
И как бы вы ни решили это визуализировать, эта операция,

143
00:08:30,794 --> 00:08:34,350
которая принимает два разных распределения и выдает новое,

144
00:08:34,350 --> 00:08:38,809
описывающее сумму соответствующих случайных величин, называется сверткой,

145
00:08:38,809 --> 00:08:41,280
и мы часто обозначаем ее этой звездочкой.

146
00:08:41,280 --> 00:08:45,544
На самом деле, вы хотите думать об этом, особенно когда мы рассматриваем непрерывный

147
00:08:45,544 --> 00:08:49,758
случай, — это думать об этом как о объединении двух разных функций и создании новой

148
00:08:49,758 --> 00:08:50,160
функции.

149
00:08:50,160 --> 00:08:55,680
Например, в этом случае я могу дать функции для первого распределения имя px.

150
00:08:55,680 --> 00:09:00,530
Это будет функция, которая принимает возможное значение кубика,

151
00:09:00,530 --> 00:09:04,320
например, 3, и выдает соответствующую вероятность.

152
00:09:04,320 --> 00:09:09,264
Аналогично, пусть py будет функцией нашего второго распределения,

153
00:09:09,264 --> 00:09:13,760
а px плюс y будет функцией, описывающей распределение суммы.

154
00:09:13,760 --> 00:09:21,520
На жаргоне вы бы сказали, что px плюс y равно свертке между px и py.

155
00:09:21,520 --> 00:09:26,320
И я хочу, чтобы вы сейчас подумали, как должна выглядеть формула этой операции.

156
00:09:26,320 --> 00:09:28,582
Вы видели два разных способа визуализировать это,

157
00:09:28,582 --> 00:09:30,800
но как нам на самом деле записать это в символах?

158
00:09:30,800 --> 00:09:34,630
Чтобы сориентироваться, возможно, будет полезно записать конкретный пример,

159
00:09:34,630 --> 00:09:39,165
например, случай с подключением 4, где вы суммируете все различные попарные произведения,

160
00:09:39,165 --> 00:09:42,240
соответствующие парам входных данных, которые в сумме дают 4.

161
00:09:42,240 --> 00:09:44,880
И вообще, вот как это может выглядеть.

162
00:09:44,880 --> 00:09:49,873
Эта новая функция принимает на вход возможную сумму ваших случайных величин,

163
00:09:49,873 --> 00:09:55,450
которую я назову s, и то, что она выводит, выглядит как сумма нескольких пар значений

164
00:09:55,450 --> 00:09:55,840
x и y.

165
00:09:55,840 --> 00:09:59,129
За исключением того, что обычно это пишется не с помощью x и y,

166
00:09:59,129 --> 00:10:03,550
а вместо этого мы просто фокусируемся на одной из этих переменных, в данном случае x,

167
00:10:03,550 --> 00:10:06,378
позволяя ей варьироваться по всем возможным значениям,

168
00:10:06,378 --> 00:10:08,640
что здесь просто означает переход от 1 до 6.

169
00:10:08,640 --> 00:10:12,648
И вместо того, чтобы писать y, вы пишете s минус x,

170
00:10:12,648 --> 00:10:17,120
по сути, какое бы число ни было, чтобы сумма была равна s.

171
00:10:17,120 --> 00:10:19,478
Теперь самые проницательные из вас могут заметить немного

172
00:10:19,478 --> 00:10:22,000
странную особенность формулы в том виде, в каком она написана.

173
00:10:22,000 --> 00:10:26,103
Например, если вы подставляете заданное значение, например, s равно 4,

174
00:10:26,103 --> 00:10:31,189
и распаковываете эту сумму, позволяя x варьироваться от всех возможных значений от 1 до

175
00:10:31,189 --> 00:10:35,408
6, то иногда соответствующее значение y падает ниже области определения,

176
00:10:35,408 --> 00:10:37,200
которую мы они определены явно.

177
00:10:37,200 --> 00:10:41,280
Например, вы подставляете 0, отрицательный 1 и отрицательный 2.

178
00:10:41,280 --> 00:10:44,647
На самом деле это не так уж и важно, по сути, вы бы просто сказали,

179
00:10:44,647 --> 00:10:48,560
что все эти значения равны 0, поэтому все эти последующие члены не учитываются.

180
00:10:48,560 --> 00:10:49,760
И это должно иметь смысл.

181
00:10:49,760 --> 00:10:53,680
Какова вероятность того, что на красном кубике выпадет отрицательная единица?

182
00:10:53,680 --> 00:10:54,434
Ну это 0.

183
00:10:54,434 --> 00:11:01,040
Это невозможный результат.

184
00:11:01,040 --> 00:11:04,976
В качестве следующего шага давайте обратим внимание на непрерывные распределения,

185
00:11:04,976 --> 00:11:08,192
где ваша случайная величина может принимать значения в любом месте

186
00:11:08,192 --> 00:11:11,360
бесконечного континуума, как и все возможные действительные числа.

187
00:11:11,360 --> 00:11:15,466
Возможно, вы моделируете погоду и пытаетесь предсказать температуру завтра в полдень,

188
00:11:15,466 --> 00:11:17,854
или делаете финансовые прогнозы, или, может быть,

189
00:11:17,854 --> 00:11:20,720
вы моделируете типичное время ожидания до прибытия автобуса.

190
00:11:20,720 --> 00:11:23,760
Есть множество вещей, в которых вам нужно обеспечить непрерывность.

191
00:11:23,760 --> 00:11:27,750
На всех графиках, которые мы рисуем, значение x по-прежнему представляет

192
00:11:27,750 --> 00:11:31,413
собой возможное число, которое может принимать случайная величина,

193
00:11:31,413 --> 00:11:36,333
но интерпретация оси y немного другая, потому что это больше не представляет вероятность,

194
00:11:36,333 --> 00:11:40,160
а то, что мы рисуем график, который называется плотностью вероятности.

195
00:11:40,160 --> 00:11:43,280
Мы уже говорили об этом раньше, так что вы знаете, в чем дело.

196
00:11:43,280 --> 00:11:48,478
По сути, вероятность того, что выборка вашей переменной попадает в заданный диапазон,

197
00:11:48,478 --> 00:11:51,440
выглядит как площадь под кривой в этом диапазоне.

198
00:11:51,440 --> 00:11:55,499
Функцию, описывающую эту кривую, обычно называют функцией плотности вероятности.

199
00:11:55,499 --> 00:11:57,904
Это достаточно распространенное словосочетание,

200
00:11:57,904 --> 00:12:00,160
поэтому ему часто дают просто сокращение PDF.

201
00:12:00,160 --> 00:12:04,839
Поэтому правильный способ записать все это — сказать, что вероятность того,

202
00:12:04,839 --> 00:12:09,764
что ваша выборка попадает в заданный диапазон, выглядит как интеграл вашей PDF,

203
00:12:09,764 --> 00:12:12,720
функции плотности вероятности, в этом диапазоне.

204
00:12:12,720 --> 00:12:16,991
Как правило, каждый раз, когда вы видите сумму в дискретном случае,

205
00:12:16,991 --> 00:12:20,320
вы должны использовать интеграл в непрерывном случае.

206
00:12:20,320 --> 00:12:23,920
Итак, давайте подумаем, что это значит для нашего основного примера.

207
00:12:23,920 --> 00:12:26,747
Допустим, у нас есть две разные случайные величины,

208
00:12:26,747 --> 00:12:30,718
но на этот раз каждая из них будет следовать непрерывному распределению,

209
00:12:30,718 --> 00:12:34,960
и мы хотим понять их сумму и новое распределение, которое описывает эту сумму.

210
00:12:34,960 --> 00:12:38,960
Вы, наверное, уже догадались, какой будет формула, просто по аналогии.

211
00:12:38,960 --> 00:12:41,969
Помните, в формуле, которую мы только что записали,

212
00:12:41,969 --> 00:12:47,063
где p sub x — функция для первой переменной, а p sub y — функция для второй переменной,

213
00:12:47,063 --> 00:12:51,057
свертка между ними, то есть вещь, описывающая сумму этих переменных,

214
00:12:51,057 --> 00:12:55,920
сама по себе выглядит как сумма, в которой мы объединяем кучу попарных произведений.

215
00:12:55,920 --> 00:13:00,853
Выражение в непрерывном случае действительно выглядит на 100% аналогично,

216
00:13:00,853 --> 00:13:03,520
просто мы заменяем эту сумму интегралом.

217
00:13:03,520 --> 00:13:07,009
Иногда, когда студенты видят это определение свертки вне контекста,

218
00:13:07,009 --> 00:13:08,960
оно может показаться немного пугающим.

219
00:13:08,960 --> 00:13:11,566
Надеюсь, аналогии достаточно, чтобы прояснить ситуацию,

220
00:13:11,566 --> 00:13:14,544
но непрерывная природа действительно придает ей другой оттенок,

221
00:13:14,544 --> 00:13:18,640
и стоит потратить пару минут, чтобы подумать, что это значит на ее собственных условиях.

222
00:13:18,640 --> 00:13:21,280
Поэтому я собрал небольшую интерактивную демонстрацию,

223
00:13:21,280 --> 00:13:25,600
которая помогает раскрыть каждую часть выражения и понять, что оно на самом деле означает.

224
00:13:25,600 --> 00:13:28,803
Например, первый член в этом интеграле — это f от x,

225
00:13:28,803 --> 00:13:33,760
который представляет собой функцию плотности для первой из двух случайных величин.

226
00:13:33,760 --> 00:13:37,849
В данном случае я выбираю для этого распределения клиновидную функцию,

227
00:13:37,849 --> 00:13:39,520
но это может быть что угодно.

228
00:13:39,520 --> 00:13:43,822
Точно так же g представляет функцию плотности для второй случайной величины,

229
00:13:43,822 --> 00:13:47,120
для которой я выбираю такое двойное кусковое распределение.

230
00:13:47,120 --> 00:13:52,506
И точно так же, как ранее мы перебирали все возможные пары значений кубиков

231
00:13:52,506 --> 00:13:56,688
с заданной суммой, вы можете думать об этом интеграле так:

232
00:13:56,688 --> 00:14:00,586
он хочет перебирать все возможные пары значений x и y,

233
00:14:00,586 --> 00:14:03,280
которые ограничено заданной суммой, s.

234
00:14:03,280 --> 00:14:07,916
На самом деле у нас нет подходящих обозначений для того, чтобы сделать это симметрично,

235
00:14:07,916 --> 00:14:11,235
поэтому вместо этого способ, которым мы обычно это записываем,

236
00:14:11,235 --> 00:14:14,976
придает искусственное значение одной из переменных, в данном случае x,

237
00:14:14,976 --> 00:14:19,665
где мы позволяем этому значению x варьироваться по всем возможным действительным числам:

238
00:14:19,665 --> 00:14:24,091
отрицательная бесконечность до бесконечности, и то, что мы подставляем в функцию g,

239
00:14:24,091 --> 00:14:27,410
— это s минус x, по сути, что бы это ни было, чтобы убедиться,

240
00:14:27,410 --> 00:14:29,360
что эта сумма ограничена значением s.

241
00:14:29,360 --> 00:14:32,506
Итак, для демонстрации вместо непосредственного построения

242
00:14:32,506 --> 00:14:35,120
графика g я хочу построить график g от s минус x.

243
00:14:35,120 --> 00:14:37,920
Вы можете спросить себя, как это выглядит?

244
00:14:37,920 --> 00:14:41,849
Что ж, если вы подставите отрицательный x в качестве входных данных,

245
00:14:41,849 --> 00:14:44,640
это приведет к перевороту графика по горизонтали.

246
00:14:44,640 --> 00:14:48,638
А затем, если мы добавим этот параметр s, рассматриваемый как некую константу,

247
00:14:48,638 --> 00:14:52,231
это приведет к сдвигу графика влево или вправо, в зависимости от того,

248
00:14:52,231 --> 00:14:54,560
является ли s положительным или отрицательным.

249
00:14:54,560 --> 00:14:58,560
В демо-версии s — это параметр, который я просто возьму и немного поменяю.

250
00:14:58,560 --> 00:15:03,149
Настоящее удовольствие доставляет графическое представление всего содержимого интеграла,

251
00:15:03,149 --> 00:15:04,800
произведения этих двух графиков.

252
00:15:04,800 --> 00:15:08,585
Это аналогично списку парных продуктов, который мы видели ранее,

253
00:15:08,585 --> 00:15:12,721
но в данном случае вместо сложения всех этих парных продуктов мы хотим

254
00:15:12,721 --> 00:15:16,973
интегрировать их вместе, что можно интерпретировать как область под этим

255
00:15:16,973 --> 00:15:18,080
графиком продуктов.

256
00:15:18,080 --> 00:15:24,320
Когда я сдвигаю это значение s, форма графика продукта меняется,

257
00:15:24,320 --> 00:15:27,200
как и соответствующая область.

258
00:15:27,200 --> 00:15:31,670
Имейте в виду, что для всех трех графиков слева входными данными являются x,

259
00:15:31,670 --> 00:15:33,760
а число s — это всего лишь параметр.

260
00:15:33,760 --> 00:15:38,914
Но для окончательного графика справа, для самой результирующей свертки,

261
00:15:38,914 --> 00:15:42,924
это число s является входными данными для этой функции,

262
00:15:42,924 --> 00:15:48,723
а соответствующий выходной результат — это любая площадь нижнего левого графика,

263
00:15:48,723 --> 00:15:53,520
каким бы ни был интеграл между этой комбинацией f и g. оказывается.

264
00:15:53,520 --> 00:15:57,042
Здесь может быть полезно, если мы приведем простой пример, скажем,

265
00:15:57,042 --> 00:16:00,406
где каждая из наших двух случайных величин следует равномерному

266
00:16:00,406 --> 00:16:04,560
распределению между значениями отрицательной половины и положительной половины.

267
00:16:04,560 --> 00:16:09,345
Это выглядит так: каждая из наших функций плотности имеет форму цилиндра,

268
00:16:09,345 --> 00:16:13,418
где график равен 1 для всех входных данных между отрицательной

269
00:16:13,418 --> 00:16:17,040
половиной и положительной половиной, а везде он равен 0.

270
00:16:17,040 --> 00:16:22,080
Вопрос, как всегда, в том, как должно выглядеть распределение суммы?

271
00:16:22,080 --> 00:16:25,440
Что ж, позвольте мне показать вам, как это выглядит внутри нашей демо-версии.

272
00:16:25,440 --> 00:16:29,600
В этом случае произведение между двумя графиками имеет очень простую интерпретацию.

273
00:16:29,600 --> 00:16:34,720
Оно равно 1 везде, где графики перекрываются друг с другом, и 0 везде.

274
00:16:34,720 --> 00:16:38,448
Итак, если я сдвину этот параметр достаточно далеко влево,

275
00:16:38,448 --> 00:16:41,735
чтобы наши верхние графики вообще не перекрывались,

276
00:16:41,735 --> 00:16:47,360
то график продукта везде будет равен 0, и это способ сказать, что это недостижимая сумма.

277
00:16:47,360 --> 00:16:48,739
Это должно иметь смысл.

278
00:16:48,739 --> 00:16:52,528
Каждая из двух переменных может быть меньше отрицательной половины,

279
00:16:52,528 --> 00:16:55,760
поэтому сумма никогда не может стать ниже отрицательной 1.

280
00:16:55,760 --> 00:17:00,306
Когда я начинаю сдвигать s вправо и графики перекрываются друг с другом,

281
00:17:00,306 --> 00:17:05,537
площадь увеличивается линейно, пока графики полностью не перекроются и не достигнет

282
00:17:05,537 --> 00:17:06,160
максимума.

283
00:17:06,160 --> 00:17:10,909
А затем после этой точки она снова начинает линейно уменьшаться,

284
00:17:10,909 --> 00:17:15,440
а это означает, что распределение суммы принимает форму клина.

285
00:17:15,440 --> 00:17:18,346
И я полагаю, что это на самом деле кажется знакомым каждому,

286
00:17:18,346 --> 00:17:21,920
кто думал о паре игральных костей, то есть о невзвешенных игральных костях.

287
00:17:21,920 --> 00:17:26,320
Там если сложить две разные равномерно распределенные переменные,

288
00:17:26,320 --> 00:17:29,920
то распределение суммы имеет определенную форму клина.

289
00:17:29,920 --> 00:17:34,626
Вероятности увеличиваются до тех пор, пока не достигнут максимума 7,

290
00:17:34,626 --> 00:17:36,400
а затем снова уменьшаются.

291
00:17:36,400 --> 00:17:39,872
Гораздо интереснее будет, если вместо суммы двух равномерно

292
00:17:39,872 --> 00:17:43,634
распределенных переменных я спрошу вас, как это будет выглядеть,

293
00:17:43,634 --> 00:17:47,280
если мы сложим три разные равномерно распределенные переменные.

294
00:17:47,280 --> 00:17:50,146
Сначала вы можете сказать: «Я не знаю, нам нужен какой-то

295
00:17:50,146 --> 00:17:53,360
новый способ визуализировать объединение трех вещей вместо двух».

296
00:17:53,360 --> 00:17:57,320
Но на самом деле здесь вы можете подумать о сумме первых двух как об отдельной

297
00:17:57,320 --> 00:17:59,776
переменной, которая, как мы только что выяснили,

298
00:17:59,776 --> 00:18:02,232
соответствует этому распределению в форме клина,

299
00:18:02,232 --> 00:18:05,040
а затем выполнить свертку между ней и функцией цилиндра.

300
00:18:05,040 --> 00:18:07,840
Запускаем демо-версию, вот как это будет выглядеть.

301
00:18:07,840 --> 00:18:12,132
Опять же, что делает функцию цилиндра действительно хорошей, так это то,

302
00:18:12,132 --> 00:18:16,720
что умножение на нее приводит к отфильтровыванию значений из верхнего графика.

303
00:18:16,720 --> 00:18:20,526
Продукт внизу выглядит точно так же, как копия верхнего графика,

304
00:18:20,526 --> 00:18:22,400
но ограничен определенным окном.

305
00:18:22,400 --> 00:18:26,353
Опять же, когда я перемещаю это влево и вправо, и область становится больше и меньше,

306
00:18:26,353 --> 00:18:29,571
результат достигает максимума в середине, но сужается с обеих сторон,

307
00:18:29,571 --> 00:18:32,560
за исключением того, что на этот раз это происходит более плавно.

308
00:18:32,560 --> 00:18:36,880
Это похоже на то, как будто мы берем скользящее среднее верхнего левого графика.

309
00:18:36,880 --> 00:18:39,833
На самом деле, это нечто большее, это буквально

310
00:18:39,833 --> 00:18:42,480
скользящее среднее верхнего левого графика.

311
00:18:42,480 --> 00:18:45,440
Вы можете подумать, что стоит пойти еще дальше.

312
00:18:45,440 --> 00:18:49,389
Мы начали с объединения двух функций цилиндра и получили этот клин,

313
00:18:49,389 --> 00:18:53,976
затем мы заменили первую функцию этим клином, а затем, когда мы взяли свертку,

314
00:18:53,976 --> 00:18:58,680
мы получили эту более гладкую форму, описывающую сумму трех различных однородных

315
00:18:58,680 --> 00:19:01,120
переменных, но мы могли бы просто повтори.

316
00:19:01,120 --> 00:19:06,521
Замените это на верхнюю функцию, а затем сверните ее с плоской прямоугольной функцией,

317
00:19:06,521 --> 00:19:10,868
и какой бы результат мы ни увидели, он должен описывать сумму четырех

318
00:19:10,868 --> 00:19:13,600
равномерно распределенных случайных величин.

319
00:19:13,600 --> 00:19:16,609
Любой из вас, кто смотрел видео о центральной предельной теореме,

320
00:19:16,609 --> 00:19:17,840
должен знать, чего ожидать.

321
00:19:17,840 --> 00:19:20,073
По мере того, как мы повторяем этот процесс снова и снова,

322
00:19:20,073 --> 00:19:22,800
форма все больше и больше становится похожей на колоколообразную кривую.

323
00:19:22,800 --> 00:19:26,764
Или, если быть более точным, на каждой итерации мы должны масштабировать ось X,

324
00:19:26,764 --> 00:19:29,689
чтобы убедиться, что стандартное отклонение равно единице,

325
00:19:29,689 --> 00:19:32,712
потому что доминирующим эффектом этой повторяющейся свертки,

326
00:19:32,712 --> 00:19:35,587
своего рода повторяющегося процесса скользящего среднего,

327
00:19:35,587 --> 00:19:37,520
является выравнивание функции по время.

328
00:19:37,520 --> 00:19:40,160
Таким образом, в пределе оно просто стремится к нулю.

329
00:19:40,160 --> 00:19:43,381
Но изменение масштаба — это способ сказать: да, да, я знаю,

330
00:19:43,381 --> 00:19:48,160
что оно становится более плоским, но какова реальная форма, лежащая в основе всего этого?

331
00:19:48,160 --> 00:19:51,532
Утверждение центральной предельной теоремы, одного из самых крутых

332
00:19:51,532 --> 00:19:53,999
фактов из теории вероятности, заключается в том,

333
00:19:53,999 --> 00:19:58,480
что вы могли бы начать практически с любого распределения, и это все равно было бы верно.

334
00:19:58,480 --> 00:20:03,233
Когда вы повторяете подобные свертки, представляющие все большие и большие суммы

335
00:20:03,233 --> 00:20:07,399
данной случайной величины, тогда распределение, описывающее эту сумму,

336
00:20:07,399 --> 00:20:11,566
которое может поначалу сильно отличаться от нормального распределения,

337
00:20:11,566 --> 00:20:15,967
со временем все больше и больше сглаживается, пока не станет произвольным.

338
00:20:15,967 --> 00:20:18,080
близкое к нормальному распределению.

339
00:20:18,080 --> 00:20:21,962
Это похоже на то, как если бы колоколообразная кривая — это,

340
00:20:21,962 --> 00:20:25,908
в некотором смысле, самое гладкое из возможных распределений,

341
00:20:25,908 --> 00:20:30,555
притягивающая фиксированная точка в пространстве всех возможных функций,

342
00:20:30,555 --> 00:20:35,520
когда мы применяем этот процесс многократного сглаживания посредством свертки.

343
00:20:35,520 --> 00:20:38,874
Естественно, вы можете задаться вопросом, почему нормальное распределение?

344
00:20:38,874 --> 00:20:41,520
Почему именно эта функция, а не какая-то другая?

345
00:20:41,520 --> 00:20:45,821
Это очень хороший ответ, и я думаю, что самый интересный способ показать

346
00:20:45,821 --> 00:20:50,240
ответ — это в свете последней визуализации, которую мы покажем для извилин.

347
00:20:50,240 --> 00:20:54,338
Помните, как в дискретном случае первая из двух наших визуализаций

348
00:20:54,338 --> 00:20:58,009
включала в себя формирование такого рода таблицы умножения,

349
00:20:58,009 --> 00:21:02,720
показывающую вероятности всех возможных исходов и суммирование по диагоналям?

350
00:21:02,720 --> 00:21:08,320
Вы, наверное, уже догадались, но наш последний шаг — обобщить это на непрерывный случай.

351
00:21:08,320 --> 00:21:11,760
И это красиво, но нужно быть немного осторожным.

352
00:21:11,760 --> 00:21:16,873
Если использовать те же две функции, которые у нас были раньше, f от x и g от y,

353
00:21:16,873 --> 00:21:22,240
что в этом случае будет аналогом сетки возможных пар, которую мы рассматривали ранее?

354
00:21:22,240 --> 00:21:26,899
Что ж, в этом случае каждая из переменных может принимать любое действительное число,

355
00:21:26,899 --> 00:21:30,854
поэтому мы хотим подумать обо всех возможных парах действительных чисел,

356
00:21:30,854 --> 00:21:32,480
и на ум приходит плоскость xy.

357
00:21:32,480 --> 00:21:37,840
Каждая точка соответствует возможному результату при выборке из обоих распределений.

358
00:21:37,840 --> 00:21:41,712
Теперь вероятность любого из этих результатов, xy, или, скорее,

359
00:21:41,712 --> 00:21:45,887
плотность вероятности вокруг этой точки, будет выглядеть как f от x,

360
00:21:45,887 --> 00:21:49,760
умноженная на g от y, опять же, при условии, что они независимы.

361
00:21:49,760 --> 00:21:55,141
Поэтому естественным будет построить график этой функции f от x, умноженной на g от y,

362
00:21:55,141 --> 00:22:00,400
как функции двух переменных, что даст нечто похожее на поверхность над плоскостью xy.

363
00:22:00,400 --> 00:22:03,838
Обратите внимание, что в этом примере, если мы посмотрим на него под одним углом

364
00:22:03,838 --> 00:22:07,065
и увидим изменение значений x, он будет иметь форму нашего первого графика,

365
00:22:07,065 --> 00:22:10,673
но если мы посмотрим на него под другим углом, подчеркнув изменение в направлении y,

366
00:22:10,673 --> 00:22:14,240
он будет иметь форму нашего первого графика. принимает форму нашего второго графика.

367
00:22:14,240 --> 00:22:17,920
Этот трехмерный график кодирует всю необходимую нам информацию.

368
00:22:17,920 --> 00:22:21,760
Он показывает все плотности вероятности для каждого возможного результата.

369
00:22:21,760 --> 00:22:25,887
И если вы хотите ограничить свое представление только теми результатами,

370
00:22:25,887 --> 00:22:30,241
где x плюс y ограничено заданной суммой, это выглядит как ограничение нашего

371
00:22:30,241 --> 00:22:34,313
представления диагональным срезом, а именно срезом над линией x плюс y,

372
00:22:34,313 --> 00:22:35,840
равным некоторой константе.

373
00:22:35,840 --> 00:22:38,501
Все возможные плотности вероятности для результата,

374
00:22:38,501 --> 00:22:42,699
на который распространяется это ограничение, выглядят как срез под этим графиком,

375
00:22:42,699 --> 00:22:46,436
и по мере того, как мы меняем конкретную сумму, которую мы ограничиваем,

376
00:22:46,436 --> 00:22:50,480
она смещается вокруг того, какой конкретный диагональный срез мы рассматриваем.

377
00:22:50,480 --> 00:22:55,760
Теперь вы можете предсказать, что способ объединения всех плотностей

378
00:22:55,760 --> 00:23:01,500
вероятности вдоль одного из этих срезов, способ их интеграции вместе можно

379
00:23:01,500 --> 00:23:07,775
интерпретировать как площадь под этой кривой, которая является срезом поверхности.

380
00:23:07,775 --> 00:23:09,680
И это почти правильно.

381
00:23:09,680 --> 00:23:14,255
Есть тонкая деталь, касающаяся коэффициента квадратного корня из двух,

382
00:23:14,255 --> 00:23:19,926
о котором нам нужно поговорить, но до постоянного коэффициента площади этих срезов дают

383
00:23:19,926 --> 00:23:21,280
нам значения свертки.

384
00:23:21,280 --> 00:23:24,618
Фактически, все эти срезы, которые мы рассматриваем,

385
00:23:24,618 --> 00:23:29,280
в точности совпадают с графиком продуктов, который мы рассматривали ранее.

386
00:23:29,280 --> 00:23:34,494
Здесь, чтобы подчеркнуть этот момент, позвольте мне расположить обе визуализации

387
00:23:34,494 --> 00:23:38,293
рядом и медленно уменьшить значение s, что слева означает,

388
00:23:38,293 --> 00:23:41,577
что мы смотрим на разные срезы, а справа означает,

389
00:23:41,577 --> 00:23:45,440
что мы повторное перемещение по модифицированному графику g.

390
00:23:45,440 --> 00:23:51,818
Обратите внимание, что форма графика в правом нижнем углу (произведение

391
00:23:51,818 --> 00:23:58,640
функций) во всех точках выглядит точно так же, как форма диагонального среза.

392
00:23:58,640 --> 00:23:59,872
И это должно иметь смысл.

393
00:23:59,872 --> 00:24:03,040
Это два разных способа визуализировать одно и то же.

394
00:24:03,040 --> 00:24:05,967
Когда мы выражаем это словами, это звучит как много,

395
00:24:05,967 --> 00:24:10,385
но мы рассматриваем все возможные произведения между выходными данными функций,

396
00:24:10,385 --> 00:24:13,755
соответствующих парам входных данных, имеющих заданную сумму.

397
00:24:13,755 --> 00:24:22,683
Опять же, это своего рода пустословие, но я думаю, вы понимаете,

398
00:24:22,683 --> 00:24:31,200
о чем я говорю, и теперь у нас есть два разных взгляда на это.

399
00:24:31,200 --> 00:24:35,700
Визуализация диагональных срезов хороша тем, что она делает гораздо более ясным,

400
00:24:35,700 --> 00:24:37,367
что это симметричная операция.

401
00:24:37,367 --> 00:24:43,165
Гораздо более очевидно, что f, свернутая с g, — это то же самое, что g, свернутая с f.

402
00:24:43,165 --> 00:24:47,382
Технически диагональные ломтики не имеют одинаковой формы.

403
00:24:47,382 --> 00:24:51,680
На самом деле они были растянуты в квадратный корень из 2.

404
00:24:51,680 --> 00:24:54,698
Основная причина в том, что если вы представляете,

405
00:24:54,698 --> 00:24:59,670
что делаете небольшой шаг по одной из этих линий, где x плюс y равняется константе,

406
00:24:59,670 --> 00:25:03,873
то изменение вашего значения x, здесь дельта x, не будет тем же самым,

407
00:25:03,873 --> 00:25:05,234
что и длина этого шага.

408
00:25:05,234 --> 00:25:09,440
На самом деле этот шаг длиннее в квадратный корень из 2.

409
00:25:09,440 --> 00:25:12,875
Я оставлю на экране заметку для энтузиастов исчисления среди вас,

410
00:25:12,875 --> 00:25:16,466
которые хотят остановиться и поразмышлять, но результат очень прост:

411
00:25:16,466 --> 00:25:21,151
результаты нашей свертки технически не совсем являются областями этих диагональных срезов.

412
00:25:21,151 --> 00:25:26,080
Нам нужно разделить эти площади на квадратный корень из 2.

413
00:25:26,080 --> 00:25:29,920
Отступив на мгновение от всего этого, я просто думаю, что это так прекрасно.

414
00:25:29,920 --> 00:25:33,485
Мы начали с такого простого вопроса, или, по крайней мере, с такого,

415
00:25:33,485 --> 00:25:36,896
казалось бы, простого вопроса: как сложить две случайные величины?

416
00:25:36,896 --> 00:25:42,324
И в итоге мы получаем очень сложную операцию по объединению двух разных функций.

417
00:25:42,324 --> 00:25:45,564
У нас есть как минимум два очень красивых способа понять это,

418
00:25:45,564 --> 00:25:48,544
но все же некоторые из вас могут поднять руки и сказать:

419
00:25:48,544 --> 00:25:52,830
красивые картинки — это хорошо, но помогают ли они на самом деле что-то вычислить?

420
00:25:52,830 --> 00:25:56,378
Например, я до сих пор не ответил на вступительный вопрос

421
00:25:56,378 --> 00:25:59,987
о сложении двух нормально распределенных случайных величин.

422
00:25:59,987 --> 00:26:04,832
Что ж, обычный подход к такого рода вопросам, если бы он возник в домашнем задании

423
00:26:04,832 --> 00:26:09,737
или что-то в этом роде, заключается в том, что вы подставили бы формулу нормального

424
00:26:09,737 --> 00:26:14,174
распределения в определение свертки, интеграла, который мы Я описывал здесь.

425
00:26:14,174 --> 00:26:17,724
И в этом случае визуализации на самом деле будут просто для того,

426
00:26:17,724 --> 00:26:21,651
чтобы прояснить, о чем говорит выражение, но они сидят на заднем сиденье.

427
00:26:21,651 --> 00:26:26,695
В этом случае интеграл не является непомерно сложным, существуют аналитические методы,

428
00:26:26,695 --> 00:26:31,739
но на этом примере я хочу показать вам более интересный метод, в котором визуализация,

429
00:26:31,739 --> 00:26:36,957
особенно диагональные срезы, будет играть гораздо более важную роль в доказательство само

430
00:26:36,957 --> 00:26:37,305
собой.

431
00:26:37,305 --> 00:26:40,387
Я думаю, что многим из вас действительно понравится потратить время на то,

432
00:26:40,387 --> 00:26:42,730
чтобы предсказать, как это будет выглядеть для вас самих.

433
00:26:42,730 --> 00:26:47,045
Подумайте, как будет выглядеть этот трехмерный график в случае двух

434
00:26:47,045 --> 00:26:51,930
нормальных распределений и какими его свойствами вы могли бы воспользоваться.

435
00:26:51,930 --> 00:26:55,198
И наверняка проще всего начать со случая, когда оба

436
00:26:55,198 --> 00:26:58,592
распределения имеют одинаковое стандартное отклонение.

437
00:26:58,592 --> 00:26:59,707
Если вам нужны подробности и посмотреть, как ответ вписывается в

438
00:26:59,707 --> 00:27:00,960
центральную предельную теорему, присоединяйтесь ко мне в следующем видео.


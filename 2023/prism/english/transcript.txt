I realized recently that I didn't really understand how a prism works, and I suspect most people out there don't either. 
Arguably this is one of the most widely recognized physics experiments ever. 
After all, how many others have earned a place as an iconic album cover? 
Sure, some of Pink Floyd's design choices run completely contrary to the actual physics. 
Like why did they make the light inside the prism white? 
And bafflingly, why would you draw all the colors as a discrete set, like a child making a rainbow, despite the fact that one of the key points in Newton's original experiment involving prisms was that sunlight contains a continuous spectrum of colors? 
Still, setting that aside, it's cool that it's in pop culture at all, and any self-respecting physics enthusiast should know how it works, but the thing I realized is that my understanding hit a wall pretty quickly if pressed. 
You see, the standard explanation, what you might hear in a high school physics class for example, goes something like this. 
When light enters a medium, like glass, it slows down, in the sense that if you look at the crests of the wave, in a vacuum those crests are travelling at c, the speed of light, but inside the glass those crests will be travelling a little bit slower. 
And the specific ratio between the speed of light in a vacuum and the speed inside a medium like this is called the index of refraction for that medium. 
The reason we use the word refraction instead of, say, the index of slowing, is that if a beam of light enters this glass at an angle, then a consequence of this slowdown is that it bends a little bit, or using the lingo, it refracts. 
And the way my high school physics teacher always explained this was to imagine a tank going from some region where it can travel relatively quickly, like concrete, into something slower, like mud, where if it's coming in at an angle, then as one of its treads hits the slow region first, that tread will be going slower while the other one is faster, causing the whole thing to steer a little bit, until that second tread also enters the mud, then it continues straight, just travelling a little slower. 
We'll get back to the actual reason for bending in a bit, but at this point the high school physics students typically learn a law known as Snell's law, which specifies exactly how much things bend. 
If you draw a line perpendicular to the boundary between the glass and water, and consider the angle between that perpendicular line and the beam of light, then Snell's law tells us that the sine of this angle divided by the speed of the light is always a constant. 
So the slower the light, the lower that angle will be, and that lets you actually calculate how much things refract. 
What's going on with a prism, then, is that the specific amount that light slows down depends a little bit on its frequency. 
For example, blue light, which has a relatively high frequency, would get slowed down more aggressively than red light, which has a relatively low frequency. 
Now most of the light that you see is not a clean pure sine wave, in particular the white light coming from the sun is not a clean sine wave, it's something much messier, but it can be expressed as a sum of a bunch of clean sine waves, each one corresponding to a pure spectral color. 
So when you shine white light into a prism like this, all those different components get refracted by slightly different amounts, causing this iconic separation of the pure rainbow colors. 
So that is the standard explanation, and it's not wrong per se, it's just that all of the key components are handed down from on high. 
Why would light slow down like this? 
And what exactly do we mean by slowing down? 
And even if you understand that, why would the amount that it slows down have anything to do with the color of the light? 
Is that just a coincidence, or is it necessary? 
If you have a sufficiently high standard for explanations, you want both of these facts to feel discovered, rather than feeling like they were handed down. 
The first explanation I saw that started to give this feeling came from the Feynman lectures on the matter, and a lot of what I'd like to do with this video is simply animate a lot of the key points that he makes there. 
It involves really digging in to think about each individual wiggling charge in the material, and the propagating light waves caused by each one of those charges, and how all of them superimpose on top of each other. 
Which feels like it should be a complete mess, but it actually works out to be not only understandable, but satisfyingly explanatory. 
For example, it explains why it has to depend on color, and the key intuition there really comes down to what happens if you're bad at pushing a child on a swing. 
Bear with me, I promise that'll make sense later. 
Also, when I mentioned on Patreon the intention to cover this topic, a lot of people had a lot of questions about the index of refraction. 
For example, numerous people asked about how it's possible for this number to be lower than 1, which really does happen, despite that seeming to imply the impossibility of something traveling faster than the speed of light. 
There was also a question about birefringence, which is where a material can have two different indices of refraction, causing you to see double when you look through it. 
And that actually ties in really nicely to putting in the final puzzle piece from the last two videos about the barber pole phenomenon. 
And a couple people also asked about why light slowing down would imply a bending like this, and I agree that deserves a better explanation than the tank analogy. 
I promise we'll get to all of these questions later, but it makes sense to first lay down some groundwork by spending the bulk of our time on the key question of why passing through a medium would change the speed of a light wave at all. 
And for this, I want you to think of your material, like glass, as being broken up into a bunch of distinct layers, all perpendicular to the direction the light is traveling. 
And we'll start by focusing our attention on the effect of just one of those layers on the light wave. 
The true effect would be miniscule, but if you'll let me exaggerate it for a moment, what it does is kick back the phase of the wave. 
And maybe it's worth a brief aside to make sure we're all on the same page when it comes to wave terminology. 
If you go and graph the function sine of x, when you put some term in front of it, affecting how high that wave oscillates up and down, that's what we call the amplitude, when you put a term in front of x, this will affect how rapidly it oscillates. 
If this is meant to describe a wave over time, that term would be called the angular frequency, whereas if it's meant to describe a wave over space, that constant would be called the wave number. 
Then if you were to add some other constant inside that sine function, and notice how as you change what that constant is, it sort of slides the wave left and right, that term describes the phase of the wave. 
So when I say that our light wave hitting a layer of glass causes its phase to get kicked back, I mean if you take whatever function describes it before it hits the glass, then the function describing it after that looks almost the same, just with a little extra something added to the input of that sine function. 
Like I said, in reality that'll be a very small number, something proportional to the infinitesimal thickness of that layer, but I'll keep drawing it as something exaggerated and keep track of the value of that phase kick over here on the left. 
Let's say you go and add a bunch of other layers of the glass, each one also applying their own kickback to the phase of the wave. 
The question for you is what does that new wave look like? 
If the value of that phase kick applied by each layer is something really close to zero, then the wave is hardly affected at all. 
But the larger that phase kick, the more the wave kind of gets squished together among all those layers. 
Admittedly, right here it looks all kaleidoscopic and weird, but that's really just because I have a discrete set of layers, each applying an unrealistically large kick. 
Notice what happens if I smooth it out by doubling the density of layers, but having each one only apply half the phase kick. 
And then I do that again, I double the density of the layers, but have each one only apply half the phase kick. 
As I continue this over and over, approaching a situation where you have a continuum of glass, each layer applying just a tiny infinitesimal phase kick, what you end up with is identical to, indistinguishable from, a wave that's simply traveling slower, oscillating up and down with the same frequency, but with a wavelength that's been kind of scrunched up. 
This right here is the first key idea with the index of refraction. 
Instead of asking why does light slow down in glass, what we really need to ask is why does its interaction with a single layer of that glass cause a kickback to the phase of the wave? 
And then when we want to get quantitative and understand exactly how much the light slows down, which is critical for understanding why it depends on color, instead the real question is how strong is that phase kick? 
From here it's helpful to turn back to the fundamentals of what light even is. 
This is something we talked a lot about in the last video, but a little review never hurts, so let me go over the essentials. 
As many of you know, light is a wave in the electromagnetic field, but here we'll just be drawing the electric field. 
The electric field associates each point in 3D space with a little 3-dimensional vector telling you what force would be applied to a hypothetical unit charge sitting at that point in space. 
The key thing going on with light is that if you have a charged particle and something causes it to wiggle up and down, that results in these propagating ripples in the electric field away from the charge, and that propagation is traveling at the speed c, the speed of light. 
Whenever those ripples happen to reach another charged particle, they cause it to wiggle up and down, albeit a little more weakly than the initial wiggle, and that in turn causes its own propagations. 
The way we described this in the last video was that if at some point in time a charge is accelerating, then after a little delay, which depends on this speed c, the existence of that acceleration induces a force on another charge. 
We went over the specific force law describing this, it's something that can be derived downstream of Maxwell's equations, but for our purposes here, the main thing to tuck away in your mind is that the amount of time it takes that initial acceleration to cause any kind of influence elsewhere travels at exactly the speed c. 
And really, you should think of c not so much as the speed of light per se, but as the speed of causality. 
It determines how fast any kind of influence travels, it's just that one of multiple consequences of that is that it's the speed of light. 
In particular, when you get a charge oscillating up and down in a nice clean sinusoidal motion, you can think of these rippling effects in the electric field as describing the force that would be applied to another charge sitting there as a result of that past acceleration. 
I will freely admit that I had a bit too much fun in that video just simulating how the electric field responds to accelerating charges, and that I'm kind of doing the same thing here, but there are two important facts for our pursuit of the index of refraction. 
The first is that when you have multiple different charges oscillating up and down, the net effect on the electric field is just the sum of what it would be for each individual charge, which is kind of what you would expect. 
The way it shakes out is that if you have a row of charges oscillating in sync with each other, or for our purposes today, a plane of charges all wiggling up and down in sync within that plane, then the effects of each individual charge tend to cancel each other out in most directions, except perpendicular to that plane, they actually constructively interfere. 
This is how you can get a concentrated beam of light. 
That's the important thing. 
If you have a layer of charges wiggling up and down in sync with each other, then even far away from that layer, it produces this nice sinusoidal wave in the electric field that we're so fond of drawing to represent light. 
When I draw a light wave like this, it's really only depicting the electric field on a single one-dimensional line. 
A more full picture of light in three dimensions would look something more like this. 
That tends to be a little bit busier, so usually we just draw the sine wave. 
So thinking back to the question of why interactions with a layer of material would cause a kick back to the phase of the wave, let's start thinking it through. 
When a light beam enters a material, like glass, then it causes all of the charges inside that material, you know, electrons or maybe the occasional ion, to wiggle up and down in response to that light wave. 
You might think that adding together all the propagations from all those charges is a complete nightmare, but we can think about it one layer at a time. 
As the light wave causes this layer to wiggle up and down, that wiggling produces its own second-order light wave at the same frequency, and it propagates in both directions perpendicular to that layer. 
The overall electric field, then, looks like the initial incoming light wave added together with the second-order wave. 
By far the most distracting part of what's going on here is everything on the left, and this actually corresponds to the light being reflected back. 
And from experience, you all know that when you look at water or you look at glass, light not only goes through it, but some of it gets reflected back. 
And we could have a whole interesting discussion on quantifying exactly how much, but in the spirit of staying focused, we will completely ignore that for today and only focus on what's happening to the right of that layer. 
You can probably predict what I'm going to say. 
It turns out that when you add that second-order oscillation, the overall effect is almost identical to the incoming light, but just shifted back in phase by a little bit. 
And then because many successive shifts to the phase like this are the same thing as light slowing down, this will ultimately explain the index of refraction. 
But of course the sufficiently curious viewers will now be raising their hands and asking, why is that the effect when you add them together? 
And so here it might be worth a little sidebar on how to think about adding two waves together. 
If you draw some sine wave with some particular amplitude, some specific frequency, and some specific phase, and then you draw another sine wave, also with its own amplitude, frequency, and phase, in general it's very hard to think about what the sum of those two waves should look like as you tweak those initial parameters. 
In the specific case where the frequencies are the same, which is true for our example, the result will also look like a sine wave with that same frequency. 
But even then it's a little tricky to think about exactly how to describe that wave. 
It has some amplitude and some phase, and if I ask you to concretely compute both of those numbers based on the amplitudes and phases of the initial waves, it's not immediately clear how you would do that without throwing a bunch of trig identities at the problem. 
But here's a really nice way to think about it. 
Imagine that first wave describes the y-component of some rotating vector. 
The length of that vector corresponds with the amplitude of our wave, and then the initial rotation of that vector corresponds with the phase of our wave. 
Similarly, think of the second wave as describing the y-component of another rotating vector, where the amplitude corresponds with the length of that vector, and the phase of the wave tells us the initial angle of that vector. 
Now to think about the sum of the two waves, just think about adding those two vectors tip to tail. 
And because they both have the same frequency as both of them rotate, their sum rotates in lockstep with them. 
So if you want to think about the amplitude of our resulting wave, it comes down to the length of this vector sum, and similarly the phase corresponds to the angle of that vector sum. 
In some cases this tells you things that you probably already knew, like if the two phases happen to be the same, then you get constructive interference and you have a bigger wave that results. 
And if the phases were 180 degrees out of sync, then you get deconstructive interference with a relatively small resulting wave. 
What's a little bit less obvious, but what's crucial for our discussion here, is that if the phase of that second wave happens to be exactly 90 degrees behind the phase of the first, so kind of a quarter cycle out of sync, and if that second wave is also very small compared to the first, then if you look at the little vector sum on the lower left, you'll notice how this means that the resulting wave is almost identical to the initial wave, but has just shifted back in its phase by a tiny bit. 
Moreover, the size of that phase shift depends on the specific amplitude of that second wave. 
So looking back at our previous animation, where we have some wiggling charges in a layer of glass causing these second order propagations that need to be added together with the incoming light, the way it works out is that the phase of that second wave is exactly a quarter of a cycle behind the phase of the first. 
So when you add them together, you get this little phase shift. 
And then, critically, the size of that phase shift is bigger when that second order wave is larger, and then smaller when that second order wave is smaller. 
Again, the very curious viewers will be raising their hands and saying, why does it work out to be exactly a quarter of a cycle behind? 
There is a very nice reason, but it's just a little too much detail for us today. 
If you're curious, I highly encourage you to take a look at the Feynman lectures on the matter. 
For our purposes, step back for a second and think about what you need to explain the key question of prisms, which is why the index of refraction would depend on color at all. 
As you now know, that index depends on how much each layer of glass kicks back the phase of the wave, and that phase kick depends on the strength of the second order wave resulting from charge oscillations in a layer of that glass. 
So you need to drill in and understand exactly how much those charges wiggle in response to an incoming light wave. 
So let's zoom in on that layer and think of each one of those charged particles, and even though the specific molecular structure is going to be something very complicated, we're going to model each one of those charges as if it was bound to some equilibrium position by a spring, or maybe a set of springs. 
I don't mean this literally, of course, I just mean if we describe the displacement of this charge from its equilibrium with a little vector x that's going to depend on time, then in our model, the force applied to the charge, pulling it back to that equilibrium, is going to be something proportional to the size of that displacement, with a little proportionality constant k. 
This is the same law that governs how springs work. 
You might ask if that's accurate, and the idea is that for very small displacements, it's actually a really good approximation. 
This is a very common thing to do throughout physics, we would call it a linear restoring force. 
The idea is that maybe the actual force law depends on the position in a much more complicated way, but we're basically taking a low order approximation near the equilibrium. 
If I just run this as a simulation, plugging in this force law, here's what that displacement looks like as a function of time. 
What you get looks like a sine wave, this is called simple harmonic motion, and the frequency of this wave is going to matter a lot for you and me, and finding that comes down to solving a certain differential equation, because the force is really the same thing as mass times acceleration, and the acceleration is the same thing as the second derivative of that displacement. 
So what we're saying is we want some function whose second derivative looks like a certain constant times that function itself. 
Any differential equations students among you might enjoy thinking about how you solve this. 
I won't go over the full details, but the answer is reasonably intuitive, and anyone who knows a little calculus can just check it for themselves. 
The way it shakes out is that if the initial condition is that our little charge has a velocity of zero, but it's offset from the equilibrium by a little vector x-naught, then the way it evolves over time looks like x-naught multiplied by a cosine expression. 
So the amplitude of this wave is kind of uninteresting, it just depends on how far we pulled things back originally, but the meat is this frequency term, square root of k divided by m. 
And if you think about it, this should hopefully be at least a little intuitive. 
For example, if you increase k, which is kind of like increasing the strength of that spring, then it results in a faster oscillation. 
Whereas if you increase m, the mass of the particle, there's a lot more inertia and it results in a slower oscillation. 
This term, square root of k divided by m, has a special name, it's called the resonant frequency for our simple harmonic oscillator. 
And being a little more precise, I should call this the resonant angular frequency. 
This is always a little bit of an awkwardness with physics, where whenever you have some kind of cyclic process, when you give an intuitive description, it's natural to phrase things in terms of the frequency, the number of cycles that this process makes per unit time. 
But when doing math, it's often more natural to talk about the angular frequency, which you could think of as describing how much angle this process covers in radians per unit time. 
It's just the same as the frequency, but multiplied by 2 pi. 
So for example, if you have something like a cosine expression, which you might think of as describing the x component of a cycling vector like this, then the term sitting right in front of the t in that cosine is the angular frequency. 
This is why angular frequency makes the math a little cleaner. 
For example, in our simple harmonic motion, the term sitting in front of t looks like the square root of k divided by m, which I'm writing as omega sub r. 
Let's package all of that up and call that our solution in the simple case, where there's no external force acting on our charged particle. 
But of course, what we're interested in is what happens when you shine a beam of light on this material, which intuitively causes this charge to jiggle, but the question is how much. 
In our equation, this looks like adding a new force term corresponding to the light wave. 
That force oscillates up and down, also according to some kind of cosine function, but this time with a distinct angular frequency, that I'm going to call omega sub l. 
E naught here describes the strength of the wave, and then q describes the charge of whatever particle we're modeling. 
As usual, it's a lot easier to think about when we only draw a subset of that light wave, and in this case we're going to draw it on the plane of the layer of material we care about. 
You might think of gusts of wind blowing our little ball on the spring up and down in a clean sinusoidal pattern. 
Or as another analogy, it's similar to pushing a child on a swing. 
The swing would oscillate on its own due to the force of gravity, but you as the pusher are applying an external force which itself is oscillating over time. 
Although a key difference here is that the frequency of that external force in general has nothing to do with the resonant frequency of that little oscillator. 
The better analogy would be if you're pushing the child on the swing with a cyclic force that has nothing to do with what the swing naturally wants to do. 
And my favorite part in literally trying to do this with my niece is that at some point she gently murmurs to herself, this isn't how mom does it. 
Now, in trying to understand how much our charge is oscillating in response to the incoming light, let me start by just simulating it and plotting the result. 
You'll notice that there's a little startup period where it kind of has to get going, but then after that, mercifully, it looks nice and clean, just like another sine wave. 
Now you might be thinking, yeah, yeah, everything is sine waves, but it's important to understand that this one has a very different character from the sine wave we saw earlier. 
Earlier, without any external forces, the frequency of that wave came down to the spring constant and the mass, which is to say it depends exclusively on material properties of the glass. 
By contrast, with this external cycling driving force, the frequency in that steady state is the same as the frequency of the light. 
And then in our first case, the amplitude of the wave was kind of uninteresting, it just depends on how far you pulled the spring out to begin with. 
But in the second case, the amplitude of this wave is actually where all the interesting stuff happens. 
Exactly how much will this charge be oscillating in response to the light wave? 
Again, I won't go over the full details of solving this, but any eager calculus students among you might enjoy going through the exercise where if you just guess that a solution looks like a cosine wave with the same frequency as the light, and you solve for the amplitude, you can get a concrete solution to this equation that looks like this. 
This is worth unpacking for a bit, and just to be clear, this is only describing things in the steady state, after things have gotten up and going. 
A fully descriptive solution would be notably more complicated. 
As I said, everything interesting here comes down to the amplitude, which here looks like a large collection of constants, most of which should be pretty intuitive if you take a moment to think about it. 
For example, it is proportional to the strength of that incoming light wave, so the stronger the light the more the oscillations. 
It's also proportional to the charge, which again makes sense. 
And the real heart of the matter comes down to what's sitting in the denominator here, the difference between the square of the resonant frequency and the square of the light frequency. 
And to build a little intuition, take a moment to think about what would happen if the frequency of the incoming light was something very close to the resonant frequency of this oscillator. 
This is analogous to the normal situation pushing a child on a swing, where the frequency of your force lines up quite closely with what the swing wants to do. 
In this case, running the simulation, notice how the oscillations of that particle will grow and grow and grow, becoming quite large over time. 
Some of you may know the famous example of the Millennium Bridge in London, where on its opening day it started oscillating way more than the engineers expected it to. 
And what was going on is that the frequency of the steps of the crowd lined up very closely with a resonant frequency, causing this worryingly high amplitude. 
By contrast, notice what happens in the simulation if the frequency of the light, ωL, is something much smaller than the resonant frequency. 
For this particular simulation it takes a little bit of a moment before things get into their full swing, eventually it finds a nice sinusoidal motion, but the amplitude of that motion is much more modest in comparison. 
So what our equation is telling us is that the larger the difference between those frequencies, then the bigger the denominator, so the smaller the overall wiggle to that charge. 
And again, this is something you can see in the footage with my niece. 
As I'm applying a force with a frequency that's very different from what the swing wants to do, she ends up oscillating at the same frequency as my force, but she's going at a relatively low amplitude. 
Stepping back, what this means is that as you shine light into a material, like glass, it's not just that it induces wiggles in the charges of that material, but the specific size of those wiggles depends on the frequency of the light, as a consequence of this denominator term. 
And the more those wiggle, the bigger the size of this second order wave caused by that layer, which in turn causes a bigger shift to the phase of the overall wave. 
Because a lot of different shifts to the phase are what causes this apparent slowdown to the light, it means that the amount that it will slow down ultimately depends on the frequency of the light. 
So that is the real reason why prisms work. 
You cannot truly explain the light separation until you get down to the driven harmonic oscillator. 
Now, I have left out a number of details, and again, I encourage the curious viewers to take a look at the Feynman lectures that a lot of this is based on. 
One quite important detail that would be a little criminal not to mention is that when we're modeling our charge as a little harmonic oscillator with this linear restoring force, there should really also be a term that depends on the velocity of that charge. 
You might think of this as a kind of drag force. 
This term accounts for the fact that energy from the incoming light wave is absorbed by the material. 
Without it, this whole explanation would seem to imply that light always passes through every material, not just glass and water, when as you can tell just by looking around, there's all sorts of materials for which light is mostly reflected and absorbed. 
As I mentioned at the start, folks on Patreon had numerous questions about the index of refraction, like how it can be less than one, and why slowing implies bending, so I made a supplemental video answering a handful of those questions, which should be published in just a few days. 
In the meantime, my friend Mithuna from the channel Looking Glass Universe just put out a pair of videos on the related but definitely distinct question of whether light slows down in a medium, not in the sense of following the crests of a clean pure sine wave in a steady state, but in the sense of trying to send information through that medium, like with a little wave packet. 
I definitely owe the existence of this video to many conversations with her about this topic, and viewers here will definitely enjoy taking a look, especially at the second one. 
By the way, some collaborators and I made this notebook that I think a lot of viewers might enjoy, and given that it's the holiday season it seems worth a quick mention. 
The premise is that every one of the pages has a quote that's related to math, and I had a lot of fun curating them all, trying to constrain myself to quotes conveying some genuinely thought-provoking idea. 
And aside from the content, I basically made the kind of notebook that I most enjoy taking notes in, something that's readily portable with very faint grid lines helpful for diagrams but otherwise unobtrusive, all bound in this nice soft faux leather. 
If that seems up your alley, you can find them in the 3blue1brown store next to a lot of other mathematical merchandise.
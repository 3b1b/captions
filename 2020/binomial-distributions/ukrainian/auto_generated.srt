1
00:00:00,000 --> 00:00:02,900
Ви купуєте товар онлайн і бачите трьох різних продавців.

2
00:00:03,460 --> 00:00:06,200
Усі вони пропонують той самий продукт за фактично однаковою ціною.

3
00:00:06,720 --> 00:00:10,640
Один із них має 100% позитивний рейтинг, але лише 10 відгуків.

4
00:00:11,180 --> 00:00:14,740
Інший має 96% позитивних оцінок із 50 відгуками.

5
00:00:15,220 --> 00:00:19,560
І ще один має 93% позитивних оцінок, але 200 відгуків.

6
00:00:20,300 --> 00:00:21,360
У якого з них купувати?

7
00:00:28,120 --> 00:00:31,005
Я думаю, що всі ми відчуваємо, що чим більше даних ми бачимо, 

8
00:00:31,005 --> 00:00:33,240
це дає нам більше впевненості в даному рейтингу.

9
00:00:33,760 --> 00:00:36,069
Ми з деякою підозрою ставимося до 100% оцінок, 

10
00:00:36,069 --> 00:00:39,410
оскільки найчастіше вони походять від невеликої кількості відгуків, 

11
00:00:39,410 --> 00:00:43,440
що робить більш вірогідним те, що все могло піти іншим шляхом і дати нижчу оцінку.

12
00:00:43,920 --> 00:00:45,840
Але як зробити цю інтуїцію кількісною?

13
00:00:46,420 --> 00:00:49,667
Який раціональний спосіб міркувати про компроміс між впевненістю, 

14
00:00:49,667 --> 00:00:53,260
отриманою завдяки більшій кількості даних, і меншим абсолютним відсотком?

15
00:00:54,540 --> 00:00:57,377
Цей конкретний приклад є невеликою модифікацією того, 

16
00:00:57,377 --> 00:01:01,214
який Джон Кук навів у своєму чудовому дописі в блозі «Байєсівський огляд 

17
00:01:01,214 --> 00:01:02,160
реселерів Amazon».

18
00:01:02,620 --> 00:01:05,058
Для нас з вами це чудовий привід заглибитися в 

19
00:01:05,058 --> 00:01:07,600
кілька основних тем із ймовірності та статистики.

20
00:01:08,320 --> 00:01:11,000
І щоб справді правильно висвітлити ці теми, потрібен час.

21
00:01:11,560 --> 00:01:14,744
Отже, що я збираюся зробити, так це розбити це на три відео, 

22
00:01:14,744 --> 00:01:17,458
де в цьому першому ми створимо модель для ситуації, 

23
00:01:17,458 --> 00:01:19,860
і почнемо з розмови про біноміальний розподіл.

24
00:01:19,980 --> 00:01:23,086
Другий планує ввести ідеї байєсівського оновлення 

25
00:01:23,086 --> 00:01:26,380
та як працювати з ймовірностями безперервних значень.

26
00:01:27,040 --> 00:01:30,308
І в третьому ми розглянемо те, що називається бета-версією дистрибутива, 

27
00:01:30,308 --> 00:01:33,353
і запустимо невеликий Python, щоб проаналізувати дані, які у нас є, 

28
00:01:33,353 --> 00:01:36,980
і прийдемо до різних відповідей залежно від того, що саме ви хочете оптимізувати.

29
00:01:39,660 --> 00:01:42,329
Тепер, щоб кинути вам кістку, перш ніж ми зануримося в усю математику, 

30
00:01:42,329 --> 00:01:45,036
дозвольте мені просто показати вам, якою виявляється одна з відповідей, 

31
00:01:45,036 --> 00:01:46,240
оскільки вона неймовірно проста.

32
00:01:46,880 --> 00:01:51,039
Коли ви бачите онлайн-рейтинг на кшталт 10 із 10, ви вдаєте, 

33
00:01:51,039 --> 00:01:55,200
що було ще два відгуки: один позитивний, а другий негативний.

34
00:01:55,860 --> 00:02:00,479
У цьому випадку це означає, що ви вдаєте, що це 11 із 12, що дасть 91.7%.

35
00:02:01,500 --> 00:02:05,720
Це число означає ймовірність того, що ви матимете гарний досвід роботи з цим продавцем.

36
00:02:05,720 --> 00:02:12,844
Отже, у випадку з 50 відгуками, де у вас 48 позитивних і 2 негативних, ви вдаєте, 

37
00:02:12,844 --> 00:02:19,360
що насправді 49 позитивних і 3 негативні, що дасть вам 49 із 52, або 94.2%.

38
00:02:20,500 --> 00:02:23,840
Це ваша ймовірність мати хороший досвід з другим продавцем.

39
00:02:25,320 --> 00:02:28,954
Граючи в ту саму гру з нашим третім продавцем, 

40
00:02:28,954 --> 00:02:33,440
який мав 200 відгуків, ви отримуєте 187 із 202, або 92.6%.

41
00:02:34,640 --> 00:02:37,640
Отже, згідно з цим правилом, це означало б, що вам найкраще вибрати продавця номер 2.

42
00:02:37,640 --> 00:02:43,518
Це щось відоме як правило спадкоємності Лапласа. Воно сягає 18 століття. Щоб зрозуміти, 

43
00:02:43,518 --> 00:02:48,996
які припущення лежать в основі цього, і як зміна цих припущень або вашої основної 

44
00:02:48,996 --> 00:02:54,140
мети може змінити ваш вибір, нам дійсно потрібно пройти через вся математика.

45
00:02:54,660 --> 00:02:56,359
Отже, без зайвих слів, давайте зануримося.

46
00:03:00,840 --> 00:03:06,080
Крок 1, як саме ми моделюємо ситуацію, і що саме ви хочете оптимізувати?

47
00:03:06,700 --> 00:03:11,493
Один із варіантів полягає в тому, щоб уявити, що кожен продавець створює випадковий 

48
00:03:11,493 --> 00:03:16,115
позитивний або негативний досвід, і що кожен продавець має певну постійну базову 

49
00:03:16,115 --> 00:03:20,966
ймовірність надати хороший досвід, що ми будемо називати показником успіху або S для 

50
00:03:20,966 --> 00:03:21,480
короткий.

51
00:03:21,900 --> 00:03:24,100
Вся проблема полягає в тому, що ми не знаємо С.

52
00:03:25,640 --> 00:03:28,177
Коли ви бачите першу оцінку 100% із 10 відгуками, 

53
00:03:28,177 --> 00:03:31,120
це не означає, що основний показник успіху становить 100%.

54
00:03:31,640 --> 00:03:33,920
Цілком можливо, що це приблизно 95%.

55
00:03:33,920 --> 00:03:38,588
І просто для ілюстрації, дозвольте мені запустити невелику симуляцію, 

56
00:03:38,588 --> 00:03:42,857
де я вибираю випадкове число між 0 і 1, і якщо воно менше 0.95, 

57
00:03:42,857 --> 00:03:47,660
я запишу це як позитивний відгук, інакше запишу це як негативний відгук.

58
00:03:48,760 --> 00:03:54,062
Тепер зробіть це 10 разів поспіль, а потім зробіть ще 10, і ще 10, 

59
00:03:54,062 --> 00:03:58,018
і ще 10 і так далі, щоб отримати уявлення про те, 

60
00:03:58,018 --> 00:04:03,320
які послідовності з 10 відгуків для продавця з таким рівнем успіху 

61
00:04:03,320 --> 00:04:05,220
0.95 буде виглядати так.

62
00:04:05,740 --> 00:04:09,520
Досить багато з них, приблизно 60%, дають 10 з 10.

63
00:04:10,020 --> 00:04:12,531
Таким чином, дані, які ми бачимо, виглядають цілком правдоподібними, 

64
00:04:12,531 --> 00:04:14,460
якщо справжній показник успіху продавця становив 95%.

65
00:04:15,580 --> 00:04:18,039
А може, справді 90%, чи 99%.

66
00:04:18,700 --> 00:04:20,680
Вся проблема полягає в тому, що ми просто не знаємо.

67
00:04:21,600 --> 00:04:25,165
Що стосується мети, припустімо, що ви просто хочете максимізувати ймовірність 

68
00:04:25,165 --> 00:04:28,960
отримання позитивного досвіду, незважаючи на те, що ви не впевнені в такому успіху.

69
00:04:29,860 --> 00:04:31,340
Тож подумайте про це тут.

70
00:04:31,460 --> 00:04:35,652
У нас є багато різних можливих показників успіху для кожного продавця, 

71
00:04:35,652 --> 00:04:39,845
будь-яке число від 0 до 1, і нам потрібно сказати щось про ймовірність 

72
00:04:39,845 --> 00:04:43,920
кожного з цих показників успіху, свого роду ймовірність ймовірностей.

73
00:04:45,120 --> 00:04:47,612
На відміну від більш гейміфікованих прикладів, 

74
00:04:47,612 --> 00:04:50,636
таких як підкидання монети та підкидання кубика, і речі, 

75
00:04:50,636 --> 00:04:55,197
які ви бачите у вступному класі ймовірності, де ви припускаєте довгострокову частоту, 

76
00:04:55,197 --> 00:04:59,547
як-от 1 половина або 1 шоста, тут ми маємо невизначеність щодо сама довгострокова 

77
00:04:59,547 --> 00:05:02,040
частота, що є набагато сильнішим видом сумніву.

78
00:05:03,160 --> 00:05:06,452
Я також маю підкреслити, що такий тип налаштувань актуальний для багатьох, 

79
00:05:06,452 --> 00:05:09,217
багатьох ситуацій у реальному світі, коли вам потрібно зробити 

80
00:05:09,217 --> 00:05:11,720
судження про випадковий процес на основі обмежених даних.

81
00:05:12,860 --> 00:05:16,473
Наприклад, припустімо, що ви створюєте завод з виробництва автомобілів, 

82
00:05:16,473 --> 00:05:20,840
і під час початкового тестування 100 автомобілів у двох з них виявилася якась проблема.

83
00:05:21,400 --> 00:05:26,626
Якщо ви плануєте виробити мільйон автомобілів, що ви готові з упевненістю сказати про те, 

84
00:05:26,626 --> 00:05:30,460
скільки всього автомобілів матиме проблеми, які потрібно вирішити?

85
00:05:31,240 --> 00:05:36,660
Тест не гарантує, що справжній рівень помилок становить 2%, але що саме він говорить?

86
00:05:38,620 --> 00:05:40,320
Як ваш перший виклик, дозвольте мені запитати вас про це.

87
00:05:40,320 --> 00:05:45,798
Якби ви чарівним чином дізналися справжній рівень успіху для певного продавця, 

88
00:05:45,798 --> 00:05:51,137
скажімо, він становив 95%, як би ви обчислили ймовірність побачити, скажімо, 

89
00:05:51,137 --> 00:05:56,200
10 позитивних відгуків і 0 негативних відгуків, або 48 і 2, або 186 і 14?

90
00:05:57,120 --> 00:06:02,160
Іншими словами, яка ймовірність побачити дані за припущеного рівня успішності?

91
00:06:03,060 --> 00:06:05,901
Нещодавно я показав вам щось подібне за допомогою симуляції, 

92
00:06:05,901 --> 00:06:09,768
генеруючи 10 випадкових оглядів, і за допомогою невеликого програмування ви можете 

93
00:06:09,768 --> 00:06:13,915
просто робити це багато разів, створюючи гістограму, щоб отримати деяке уявлення про те, 

94
00:06:13,915 --> 00:06:15,080
як виглядає цей розподіл.

95
00:06:21,659 --> 00:06:25,645
Так само ви можете змоделювати набори з 50 відгуків і зрозуміти, 

96
00:06:25,645 --> 00:06:29,080
наскільки ймовірно побачити 48 позитивних і 2 негативні.

97
00:06:29,900 --> 00:06:31,580
Розумієте, це приємна річ про ймовірність.

98
00:06:31,960 --> 00:06:34,789
Невелике програмування майже завжди може дозволити вам трохи 

99
00:06:34,789 --> 00:06:37,480
схитрувати та заздалегідь побачити відповідь, імітуючи її.

100
00:06:37,840 --> 00:06:41,224
Наприклад, після кількох сотень тисяч зразків із 50 оглядів, 

101
00:06:41,224 --> 00:06:44,054
якщо припустити, що показник успіху становить 95%, 

102
00:06:44,054 --> 00:06:48,160
це виглядає приблизно як 26.1% із них поставили б нам цей відгук 48 із 50.

103
00:06:49,200 --> 00:06:52,440
На щастя, в цьому випадку точна формула зовсім непогана.

104
00:06:52,980 --> 00:06:56,820
Імовірність побачити рівно 48 із 50 виглядає так.

105
00:06:57,740 --> 00:07:01,151
Цей перший термін вимовляється як 50, виберіть 48, 

106
00:07:01,151 --> 00:07:04,294
і він представляє загальну кількість способів, 

107
00:07:04,294 --> 00:07:08,040
якими ви можете зайняти 50 слотів і заповнити 48 із них.

108
00:07:09,099 --> 00:07:13,676
Наприклад, можливо, ви починаєте з 48 хороших відгуків і закінчуєте 2 поганими відгуками, 

109
00:07:13,676 --> 00:07:16,219
або, можливо, ви починаєте з 47 хороших відгуків, 

110
00:07:16,219 --> 00:07:18,660
а потім стає поганим хорошим поганим і так далі.

111
00:07:19,100 --> 00:07:24,281
У принципі, якщо ви перерахуєте всі можливі способи заповнення 48 із 50 слотів, 

112
00:07:24,281 --> 00:07:28,621
подібних до цього, загальна кількість цих шаблонів становитиме 50, 

113
00:07:28,621 --> 00:07:31,860
виберіть 48, що в даному випадку становитиме 1225.

114
00:07:32,680 --> 00:07:34,000
Що ми множимо на цей рахунок?

115
00:07:34,000 --> 00:07:37,271
Ну, це ймовірність будь-якої з цих закономірностей, 

116
00:07:37,271 --> 00:07:42,869
тобто ймовірність одного позитивного відгуку, збільшена в 48 разів на ймовірність одного 

117
00:07:42,869 --> 00:07:44,820
негативного відгуку в квадраті.

118
00:07:45,640 --> 00:07:49,827
Вирішальним є те, що ми припускаємо, що кожен відгук не залежить від останнього, 

119
00:07:49,827 --> 00:07:53,602
тому ми можемо помножити всі ймовірності разом таким чином, і з числами, 

120
00:07:53,602 --> 00:07:57,428
які ми маємо, коли ви оцінюєте це, виходить 0.261, який збігається з тим, 

121
00:07:57,428 --> 00:08:00,220
що ми щойно бачили емпірично за допомогою моделювання.

122
00:08:01,380 --> 00:08:04,549
Ви також можете замінити це 48 на якесь інше значення та 

123
00:08:04,549 --> 00:08:08,775
обчислити ймовірність побачити будь-яку іншу кількість позитивних відгуків, 

124
00:08:08,775 --> 00:08:11,500
знову ж таки припускаючи даний рівень успішності.

125
00:08:14,760 --> 00:08:19,726
Те, на що ви зараз дивитеся, до речі, відоме в бізнесі як біноміальний розподіл, 

126
00:08:19,726 --> 00:08:23,160
один із найбільш фундаментальних розподілів імовірності.

127
00:08:23,860 --> 00:08:27,153
Він з’являється щоразу, коли ви маєте щось на кшталт підкидання монети, 

128
00:08:27,153 --> 00:08:29,988
випадкову подію, яка може відбуватися одним із двох способів, 

129
00:08:29,988 --> 00:08:32,687
і ви повторюєте це кілька разів, і те, що ви хочете знати, 

130
00:08:32,687 --> 00:08:34,700
— це ймовірність отримання різних підсумків.

131
00:08:34,700 --> 00:08:40,301
Для наших цілей ця формула дає нам ймовірність побачити дані з урахуванням припущеного 

132
00:08:40,301 --> 00:08:44,550
рівня успіху, який, зрештою, ми хочемо якимось чином використати, 

133
00:08:44,550 --> 00:08:49,958
щоб зробити судження про протилежне, ймовірність успіху з огляду на фіксовані дані, 

134
00:08:49,958 --> 00:08:50,860
які ми бачимо.

135
00:08:51,320 --> 00:08:53,440
Вони пов’язані, але безумовно різні.

136
00:08:54,060 --> 00:08:56,685
Щоб отримати більше інформації в цьому напрямку, 

137
00:08:56,685 --> 00:09:00,061
давайте пограємо з цим значенням s і подивимось, що станеться, 

138
00:09:00,061 --> 00:09:02,580
коли ми змінимо його на різні числа від 0 до 1.

139
00:09:04,560 --> 00:09:07,870
Біноміальний розподіл, який він створює, виглядає як ця купа, 

140
00:09:07,870 --> 00:09:10,860
яка зосереджена навколо будь-якого s, помноженого на 50.

141
00:09:11,460 --> 00:09:15,980
Цінність, яка нам важлива, ймовірність побачити 48 із 50 відгуків, 

142
00:09:15,980 --> 00:09:18,680
представлена цією виділеною 48-ю смугою.

143
00:09:19,400 --> 00:09:24,600
Тож давайте намалюємо другий графік внизу, який показує, як це значення залежить від s.

144
00:09:25,480 --> 00:09:30,320
Коли s дорівнює 0.96, це значення настільки високе, як воно ніколи не буде.

145
00:09:30,840 --> 00:09:34,903
І це мало б мати сенс, тому що, якщо ви подивитеся на цей огляд 96%, 

146
00:09:34,903 --> 00:09:39,319
це має бути найвірогідніше, якби справжній базовий показник успіху був 96%.

147
00:09:41,000 --> 00:09:45,424
Коли s збільшується, воно ніби зменшується, дорівнюючи 0, коли s наближається до 1, 

148
00:09:45,424 --> 00:09:50,006
оскільки хтось із ідеальним показником успішності ніколи не матиме цих двох негативних 

149
00:09:50,006 --> 00:09:50,480
відгуків.

150
00:09:51,420 --> 00:09:54,560
Крім того, коли ви рухаєтеся ліворуч, воно досить швидко наближається до 0.

151
00:09:56,900 --> 00:10:00,831
Коли ви дійдете до s дорівнює 0.8, отримання 48 із 50 відгуків 

152
00:10:00,831 --> 00:10:05,200
випадково надзвичайно рідкісне явище, це трапиться один раз із тисячі.

153
00:10:06,240 --> 00:10:09,810
Цей графік, який ми маємо внизу, є чудовим початком для отримання більш 

154
00:10:09,810 --> 00:10:13,380
кількісного опису, для якого значення s здаються більш-менш вірогідними.

155
00:10:14,200 --> 00:10:19,297
Записана як формула, я хочу, щоб ви запам’ятали, що як функція коефіцієнта успіху, 

156
00:10:19,297 --> 00:10:24,640
s, крива виглядає як деяка константа, помножена на s на кількість позитивних відгуків, 

157
00:10:24,640 --> 00:10:28,080
помножена на 1 мінус s на кількість негативних відгуків.

158
00:10:29,100 --> 00:10:32,628
В принципі, якби ми мали більше даних, як-от 480 позитивних відгуків 

159
00:10:32,628 --> 00:10:37,179
і 20 негативних відгуків, результуючий графік все одно був би зосереджений навколо 0.96, 

160
00:10:37,179 --> 00:10:39,480
але він був би меншим і більш концентрованим.

161
00:10:39,930 --> 00:10:44,220
Хорошою вправою зараз було б побачити, чи можете ви пояснити, чому це так.

162
00:10:45,480 --> 00:10:49,480
Однак залишається питання, що насправді робити з цими кривими.

163
00:10:50,220 --> 00:10:53,321
Я маю на увазі, що наша мета полягає в тому, щоб обчислити ймовірність того, 

164
00:10:53,321 --> 00:10:56,020
що у вас є хороший досвід роботи з цим продавцем, тож що ви робите?

165
00:10:57,000 --> 00:10:59,958
Наївно ви могли б подумати, що ймовірність становить 96%, 

166
00:10:59,958 --> 00:11:02,355
оскільки саме там знаходиться вершина графіка, 

167
00:11:02,355 --> 00:11:05,160
що в певному сенсі є найвірогіднішим показником успіху.

168
00:11:05,620 --> 00:11:07,860
Але подумайте про приклад із 10 із 10 позитивів.

169
00:11:07,860 --> 00:11:13,260
У цьому випадку вся біноміальна формула спрощується до s у степені 10.

170
00:11:15,080 --> 00:11:18,921
Імовірність побачити 10 послідовних хороших відгуків – це ймовірність побачити, 

171
00:11:18,921 --> 00:11:20,650
що один із них підвищиться до 10-го.

172
00:11:21,320 --> 00:11:26,660
Чим ближче справжній показник успіху до 1, тим вища ймовірність побачити 10 із 10.

173
00:11:27,220 --> 00:11:30,980
Наш графік унизу лише збільшується, коли s наближається до 1.

174
00:11:32,400 --> 00:11:36,272
Але навіть якщо s дорівнює 1 – це значення, яке максимізує цю ймовірність, 

175
00:11:36,272 --> 00:11:38,905
ви, звичайно, не почуватиметеся комфортно, кажучи, 

176
00:11:38,905 --> 00:11:42,520
що особисто у вас є 100% ймовірність хорошого досвіду з цим продавцем.

177
00:11:43,460 --> 00:11:48,196
Можливо, ви думаєте, що замість цього нам слід шукати якийсь центр мас цього графіка, 

178
00:11:48,196 --> 00:11:50,400
і це було б абсолютно правильним шляхом.

179
00:11:51,300 --> 00:11:56,287
Однак спочатку нам потрібно пояснити, як прийняти цей вираз для ймовірності даних, 

180
00:11:56,287 --> 00:12:00,493
які ми бачимо, із значенням s, і отримати ймовірність для значення s, 

181
00:12:00,493 --> 00:12:04,880
чого ми насправді не знаємо, враховуючи дані, те, що ми насправді знаємо.

182
00:12:05,380 --> 00:12:07,880
І це вимагає від нас говорити про правило Байєса, 

183
00:12:07,880 --> 00:12:09,980
а також про функції щільності ймовірності.

184
00:12:10,620 --> 00:12:12,060
Тому я побачу вас у частині 2.


1
00:00:00,000 --> 00:00:02,900
Вы покупаете товар в Интернете и видите трех разных продавцов.

2
00:00:03,460 --> 00:00:06,200
Все они предлагают один и тот же продукт, по сути, по одной и той же цене.

3
00:00:06,720 --> 00:00:10,640
Один из них имеет 100% положительный рейтинг, но имеет всего 10 отзывов.

4
00:00:11,180 --> 00:00:14,740
Другой имеет положительный рейтинг 96% и общее количество отзывов 50.

5
00:00:15,220 --> 00:00:19,560
И еще один имеет положительный рейтинг 93%, но общее количество отзывов составляет 200.

6
00:00:20,300 --> 00:00:21,360
У какого из них стоит покупать?

7
00:00:28,120 --> 00:00:31,129
Я думаю, что у всех нас есть инстинкт: чем больше данных мы видим, 

8
00:00:31,129 --> 00:00:33,240
тем больше уверенности в том или ином рейтинге.

9
00:00:33,760 --> 00:00:36,259
Мы немного подозрительно относимся к 100%-ным оценкам, 

10
00:00:36,259 --> 00:00:39,304
поскольку чаще всего они основаны на небольшом количестве обзоров, 

11
00:00:39,304 --> 00:00:42,485
что делает более вероятным, что все могло пойти по-другому и получить 

12
00:00:42,485 --> 00:00:43,440
более низкий рейтинг.

13
00:00:43,920 --> 00:00:45,840
Но как сделать эту интуицию количественной?

14
00:00:46,420 --> 00:00:49,317
Как рационально рассуждать о компромиссе между уверенностью, 

15
00:00:49,317 --> 00:00:53,260
полученной за счет большего количества данных, и более низким абсолютным процентом?

16
00:00:54,540 --> 00:00:57,812
Этот конкретный пример представляет собой небольшую модификацию примера, 

17
00:00:57,812 --> 00:01:01,801
который Джон Кук привел в своем превосходном посте в блоге «Байесовский обзор реселлеров 

18
00:01:01,801 --> 00:01:02,160
Amazon».

19
00:01:02,620 --> 00:01:04,966
Для нас с вами это прекрасный повод углубиться в 

20
00:01:04,966 --> 00:01:07,600
несколько основных тем теории вероятности и статистики.

21
00:01:08,320 --> 00:01:11,000
И чтобы действительно правильно осветить эти темы, требуется время.

22
00:01:11,560 --> 00:01:14,364
Итак, я собираюсь разбить это на три видеоролика, 

23
00:01:14,364 --> 00:01:18,345
в первом из которых мы создадим модель ситуации и начнем с разговора о 

24
00:01:18,345 --> 00:01:19,860
биномиальном распределении.

25
00:01:19,980 --> 00:01:23,063
Второй принесет идеи байесовского обновления и того, 

26
00:01:23,063 --> 00:01:26,380
как работать с вероятностями над непрерывными значениями.

27
00:01:27,040 --> 00:01:30,120
А в-третьих, мы рассмотрим нечто, известное как бета-дистрибутив, 

28
00:01:30,120 --> 00:01:33,293
и задействуем небольшой Python для анализа имеющихся у нас данных и 

29
00:01:33,293 --> 00:01:36,980
придем к различным ответам в зависимости от того, что вы хотите оптимизировать.

30
00:01:39,660 --> 00:01:42,501
Теперь, чтобы бросить вам кость, прежде чем мы углубимся во всю математику, 

31
00:01:42,501 --> 00:01:45,006
позвольте мне просто показать вам, каким окажется один из ответов, 

32
00:01:45,006 --> 00:01:46,240
поскольку он восхитительно прост.

33
00:01:46,880 --> 00:01:51,360
Когда вы видите онлайн-рейтинг, что-то вроде этого 10 из 10, вы делаете вид, 

34
00:01:51,360 --> 00:01:55,200
что было еще два отзыва: один положительный, другой отрицательный.

35
00:01:55,860 --> 00:02:00,479
В данном случае это означает, что вы притворяетесь, что это 11 из 12, что даст 91.7%.

36
00:02:01,500 --> 00:02:03,747
Это число показывает вероятность того, что у вас 

37
00:02:03,747 --> 00:02:05,720
будет хороший опыт работы с этим продавцом.

38
00:02:05,720 --> 00:02:11,447
Итак, в случае с 50 отзывами, где у вас 48 положительных и 2 отрицательных, 

39
00:02:11,447 --> 00:02:16,873
вы притворяетесь, что на самом деле 49 положительных и 3 отрицательных, 

40
00:02:16,873 --> 00:02:19,360
что даст вам 49 из 52, или 94.2%.

41
00:02:20,500 --> 00:02:23,840
Это ваша вероятность получить хороший опыт работы со вторым продавцом.

42
00:02:25,320 --> 00:02:30,856
Играя в ту же игру с нашим третьим продавцом, у которого было 200 отзывов, 

43
00:02:30,856 --> 00:02:33,440
вы получаете 187 из 202, или 92.6%.

44
00:02:34,640 --> 00:02:37,640
Таким образом, согласно этому правилу, лучше всего выбрать продавца номер 2.

45
00:02:37,640 --> 00:02:41,132
Это то, что известно как правило преемственности Лапласа, 

46
00:02:41,132 --> 00:02:45,107
оно восходит к 18 веку. Чтобы понять, какие предположения лежат в 

47
00:02:45,107 --> 00:02:49,141
основе этого и как изменение этих предположений или вашей основной 

48
00:02:49,141 --> 00:02:54,140
цели может изменить ваш выбор, нам действительно нужно пройти через вся математика.

49
00:02:54,660 --> 00:02:56,359
Итак, без дальнейших церемоний, давайте углубимся.

50
00:03:00,840 --> 00:03:06,080
Шаг 1. Как именно мы моделируем ситуацию и что именно вы хотите оптимизировать?

51
00:03:06,700 --> 00:03:10,604
Один из вариантов состоит в том, чтобы думать о каждом продавце как о производителе 

52
00:03:10,604 --> 00:03:14,089
случайного опыта, который является либо положительным, либо отрицательным, 

53
00:03:14,089 --> 00:03:18,273
и что у каждого продавца есть некоторая постоянная базовая вероятность дать хороший опыт, 

54
00:03:18,273 --> 00:03:21,480
которую мы собираемся назвать показателем успеха, или S для короткий.

55
00:03:21,900 --> 00:03:24,100
Вся проблема в том, что мы не знаем С.

56
00:03:25,640 --> 00:03:28,101
Когда вы видите первый рейтинг 100 % при 10 отзывах, 

57
00:03:28,101 --> 00:03:31,120
это не означает, что основной показатель успеха составляет 100 %.

58
00:03:31,640 --> 00:03:33,920
Вполне возможно, что это будет около 95%.

59
00:03:33,920 --> 00:03:38,120
И просто для иллюстрации позвольте мне запустить небольшую симуляцию, 

60
00:03:38,120 --> 00:03:42,739
в которой я выбираю случайное число от 0 до 1, а также если оно меньше 0.95, 

61
00:03:42,739 --> 00:03:47,660
запишу как положительный отзыв, в противном случае запишу как отрицательный отзыв.

62
00:03:48,760 --> 00:03:54,169
Теперь сделайте это 10 раз подряд, а затем сделайте еще 10, и еще 10, 

63
00:03:54,169 --> 00:03:59,424
и еще 10, и так далее, чтобы понять, какая последовательность из 10 

64
00:03:59,424 --> 00:04:05,220
отзывов у продавца с таким показателем успешности 0.95 будет выглядеть так.

65
00:04:05,740 --> 00:04:09,520
Довольно многие из них, около 60%, дают 10 из 10.

66
00:04:10,020 --> 00:04:12,592
Таким образом, данные, которые мы видим, кажутся вполне правдоподобными, 

67
00:04:12,592 --> 00:04:14,460
если истинный уровень успеха продавца составляет 95%.

68
00:04:15,580 --> 00:04:18,039
А может быть, это действительно 90% или 99%.

69
00:04:18,700 --> 00:04:20,680
Вся проблема в том, что мы просто не знаем.

70
00:04:21,600 --> 00:04:25,372
Что касается цели, скажем, вы просто хотите максимизировать вероятность получения 

71
00:04:25,372 --> 00:04:28,960
положительного опыта, несмотря на то, что не уверены в этом показателе успеха.

72
00:04:29,860 --> 00:04:31,340
Так что подумайте вот об этом.

73
00:04:31,460 --> 00:04:35,760
У нас есть много различных возможных показателей успеха для каждого продавца, 

74
00:04:35,760 --> 00:04:38,902
любое число от 0 до 1, и нам нужно что-то сказать о том, 

75
00:04:38,902 --> 00:04:41,880
насколько вероятен каждый из этих показателей успеха, 

76
00:04:41,880 --> 00:04:43,920
своего рода вероятность вероятностей.

77
00:04:45,120 --> 00:04:49,068
В отличие от более игровых примеров, таких как подбрасывание монеты и подбрасывание 

78
00:04:49,068 --> 00:04:53,063
игральной кости, а также тех вещей, которые вы видите на вводном классе вероятности, 

79
00:04:53,063 --> 00:04:56,729
где вы предполагаете долгосрочную частоту, например, 1 половину или 1 шестую, 

80
00:04:56,729 --> 00:04:59,925
здесь мы имеем неуверенность в отношении сама долгосрочная частота, 

81
00:04:59,925 --> 00:05:02,040
что является гораздо более сильным сомнением.

82
00:05:03,160 --> 00:05:05,982
Я также должен подчеркнуть, что такая установка актуальна для 

83
00:05:05,982 --> 00:05:08,623
многих и многих ситуаций в реальном мире, когда вам нужно 

84
00:05:08,623 --> 00:05:11,720
вынести суждение о случайном процессе на основе ограниченных данных.

85
00:05:12,860 --> 00:05:16,491
Например, предположим, что вы открываете завод по производству автомобилей, 

86
00:05:16,491 --> 00:05:20,409
и при первоначальном тестировании 100 автомобилей у двух из них возникла какая-то 

87
00:05:20,409 --> 00:05:20,840
проблема.

88
00:05:21,400 --> 00:05:24,861
Если вы планируете развернуть производство до миллиона автомобилей, 

89
00:05:24,861 --> 00:05:29,034
что вы готовы с уверенностью сказать о том, сколько всего автомобилей будет иметь 

90
00:05:29,034 --> 00:05:30,460
проблемы, требующие решения?

91
00:05:31,240 --> 00:05:35,331
Это не значит, что тест гарантирует, что истинная доля ошибок составляет 2%, 

92
00:05:35,331 --> 00:05:36,660
но что именно он говорит?

93
00:05:38,620 --> 00:05:40,320
В качестве вашего первого задания позвольте мне спросить вас вот о чем.

94
00:05:40,320 --> 00:05:46,433
Если бы вы каким-то волшебным образом узнали истинный процент успеха данного продавца, 

95
00:05:46,433 --> 00:05:50,789
скажем, 95%, как бы вы вычислили вероятность увидеть, скажем, 

96
00:05:50,789 --> 00:05:56,200
10 положительных отзывов и 0 отрицательных отзывов, или 48 и 2, или 186 и 14?

97
00:05:57,120 --> 00:06:02,160
Другими словами, какова вероятность увидеть данные при предполагаемом показателе успеха?

98
00:06:03,060 --> 00:06:05,907
Минуту назад я показал вам что-то подобное с помощью моделирования, 

99
00:06:05,907 --> 00:06:09,090
генерирующего 10 случайных обзоров, и с помощью небольшого программирования 

100
00:06:09,090 --> 00:06:11,855
вы могли бы просто проделать это много раз, построив гистограмму, 

101
00:06:11,855 --> 00:06:15,080
чтобы получить некоторое представление о том, как выглядит это распределение.

102
00:06:21,659 --> 00:06:25,306
Аналогичным образом вы можете смоделировать наборы из 50 отзывов и получить некоторое 

103
00:06:25,306 --> 00:06:29,080
представление о том, насколько вероятно будет увидеть 48 положительных и 2 отрицательных.

104
00:06:29,900 --> 00:06:31,580
Видите ли, в вероятности есть хорошая особенность.

105
00:06:31,960 --> 00:06:34,572
Небольшое программирование почти всегда позволит вам 

106
00:06:34,572 --> 00:06:37,480
немного схитрить и заранее увидеть ответ, смоделировав его.

107
00:06:37,840 --> 00:06:41,058
Например, после нескольких сотен тысяч образцов из 50 обзоров, 

108
00:06:41,058 --> 00:06:44,021
если предположить, что вероятность успеха составляет 95%, 

109
00:06:44,021 --> 00:06:48,160
это будет выглядеть примерно как 26.1% из них дали бы нам этот отзыв на 48 из 50.

110
00:06:49,200 --> 00:06:52,440
К счастью, в этом случае точная формула совсем не плоха.

111
00:06:52,980 --> 00:06:56,820
Вероятность увидеть ровно 48 из 50 выглядит так.

112
00:06:57,740 --> 00:07:02,890
Этот первый термин произносится как 50, выберите 48 и представляет собой общее 

113
00:07:02,890 --> 00:07:08,040
количество способов, которыми вы можете занять 50 слотов и заполнить 48 из них.

114
00:07:09,099 --> 00:07:12,286
Например, возможно, вы начинаете с 48 хороших отзывов и заканчиваете 

115
00:07:12,286 --> 00:07:15,796
двумя плохими отзывами, или, может быть, вы начинаете с 47 хороших отзывов, 

116
00:07:15,796 --> 00:07:18,660
а затем они становятся плохими, хорошими, плохими и так далее.

117
00:07:19,100 --> 00:07:23,245
В принципе, если вам придется перечислить все возможные способы 

118
00:07:23,245 --> 00:07:28,815
заполнения 48 из 50 слотов таким образом, общее количество этих шаблонов составит 50, 

119
00:07:28,815 --> 00:07:31,860
выберите 48, что в данном случае составит 1225.

120
00:07:32,680 --> 00:07:34,000
Что мы умножим на это число?

121
00:07:34,000 --> 00:07:37,868
Что ж, это вероятность любого из этих шаблонов, то есть вероятность того, 

122
00:07:37,868 --> 00:07:41,422
что один положительный отзыв будет увеличен в 48 раз по сравнению с 

123
00:07:41,422 --> 00:07:44,820
вероятностью одного отрицательного отзыва, возведенной в квадрат.

124
00:07:45,640 --> 00:07:49,643
Крайне важно то, что мы предполагаем, что каждый обзор независим от предыдущего, 

125
00:07:49,643 --> 00:07:52,707
поэтому мы можем перемножить все вероятности вместе, вот так, 

126
00:07:52,707 --> 00:07:56,266
и с имеющимися у нас числами, когда вы их оцениваете, получается 0.261, 

127
00:07:56,266 --> 00:08:00,220
что соответствует тому, что мы только что увидели эмпирически при моделировании.

128
00:08:01,380 --> 00:08:04,951
Вы также можете заменить это число 48 каким-либо другим значением 

129
00:08:04,951 --> 00:08:09,227
и вычислить вероятность увидеть любое другое количество положительных отзывов, 

130
00:08:09,227 --> 00:08:11,500
опять же принимая заданный уровень успеха.

131
00:08:14,760 --> 00:08:19,236
Между прочим, то, на что вы сейчас смотрите, известно в бизнесе как биномиальное 

132
00:08:19,236 --> 00:08:23,160
распределение, одно из самых фундаментальных распределений вероятности.

133
00:08:23,860 --> 00:08:27,688
Он возникает всякий раз, когда у вас происходит что-то вроде подбрасывания монеты, 

134
00:08:27,688 --> 00:08:30,456
случайное событие, которое может пойти одним из двух путей, 

135
00:08:30,456 --> 00:08:33,915
и вы повторяете его несколько раз, и вам нужно знать вероятность получения 

136
00:08:33,915 --> 00:08:34,700
различных итогов.

137
00:08:34,700 --> 00:08:38,635
Для наших целей эта формула дает нам вероятность увидеть данные с 

138
00:08:38,635 --> 00:08:42,571
учетом предполагаемого уровня успеха, которую в конечном итоге мы 

139
00:08:42,571 --> 00:08:46,864
хотим каким-то образом использовать для вынесения суждений об обратном, 

140
00:08:46,864 --> 00:08:50,860
вероятности успеха с учетом фиксированных данных, которые мы видим.

141
00:08:51,320 --> 00:08:53,440
Они связаны, но определенно различны.

142
00:08:54,060 --> 00:08:59,081
Чтобы добиться большего в этом направлении, давайте поиграем со значением s и посмотрим, 

143
00:08:59,081 --> 00:09:02,580
что произойдет, если мы изменим его на разные числа от 0 до 1.

144
00:09:04,560 --> 00:09:08,039
Биномиальное распределение, которое он производит, выглядит как эта куча, 

145
00:09:08,039 --> 00:09:10,860
сосредоточенная вокруг того, что равно s, умноженному на 50.

146
00:09:11,460 --> 00:09:15,948
Ценность, которая нас волнует, вероятность увидеть 48 отзывов из 50, 

147
00:09:15,948 --> 00:09:18,680
представлена этой выделенной 48-й полосой.

148
00:09:19,400 --> 00:09:24,600
Итак, давайте нарисуем второй график внизу, показывающий, как это значение зависит от s.

149
00:09:25,480 --> 00:09:28,192
Когда s равно 0.96, это значение настолько велико, 

150
00:09:28,192 --> 00:09:30,320
насколько оно когда-либо сможет достичь.

151
00:09:30,840 --> 00:09:35,284
И это должно иметь смысл, потому что, если вы посмотрите на этот обзор 96%, 

152
00:09:35,284 --> 00:09:39,319
наиболее вероятно, что истинный базовый уровень успеха составлял 96%.

153
00:09:41,000 --> 00:09:44,613
По мере увеличения s оно как бы сходит на нет, приближаясь к 0 по мере того, 

154
00:09:44,613 --> 00:09:47,851
как s приближается к 1, поскольку у человека с идеальным показателем 

155
00:09:47,851 --> 00:09:50,480
успеха никогда не будет этих двух отрицательных отзывов.

156
00:09:51,420 --> 00:09:54,560
Кроме того, при движении влево оно довольно быстро приближается к 0.

157
00:09:56,900 --> 00:10:00,344
К тому времени, как вы доберетесь до s, оно будет равно 0.8, 

158
00:10:00,344 --> 00:10:05,200
случайно получить 48 отзывов из 50 — крайне редко, такое случается один раз на тысячу.

159
00:10:06,240 --> 00:10:10,250
Этот график внизу — отличное начало для получения более количественного описания, 

160
00:10:10,250 --> 00:10:13,380
для которого значения s кажутся более или менее правдоподобными.

161
00:10:14,200 --> 00:10:17,380
Записанная в виде формулы, я хочу, чтобы вы запомнили, 

162
00:10:17,380 --> 00:10:21,544
что кривая в зависимости от показателя успеха s выглядит как константа, 

163
00:10:21,544 --> 00:10:24,610
умноженная на s на количество положительных отзывов, 

164
00:10:24,610 --> 00:10:28,080
умноженная на 1 минус s на количество отрицательных отзывов.

165
00:10:29,100 --> 00:10:32,691
В принципе, если бы у нас было больше данных, например 480 положительных 

166
00:10:32,691 --> 00:10:36,085
отзывов и 20 отрицательных отзывов, итоговый график все равно был бы 

167
00:10:36,085 --> 00:10:39,480
сосредоточен вокруг 0.96, но он будет меньше и более сконцентрирован.

168
00:10:39,930 --> 00:10:42,374
Хорошим упражнением прямо сейчас было бы посмотреть, 

169
00:10:42,374 --> 00:10:44,220
сможете ли вы объяснить, почему это так.

170
00:10:45,480 --> 00:10:49,480
Однако остается вопрос, что на самом деле делать с этими кривыми.

171
00:10:50,220 --> 00:10:52,852
Я имею в виду, что наша цель — вычислить вероятность того, 

172
00:10:52,852 --> 00:10:56,020
что у вас будет хороший опыт работы с этим продавцом, и что вам делать?

173
00:10:57,000 --> 00:10:59,592
Наивно вы можете подумать, что вероятность равна 96%, 

174
00:10:59,592 --> 00:11:03,767
поскольку именно здесь находится пик графика, что в некотором смысле является наиболее 

175
00:11:03,767 --> 00:11:05,160
вероятным показателем успеха.

176
00:11:05,620 --> 00:11:07,860
Но подумайте о примере с 10 из 10 положительных результатов.

177
00:11:07,860 --> 00:11:13,260
В этом случае вся биномиальная формула упрощается до s в степени 10.

178
00:11:15,080 --> 00:11:18,615
Вероятность увидеть 10 хороших отзывов подряд — это вероятность увидеть, 

179
00:11:18,615 --> 00:11:20,650
что один из них поднимется до 10-го места.

180
00:11:21,320 --> 00:11:26,660
Чем ближе истинный показатель успеха к 1, тем выше вероятность увидеть 10 из 10.

181
00:11:27,220 --> 00:11:30,980
Наш график внизу увеличивается только тогда, когда s приближается к 1.

182
00:11:32,400 --> 00:11:36,088
Но даже если s равно 1 — это значение, которое максимизирует эту вероятность, 

183
00:11:36,088 --> 00:11:38,878
вы, конечно, не будете чувствовать себя комфортно, говоря, 

184
00:11:38,878 --> 00:11:42,520
что лично у вас есть 100% вероятность хорошего опыта работы с этим продавцом.

185
00:11:43,460 --> 00:11:46,979
Может быть, вы думаете, что вместо этого нам следует поискать какой-то 

186
00:11:46,979 --> 00:11:50,400
центр масс этого графа, и это будет абсолютно правильное направление.

187
00:11:51,300 --> 00:11:56,113
Однако сначала нам нужно объяснить, как взять это выражение для вероятности данных, 

188
00:11:56,113 --> 00:12:00,296
которые мы видим, при значении s, и получить вероятность для значения s, 

189
00:12:00,296 --> 00:12:04,880
чего мы на самом деле не знаем, учитывая данные, то, что мы действительно знаем.

190
00:12:05,380 --> 00:12:07,907
И это требует от нас поговорить о правиле Байеса, 

191
00:12:07,907 --> 00:12:09,980
а также о функциях плотности вероятности.

192
00:12:10,620 --> 00:12:12,060
Для них увидимся во второй части.


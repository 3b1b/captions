1
00:00:00,000 --> 00:00:03,200
Вы покупаете товар в Интернете и видите трех разных продавцов.

2
00:00:03,200 --> 00:00:06,560
Все они предлагают один и тот же продукт, по сути, по одной и той же цене.

3
00:00:06,560 --> 00:00:11,040
Один из них имеет 100% положительный рейтинг, но имеет всего 10 отзывов.

4
00:00:11,040 --> 00:00:15,040
Другой имеет положительный рейтинг 96% и общее количество отзывов 50.

5
00:00:15,040 --> 00:00:20,080
И еще один имеет положительный рейтинг 93%, но общее количество отзывов составляет 200.

6
00:00:20,080 --> 00:00:21,200
У какого из них стоит покупать?

7
00:00:21,200 --> 00:00:27,360
Я думаю, что у всех нас есть инстинкт: чем больше данных

8
00:00:27,360 --> 00:00:33,520
мы видим, тем больше уверенности в том или ином рейтинге.

9
00:00:33,520 --> 00:00:36,911
Мы немного подозрительно относимся к 100%-ным оценкам, поскольку чаще

10
00:00:36,911 --> 00:00:40,254
всего они основаны на небольшом количестве обзоров, что делает более

11
00:00:40,254 --> 00:00:43,840
вероятным, что все могло пойти по-другому и получить более низкий рейтинг.

12
00:00:43,840 --> 00:00:46,240
Но как сделать эту интуицию количественной?

13
00:00:46,240 --> 00:00:50,280
Как рационально рассуждать о компромиссе между уверенностью, полученной

14
00:00:50,280 --> 00:00:54,320
за счет большего количества данных, и более низким абсолютным процентом?

15
00:00:54,320 --> 00:00:58,448
Этот конкретный пример представляет собой небольшую модификацию примера, который Джон

16
00:00:58,448 --> 00:01:02,480
Кук привел в своем превосходном посте в блоге «Байесовский обзор реселлеров Amazon».

17
00:01:02,480 --> 00:01:05,118
Для нас с вами это прекрасный повод углубиться в

18
00:01:05,118 --> 00:01:08,080
несколько основных тем теории вероятности и статистики.

19
00:01:08,080 --> 00:01:11,360
И чтобы действительно правильно осветить эти темы, требуется время.

20
00:01:11,360 --> 00:01:15,937
Итак, я собираюсь разбить это на три видеоролика, в первом из которых мы

21
00:01:15,937 --> 00:01:20,640
создадим модель ситуации и начнем с разговора о биномиальном распределении.

22
00:01:20,640 --> 00:01:23,723
Второй принесет идеи байесовского обновления и того,

23
00:01:23,723 --> 00:01:27,040
как работать с вероятностями над непрерывными значениями.

24
00:01:27,040 --> 00:01:31,075
А в-третьих, мы рассмотрим нечто, известное как бета-дистрибутив, и

25
00:01:31,075 --> 00:01:35,407
задействуем небольшой Python для анализа имеющихся у нас данных и придем

26
00:01:35,407 --> 00:01:39,680
к различным ответам в зависимости от того, что вы хотите оптимизировать.

27
00:01:39,680 --> 00:01:43,276
Теперь, чтобы бросить вам кость, прежде чем мы углубимся во всю математику, позвольте

28
00:01:43,276 --> 00:01:47,040
мне просто показать вам, каким окажется один из ответов, поскольку он восхитительно прост.

29
00:01:47,040 --> 00:01:51,470
Когда вы видите онлайн-рейтинг, что-то вроде этого 10 из 10, вы делаете

30
00:01:51,470 --> 00:01:55,840
вид, что было еще два отзыва: один положительный, другой отрицательный.

31
00:01:55,840 --> 00:02:01,615
В данном случае это означает, что вы притворяетесь, что это 11 из 12, что даст 91.

32
00:02:01,615 --> 00:02:01,760
7%.

33
00:02:01,760 --> 00:02:05,126
Это число показывает вероятность того, что у вас

34
00:02:05,126 --> 00:02:08,080
будет хороший опыт работы с этим продавцом.

35
00:02:08,080 --> 00:02:13,052
Итак, в случае с 50 отзывами, где у вас 48 положительных и 2 отрицательных, вы

36
00:02:13,052 --> 00:02:18,591
притворяетесь, что на самом деле 49 положительных и 3 отрицательных, что даст вам 49 из

37
00:02:18,591 --> 00:02:19,283
52, или 94.

38
00:02:19,283 --> 00:02:20,560
2%.

39
00:02:20,560 --> 00:02:25,520
Это ваша вероятность получить хороший опыт работы со вторым продавцом.

40
00:02:25,520 --> 00:02:29,587
Играя в ту же игру с нашим третьим продавцом, у которого

41
00:02:29,587 --> 00:02:33,156
было 200 отзывов, вы получаете 187 из 202, или 92.

42
00:02:33,156 --> 00:02:34,960
6%.

43
00:02:34,960 --> 00:02:39,520
Таким образом, согласно этому правилу, лучше всего выбрать продавца номер 2.

44
00:02:39,520 --> 00:02:43,375
Это то, что известно как правило преемственности Лапласа, оно восходит

45
00:02:43,375 --> 00:02:47,068
к 18 веку. Чтобы понять, какие предположения лежат в основе этого и

46
00:02:47,068 --> 00:02:50,978
как изменение этих предположений или вашей основной цели может изменить

47
00:02:50,978 --> 00:02:54,400
ваш выбор, нам действительно нужно пройти через вся математика.

48
00:02:54,400 --> 00:03:00,800
Итак, без дальнейших церемоний, давайте углубимся.

49
00:03:00,800 --> 00:03:06,960
Шаг 1. Как именно мы моделируем ситуацию и что именно вы хотите оптимизировать?

50
00:03:06,960 --> 00:03:10,869
Один из вариантов состоит в том, чтобы думать о каждом продавце как о производителе

51
00:03:10,869 --> 00:03:14,453
случайного опыта, который является либо положительным, либо отрицательным, и

52
00:03:14,453 --> 00:03:18,269
что у каждого продавца есть некоторая постоянная базовая вероятность дать хороший

53
00:03:18,269 --> 00:03:21,760
опыт, которую мы собираемся назвать показателем успеха, или S для короткий.

54
00:03:21,760 --> 00:03:25,520
Вся проблема в том, что мы не знаем С.

55
00:03:25,520 --> 00:03:28,733
Когда вы видите первый рейтинг 100 % при 10 отзывах, это не

56
00:03:28,733 --> 00:03:31,840
означает, что основной показатель успеха составляет 100 %.

57
00:03:31,840 --> 00:03:34,800
Вполне возможно, что это будет около 95%.

58
00:03:34,800 --> 00:03:38,270
И просто для иллюстрации позвольте мне запустить небольшую симуляцию,

59
00:03:38,270 --> 00:03:41,889
в которой я выбираю случайное число от 0 до 1, а также если оно меньше 0.

60
00:03:41,889 --> 00:03:48,960
95, запишу как положительный отзыв, в противном случае запишу как отрицательный отзыв.

61
00:03:48,960 --> 00:03:53,796
Теперь сделайте это 10 раз подряд, а затем сделайте еще 10, и

62
00:03:53,796 --> 00:03:59,256
еще 10, и еще 10, и так далее, чтобы понять, какая последовательность

63
00:03:59,256 --> 00:04:03,780
из 10 отзывов у продавца с таким показателем успешности 0.

64
00:04:03,780 --> 00:04:05,600
95 будет выглядеть так.

65
00:04:05,600 --> 00:04:09,920
Довольно многие из них, около 60%, дают 10 из 10.

66
00:04:09,920 --> 00:04:12,480
Таким образом, данные, которые мы видим, кажутся вполне

67
00:04:12,480 --> 00:04:15,680
правдоподобными, если истинный уровень успеха продавца составляет 95%.

68
00:04:15,680 --> 00:04:18,720
А может быть, это действительно 90% или 99%.

69
00:04:18,720 --> 00:04:21,440
Вся проблема в том, что мы просто не знаем.

70
00:04:21,440 --> 00:04:25,868
Что касается цели, скажем, вы просто хотите максимизировать вероятность получения

71
00:04:25,868 --> 00:04:30,080
положительного опыта, несмотря на то, что не уверены в этом показателе успеха.

72
00:04:30,080 --> 00:04:31,360
Так что подумайте вот об этом.

73
00:04:31,360 --> 00:04:36,081
У нас есть много различных возможных показателей успеха для каждого продавца,

74
00:04:36,081 --> 00:04:40,681
любое число от 0 до 1, и нам нужно что-то сказать о том, насколько вероятен

75
00:04:40,681 --> 00:04:45,040
каждый из этих показателей успеха, своего рода вероятность вероятностей.

76
00:04:45,040 --> 00:04:49,202
В отличие от более игровых примеров, таких как подбрасывание монеты и подбрасывание

77
00:04:49,202 --> 00:04:53,613
игральной кости, а также тех вещей, которые вы видите на вводном классе вероятности, где

78
00:04:53,613 --> 00:04:58,023
вы предполагаете долгосрочную частоту, например, 1 половину или 1 шестую, здесь мы имеем

79
00:04:58,023 --> 00:05:02,384
неуверенность в отношении сама долгосрочная частота, что является гораздо более сильным

80
00:05:02,384 --> 00:05:02,880
сомнением.

81
00:05:02,880 --> 00:05:06,098
Я также должен подчеркнуть, что такая установка актуальна для

82
00:05:06,098 --> 00:05:09,109
многих и многих ситуаций в реальном мире, когда вам нужно

83
00:05:09,109 --> 00:05:12,640
вынести суждение о случайном процессе на основе ограниченных данных.

84
00:05:12,640 --> 00:05:16,960
Например, предположим, что вы открываете завод по производству автомобилей, и при

85
00:05:16,960 --> 00:05:21,440
первоначальном тестировании 100 автомобилей у двух из них возникла какая-то проблема.

86
00:05:21,440 --> 00:05:25,970
Если вы планируете развернуть производство до миллиона автомобилей, что вы готовы с

87
00:05:25,970 --> 00:05:30,608
уверенностью сказать о том, сколько всего автомобилей будет иметь проблемы, требующие

88
00:05:30,608 --> 00:05:31,040
решения?

89
00:05:31,040 --> 00:05:34,726
Это не значит, что тест гарантирует, что истинная

90
00:05:34,726 --> 00:05:38,560
доля ошибок составляет 2%, но что именно он говорит?

91
00:05:38,560 --> 00:05:40,800
В качестве вашего первого задания позвольте мне спросить вас вот о чем.

92
00:05:40,800 --> 00:05:46,333
Если бы вы каким-то волшебным образом узнали истинный процент успеха данного

93
00:05:46,333 --> 00:05:51,722
продавца, скажем, 95%, как бы вы вычислили вероятность увидеть, скажем, 10

94
00:05:51,722 --> 00:05:57,040
положительных отзывов и 0 отрицательных отзывов, или 48 и 2, или 186 и 14?

95
00:05:57,040 --> 00:06:03,040
Другими словами, какова вероятность увидеть данные при предполагаемом показателе успеха?

96
00:06:03,040 --> 00:06:07,456
Минуту назад я показал вам что-то подобное с помощью моделирования,

97
00:06:07,456 --> 00:06:12,392
генерирующего 10 случайных обзоров, и с помощью небольшого программирования

98
00:06:12,392 --> 00:06:17,068
вы могли бы просто проделать это много раз, построив гистограмму, чтобы

99
00:06:17,068 --> 00:06:21,680
получить некоторое представление о том, как выглядит это распределение.

100
00:06:21,680 --> 00:06:25,650
Аналогичным образом вы можете смоделировать наборы из 50 отзывов и получить некоторое

101
00:06:25,650 --> 00:06:29,760
представление о том, насколько вероятно будет увидеть 48 положительных и 2 отрицательных.

102
00:06:29,760 --> 00:06:31,760
Видите ли, в вероятности есть хорошая особенность.

103
00:06:31,760 --> 00:06:34,561
Небольшое программирование почти всегда позволит вам

104
00:06:34,561 --> 00:06:37,680
немного схитрить и заранее увидеть ответ, смоделировав его.

105
00:06:37,680 --> 00:06:41,538
Например, после нескольких сотен тысяч образцов из 50 обзоров, если предположить,

106
00:06:41,538 --> 00:06:45,068
что вероятность успеха составляет 95%, это будет выглядеть примерно как 26.

107
00:06:45,068 --> 00:06:49,120
1% из них дали бы нам этот отзыв на 48 из 50.

108
00:06:49,120 --> 00:06:52,800
К счастью, в этом случае точная формула совсем не плоха.

109
00:06:52,800 --> 00:06:57,600
Вероятность увидеть ровно 48 из 50 выглядит так.

110
00:06:57,600 --> 00:07:03,440
Этот первый термин произносится как 50, выберите 48 и представляет собой общее

111
00:07:03,440 --> 00:07:09,280
количество способов, которыми вы можете занять 50 слотов и заполнить 48 из них.

112
00:07:09,280 --> 00:07:12,506
Например, возможно, вы начинаете с 48 хороших отзывов и заканчиваете

113
00:07:12,506 --> 00:07:15,639
двумя плохими отзывами, или, может быть, вы начинаете с 47 хороших

114
00:07:15,639 --> 00:07:18,960
отзывов, а затем они становятся плохими, хорошими, плохими и так далее.

115
00:07:18,960 --> 00:07:23,352
В принципе, если вам придется перечислить все возможные способы

116
00:07:23,352 --> 00:07:27,744
заполнения 48 из 50 слотов таким образом, общее количество этих

117
00:07:27,744 --> 00:07:32,480
шаблонов составит 50, выберите 48, что в данном случае составит 1225.

118
00:07:32,480 --> 00:07:34,160
Что мы умножим на это число?

119
00:07:34,160 --> 00:07:37,865
Что ж, это вероятность любого из этих шаблонов, то есть вероятность

120
00:07:37,865 --> 00:07:41,788
того, что один положительный отзыв будет увеличен в 48 раз по сравнению

121
00:07:41,788 --> 00:07:45,440
с вероятностью одного отрицательного отзыва, возведенной в квадрат.

122
00:07:45,440 --> 00:07:49,216
Крайне важно то, что мы предполагаем, что каждый обзор независим от

123
00:07:49,216 --> 00:07:53,104
предыдущего, поэтому мы можем перемножить все вероятности вместе, вот

124
00:07:53,104 --> 00:07:57,103
так, и с имеющимися у нас числами, когда вы их оцениваете, получается 0.

125
00:07:57,103 --> 00:08:02,000
261, что соответствует тому, что мы только что увидели эмпирически при моделировании.

126
00:08:02,000 --> 00:08:06,545
Вы также можете заменить это число 48 каким-либо другим значением

127
00:08:06,545 --> 00:08:10,402
и вычислить вероятность увидеть любое другое количество

128
00:08:10,402 --> 00:08:14,880
положительных отзывов, опять же принимая заданный уровень успеха.

129
00:08:14,880 --> 00:08:19,569
Между прочим, то, на что вы сейчас смотрите, известно в бизнесе как биномиальное

130
00:08:19,569 --> 00:08:23,680
распределение, одно из самых фундаментальных распределений вероятности.

131
00:08:23,680 --> 00:08:27,790
Он возникает всякий раз, когда у вас происходит что-то вроде подбрасывания

132
00:08:27,790 --> 00:08:31,791
монеты, случайное событие, которое может пойти одним из двух путей, и вы

133
00:08:31,791 --> 00:08:36,560
повторяете его несколько раз, и вам нужно знать вероятность получения различных итогов.

134
00:08:36,560 --> 00:08:40,105
Для наших целей эта формула дает нам вероятность увидеть данные с

135
00:08:40,105 --> 00:08:43,651
учетом предполагаемого уровня успеха, которую в конечном итоге мы

136
00:08:43,651 --> 00:08:46,983
хотим каким-то образом использовать для вынесения суждений об

137
00:08:46,983 --> 00:08:51,120
обратном, вероятности успеха с учетом фиксированных данных, которые мы видим.

138
00:08:51,120 --> 00:08:54,560
Они связаны, но определенно различны.

139
00:08:54,560 --> 00:08:59,343
Чтобы добиться большего в этом направлении, давайте поиграем со значением

140
00:08:59,343 --> 00:09:04,320
s и посмотрим, что произойдет, если мы изменим его на разные числа от 0 до 1.

141
00:09:04,320 --> 00:09:07,851
Биномиальное распределение, которое он производит, выглядит как эта

142
00:09:07,851 --> 00:09:11,280
куча, сосредоточенная вокруг того, что равно s, умноженному на 50.

143
00:09:11,280 --> 00:09:15,249
Ценность, которая нас волнует, вероятность увидеть 48

144
00:09:15,249 --> 00:09:19,440
отзывов из 50, представлена этой выделенной 48-й полосой.

145
00:09:19,440 --> 00:09:25,440
Итак, давайте нарисуем второй график внизу, показывающий, как это значение зависит от s.

146
00:09:25,440 --> 00:09:26,904
Когда s равно 0.

147
00:09:26,904 --> 00:09:30,640
96, это значение настолько велико, насколько оно когда-либо сможет достичь.

148
00:09:30,640 --> 00:09:35,771
И это должно иметь смысл, потому что, если вы посмотрите на этот обзор

149
00:09:35,771 --> 00:09:41,120
96%, наиболее вероятно, что истинный базовый уровень успеха составлял 96%.

150
00:09:41,120 --> 00:09:44,439
По мере увеличения s оно как бы сходит на нет, приближаясь к 0 по

151
00:09:44,439 --> 00:09:47,859
мере того, как s приближается к 1, поскольку у человека с идеальным

152
00:09:47,859 --> 00:09:51,280
показателем успеха никогда не будет этих двух отрицательных отзывов.

153
00:09:51,280 --> 00:09:56,800
Кроме того, при движении влево оно довольно быстро приближается к 0.

154
00:09:56,800 --> 00:09:59,590
К тому времени, как вы доберетесь до s, оно будет равно 0.

155
00:09:59,590 --> 00:10:06,160
8, случайно получить 48 отзывов из 50 — крайне редко, такое случается один раз на тысячу.

156
00:10:06,160 --> 00:10:10,223
Этот график внизу — отличное начало для получения более количественного

157
00:10:10,223 --> 00:10:14,400
описания, для которого значения s кажутся более или менее правдоподобными.

158
00:10:14,400 --> 00:10:19,253
Записанная в виде формулы, я хочу, чтобы вы запомнили, что кривая в зависимости

159
00:10:19,253 --> 00:10:23,924
от показателя успеха s выглядит как константа, умноженная на s на количество

160
00:10:23,924 --> 00:10:28,960
положительных отзывов, умноженная на 1 минус s на количество отрицательных отзывов.

161
00:10:28,960 --> 00:10:33,069
В принципе, если бы у нас было больше данных, например 480 положительных отзывов

162
00:10:33,069 --> 00:10:37,280
и 20 отрицательных отзывов, итоговый график все равно был бы сосредоточен вокруг 0.

163
00:10:37,280 --> 00:10:40,080
96, но он будет меньше и более сконцентрирован.

164
00:10:40,080 --> 00:10:43,089
Хорошим упражнением прямо сейчас было бы посмотреть,

165
00:10:43,089 --> 00:10:45,360
сможете ли вы объяснить, почему это так.

166
00:10:45,360 --> 00:10:50,000
Однако остается вопрос, что на самом деле делать с этими кривыми.

167
00:10:50,000 --> 00:10:53,360
Я имею в виду, что наша цель — вычислить вероятность того, что у

168
00:10:53,360 --> 00:10:56,720
вас будет хороший опыт работы с этим продавцом, и что вам делать?

169
00:10:56,720 --> 00:11:01,182
Наивно вы можете подумать, что вероятность равна 96%, поскольку именно здесь находится

170
00:11:01,182 --> 00:11:05,440
пик графика, что в некотором смысле является наиболее вероятным показателем успеха.

171
00:11:05,440 --> 00:11:08,400
Но подумайте о примере с 10 из 10 положительных результатов.

172
00:11:08,400 --> 00:11:14,880
В этом случае вся биномиальная формула упрощается до s в степени 10.

173
00:11:14,880 --> 00:11:17,810
Вероятность увидеть 10 хороших отзывов подряд — это

174
00:11:17,810 --> 00:11:21,360
вероятность увидеть, что один из них поднимется до 10-го места.

175
00:11:21,360 --> 00:11:27,120
Чем ближе истинный показатель успеха к 1, тем выше вероятность увидеть 10 из 10.

176
00:11:27,120 --> 00:11:32,320
Наш график внизу увеличивается только тогда, когда s приближается к 1.

177
00:11:32,320 --> 00:11:35,697
Но даже если s равно 1 — это значение, которое максимизирует эту

178
00:11:35,697 --> 00:11:39,438
вероятность, вы, конечно, не будете чувствовать себя комфортно, говоря,

179
00:11:39,438 --> 00:11:43,440
что лично у вас есть 100% вероятность хорошего опыта работы с этим продавцом.

180
00:11:43,440 --> 00:11:47,416
Может быть, вы думаете, что вместо этого нам следует поискать какой-то

181
00:11:47,416 --> 00:11:51,280
центр масс этого графа, и это будет абсолютно правильное направление.

182
00:11:51,280 --> 00:11:55,872
Однако сначала нам нужно объяснить, как взять это выражение для вероятности

183
00:11:55,872 --> 00:12:00,584
данных, которые мы видим, при значении s, и получить вероятность для значения

184
00:12:00,584 --> 00:12:05,600
s, чего мы на самом деле не знаем, учитывая данные, то, что мы действительно знаем.

185
00:12:05,600 --> 00:12:08,281
И это требует от нас поговорить о правиле Байеса,

186
00:12:08,281 --> 00:12:10,480
а также о функциях плотности вероятности.

187
00:12:10,480 --> 00:12:10,480
Для них увидимся во второй части.


1
00:00:00,000 --> 00:00:03,200
Вы покупаете товар в Интернете и видите трех разных продавцов.

2
00:00:03,200 --> 00:00:06,560
Все они предлагают один и тот же продукт, по сути, по одной и той же цене.

3
00:00:06,560 --> 00:00:11,040
Один из них имеет 100% положительный рейтинг, но имеет всего 10 отзывов.

4
00:00:11,040 --> 00:00:15,040
Другой имеет положительный рейтинг 96% и общее количество отзывов 50.

5
00:00:15,040 --> 00:00:19,440
И еще один имеет положительный рейтинг 93%, но общее количество отзывов составляет 200.

6
00:00:20,080 --> 00:00:21,200
У какого из них стоит покупать?

7
00:00:21,200 --> 00:00:31,120
Я думаю, что у всех нас есть инстинкт: чем больше данных

8
00:00:31,120 --> 00:00:33,520
мы видим, тем больше уверенности в том или ином рейтинге.

9
00:00:33,520 --> 00:00:36,160
Мы немного подозрительно относимся к 100%-ным оценкам, поскольку чаще всего

10
00:00:36,160 --> 00:00:39,360
они основаны на небольшом количестве обзоров, что делает более вероятным,

11
00:00:39,360 --> 00:00:43,840
что все могло пойти по-другому и получить более низкий рейтинг.

12
00:00:43,840 --> 00:00:46,240
Но как сделать эту интуицию количественной?

13
00:00:46,240 --> 00:00:50,240
Как рационально рассуждать о компромиссе между уверенностью, полученной за

14
00:00:50,240 --> 00:00:53,200
счет большего количества данных, и более низким абсолютным процентом?

15
00:00:54,320 --> 00:00:58,640
Этот конкретный пример представляет собой небольшую модификацию примера, который Джон Кук

16
00:00:58,640 --> 00:01:02,480
привел в своем превосходном посте в блоге «Байесовский обзор реселлеров Amazon».

17
00:01:02,480 --> 00:01:08,080
Для нас с вами это прекрасный повод углубиться в несколько основных тем теории вероятности и статистики.

18
00:01:08,080 --> 00:01:11,360
И чтобы действительно правильно осветить эти темы, требуется время.

19
00:01:11,360 --> 00:01:14,240
Итак, я собираюсь разбить это на три видеоролика,

20
00:01:14,240 --> 00:01:17,280
в первом из которых мы создадим модель ситуации

21
00:01:17,280 --> 00:01:20,160
и начнем с разговора о биномиальном распределении.

22
00:01:20,640 --> 00:01:23,600
Второй принесет идеи байесовского обновления и того,

23
00:01:23,600 --> 00:01:27,040
как работать с вероятностями над непрерывными значениями.

24
00:01:27,040 --> 00:01:30,720
А в-третьих, мы рассмотрим нечто, известное как бета-дистрибутив, и задействуем небольшой

25
00:01:30,720 --> 00:01:33,520
Python для анализа имеющихся у нас данных и придем к

26
00:01:33,520 --> 00:01:37,600
различным ответам в зависимости от того, что вы хотите оптимизировать.

27
00:01:39,680 --> 00:01:42,400
Теперь, чтобы бросить вам кость, прежде чем мы углубимся во всю математику, позвольте

28
00:01:42,400 --> 00:01:47,040
мне просто показать вам, каким окажется один из ответов, поскольку он восхитительно прост.

29
00:01:47,040 --> 00:01:50,800
Когда вы видите онлайн-рейтинг, что-то вроде этого 10

30
00:01:50,800 --> 00:01:53,440
из 10, вы делаете вид, что было

31
00:01:53,440 --> 00:01:55,840
еще два отзыва: один положительный, другой отрицательный.

32
00:01:55,840 --> 00:02:01,760
В данном случае это означает, что вы притворяетесь, что это 11 из 12, что даст 91. 7%.

33
00:02:01,760 --> 00:02:06,320
Это число показывает вероятность того, что у вас будет хороший опыт работы с этим продавцом.

34
00:02:08,080 --> 00:02:12,080
Итак, в случае с 50 отзывами, где у вас 48 положительных и

35
00:02:12,080 --> 00:02:16,160
2 отрицательных, вы притворяетесь, что на самом деле 49 положительных и

36
00:02:16,160 --> 00:02:19,440
3 отрицательных, что даст вам 49 из 52, или 94. 2%.

37
00:02:20,560 --> 00:02:23,920
Это ваша вероятность получить хороший опыт работы со вторым продавцом.

38
00:02:25,520 --> 00:02:29,040
Играя в ту же игру с нашим третьим продавцом, у которого

39
00:02:29,040 --> 00:02:33,440
было 200 отзывов, вы получаете 187 из 202, или 92. 6%.

40
00:02:34,960 --> 00:02:38,720
Таким образом, согласно этому правилу, лучше всего выбрать продавца номер 2.

41
00:02:39,520 --> 00:02:44,000
Это то, что известно как правило преемственности Лапласа, оно восходит к

42
00:02:44,000 --> 00:02:46,880
18 веку. Чтобы понять, какие предположения лежат в основе этого

43
00:02:46,880 --> 00:02:52,320
и как изменение этих предположений или вашей основной цели может

44
00:02:52,320 --> 00:02:54,400
изменить ваш выбор, нам действительно нужно пройти через вся математика.

45
00:02:54,400 --> 00:02:56,240
Итак, без дальнейших церемоний, давайте углубимся.

46
00:03:00,800 --> 00:03:03,920
Шаг 1. Как именно мы моделируем ситуацию

47
00:03:03,920 --> 00:03:06,160
и что именно вы хотите оптимизировать?

48
00:03:06,960 --> 00:03:10,640
Один из вариантов состоит в том, чтобы думать о каждом продавце как

49
00:03:10,640 --> 00:03:12,560
о производителе случайного опыта, который является либо положительным, либо отрицательным, и

50
00:03:12,560 --> 00:03:18,080
что у каждого продавца есть некоторая постоянная базовая вероятность дать хороший

51
00:03:18,080 --> 00:03:21,200
опыт, которую мы собираемся назвать показателем успеха, или S для короткий.

52
00:03:21,760 --> 00:03:23,920
Вся проблема в том, что мы не знаем С.

53
00:03:25,520 --> 00:03:28,640
Когда вы видите первый рейтинг 100 % при 10 отзывах,

54
00:03:28,640 --> 00:03:31,040
это не означает, что основной показатель успеха составляет 100 %.

55
00:03:31,840 --> 00:03:33,920
Вполне возможно, что это будет около 95%.

56
00:03:34,800 --> 00:03:37,520
И просто для иллюстрации позвольте мне запустить небольшую симуляцию, в которой

57
00:03:37,520 --> 00:03:40,400
я выбираю случайное число от 0 до 1, а также если

58
00:03:40,400 --> 00:03:44,480
оно меньше 0. 95, запишу как положительный отзыв,

59
00:03:44,480 --> 00:03:47,280
в противном случае запишу как отрицательный отзыв.

60
00:03:48,960 --> 00:03:50,640
Теперь сделайте это 10 раз подряд,

61
00:03:52,080 --> 00:03:53,280
а затем сделайте еще 10, и

62
00:03:54,240 --> 00:03:55,040
еще 10, и еще 10, и

63
00:03:56,240 --> 00:03:57,200
так далее, чтобы понять, какая

64
00:03:57,200 --> 00:03:57,920
последовательность из 10 отзывов у продавца

65
00:03:57,920 --> 00:04:03,920
с таким показателем успешности 0. 95

66
00:04:03,920 --> 00:04:04,880
будет выглядеть так.

67
00:04:05,600 --> 00:04:09,920
Довольно многие из них, около 60%, дают 10 из 10.

68
00:04:09,920 --> 00:04:14,640
Таким образом, данные, которые мы видим, кажутся вполне правдоподобными, если истинный уровень успеха продавца составляет 95%.

69
00:04:15,680 --> 00:04:18,160
А может быть, это действительно 90% или 99%.

70
00:04:18,720 --> 00:04:20,560
Вся проблема в том, что мы просто не знаем.

71
00:04:21,440 --> 00:04:26,720
Что касается цели, скажем, вы просто хотите максимизировать вероятность получения положительного

72
00:04:26,720 --> 00:04:28,880
опыта, несмотря на то, что не уверены в этом показателе успеха.

73
00:04:30,080 --> 00:04:31,360
Так что подумайте вот об этом.

74
00:04:31,360 --> 00:04:36,960
У нас есть много различных возможных показателей успеха для каждого продавца, любое

75
00:04:36,960 --> 00:04:41,200
число от 0 до 1, и нам нужно что-то сказать о том,

76
00:04:41,200 --> 00:04:43,920
насколько вероятен каждый из этих показателей успеха, своего рода вероятность вероятностей.

77
00:04:45,040 --> 00:04:48,480
В отличие от более игровых примеров, таких как подбрасывание монеты и

78
00:04:48,480 --> 00:04:51,120
подбрасывание игральной кости, а также тех вещей, которые вы видите

79
00:04:51,120 --> 00:04:55,840
на вводном классе вероятности, где вы предполагаете долгосрочную частоту, например,

80
00:04:55,840 --> 00:05:00,080
1 половину или 1 шестую, здесь мы имеем неуверенность в

81
00:05:00,080 --> 00:05:02,000
отношении сама долгосрочная частота, что является гораздо более сильным сомнением.

82
00:05:02,880 --> 00:05:08,160
Я также должен подчеркнуть, что такая установка актуальна для многих и многих ситуаций в

83
00:05:08,160 --> 00:05:11,680
реальном мире, когда вам нужно вынести суждение о случайном процессе на основе ограниченных данных.

84
00:05:12,640 --> 00:05:16,240
Например, предположим, что вы открываете завод по производству автомобилей, и при

85
00:05:16,240 --> 00:05:20,720
первоначальном тестировании 100 автомобилей у двух из них возникла какая-то проблема.

86
00:05:21,440 --> 00:05:24,960
Если вы планируете развернуть производство до миллиона автомобилей, что вы готовы с

87
00:05:24,960 --> 00:05:30,480
уверенностью сказать о том, сколько всего автомобилей будет иметь проблемы, требующие решения?

88
00:05:31,040 --> 00:05:34,160
Это не значит, что тест гарантирует, что истинная доля

89
00:05:34,960 --> 00:05:36,480
ошибок составляет 2%, но что именно он говорит?

90
00:05:38,560 --> 00:05:40,800
В качестве вашего первого задания позвольте мне спросить вас вот о чем.

91
00:05:40,800 --> 00:05:45,200
Если бы вы каким-то волшебным образом узнали истинный процент успеха данного продавца,

92
00:05:46,080 --> 00:05:49,680
скажем, 95%, как бы вы вычислили вероятность увидеть, скажем, 10 положительных отзывов

93
00:05:49,680 --> 00:05:56,160
и 0 отрицательных отзывов, или 48 и 2, или 186 и 14?

94
00:05:57,040 --> 00:06:02,000
Другими словами, какова вероятность увидеть данные при предполагаемом показателе успеха?

95
00:06:03,040 --> 00:06:08,240
Минуту назад я показал вам что-то подобное с помощью моделирования, генерирующего 10 случайных

96
00:06:08,240 --> 00:06:11,280
обзоров, и с помощью небольшого программирования вы могли бы просто проделать это много

97
00:06:11,280 --> 00:06:14,640
раз, построив гистограмму, чтобы получить некоторое представление о том, как выглядит это распределение.

98
00:06:21,680 --> 00:06:24,400
Аналогичным образом вы можете смоделировать наборы из 50 отзывов и получить некоторое

99
00:06:24,400 --> 00:06:29,120
представление о том, насколько вероятно будет увидеть 48 положительных и 2 отрицательных.

100
00:06:29,760 --> 00:06:31,760
Видите ли, в вероятности есть хорошая особенность.

101
00:06:31,760 --> 00:06:34,560
Небольшое программирование почти всегда позволит вам немного

102
00:06:34,560 --> 00:06:37,680
схитрить и заранее увидеть ответ, смоделировав его.

103
00:06:37,680 --> 00:06:41,200
Например, после нескольких сотен тысяч образцов из 50 обзоров, если

104
00:06:41,200 --> 00:06:42,880
предположить, что вероятность успеха составляет 95%, это будет выглядеть примерно

105
00:06:43,680 --> 00:06:48,160
как 26. 1% из них дали бы нам этот отзыв на 48 из 50.

106
00:06:49,120 --> 00:06:52,800
К счастью, в этом случае точная формула совсем не плоха.

107
00:06:52,800 --> 00:06:56,560
Вероятность увидеть ровно 48 из 50 выглядит так.

108
00:06:57,600 --> 00:07:00,960
Этот первый термин произносится как 50, выберите 48 и

109
00:07:00,960 --> 00:07:04,960
представляет собой общее количество способов, которыми вы можете

110
00:07:06,000 --> 00:07:07,600
занять 50 слотов и заполнить 48 из них.

111
00:07:09,280 --> 00:07:13,520
Например, возможно, вы начинаете с 48 хороших отзывов и заканчиваете двумя плохими отзывами, или, может быть,

112
00:07:13,520 --> 00:07:18,400
вы начинаете с 47 хороших отзывов, а затем они становятся плохими, хорошими, плохими и так далее.

113
00:07:18,960 --> 00:07:22,080
В принципе, если вам придется перечислить все возможные

114
00:07:22,080 --> 00:07:24,800
способы заполнения 48 из 50 слотов таким

115
00:07:24,800 --> 00:07:28,480
образом, общее количество этих шаблонов составит 50, выберите

116
00:07:28,480 --> 00:07:31,840
48, что в данном случае составит 1225.

117
00:07:32,480 --> 00:07:34,160
Что мы умножим на это число?

118
00:07:34,160 --> 00:07:37,120
Что ж, это вероятность любого из этих шаблонов, то есть вероятность

119
00:07:37,120 --> 00:07:41,440
того, что один положительный отзыв будет увеличен в 48 раз

120
00:07:41,440 --> 00:07:44,800
по сравнению с вероятностью одного отрицательного отзыва, возведенной в квадрат.

121
00:07:45,440 --> 00:07:49,120
Крайне важно то, что мы предполагаем, что каждый обзор независим от предыдущего,

122
00:07:49,120 --> 00:07:51,920
поэтому мы можем перемножить все вероятности вместе, вот так, и с

123
00:07:52,480 --> 00:07:57,360
имеющимися у нас числами, когда вы их оцениваете, получается 0. 261,

124
00:07:57,360 --> 00:08:00,160
что соответствует тому, что мы только что увидели эмпирически при моделировании.

125
00:08:02,000 --> 00:08:04,960
Вы также можете заменить это число 48 каким-либо другим

126
00:08:04,960 --> 00:08:08,640
значением и вычислить вероятность увидеть любое другое количество

127
00:08:09,200 --> 00:08:11,280
положительных отзывов, опять же принимая заданный уровень успеха.

128
00:08:14,880 --> 00:08:16,960
Между прочим, то, на что вы сейчас

129
00:08:16,960 --> 00:08:20,000
смотрите, известно в бизнесе как биномиальное распределение,

130
00:08:20,000 --> 00:08:23,680
одно из самых фундаментальных распределений вероятности.

131
00:08:23,680 --> 00:08:26,480
Он возникает всякий раз, когда у вас происходит что-то вроде подбрасывания монеты,

132
00:08:26,480 --> 00:08:31,040
случайное событие, которое может пойти одним из двух путей, и вы повторяете

133
00:08:31,040 --> 00:08:35,120
его несколько раз, и вам нужно знать вероятность получения различных итогов.

134
00:08:36,560 --> 00:08:41,120
Для наших целей эта формула дает нам вероятность увидеть данные

135
00:08:41,120 --> 00:08:43,360
с учетом предполагаемого уровня успеха, которую в конечном итоге

136
00:08:43,360 --> 00:08:47,360
мы хотим каким-то образом использовать для вынесения суждений об обратном,

137
00:08:47,360 --> 00:08:51,120
вероятности успеха с учетом фиксированных данных, которые мы видим.

138
00:08:51,120 --> 00:08:53,440
Они связаны, но определенно различны.

139
00:08:54,560 --> 00:08:57,920
Чтобы добиться большего в этом направлении, давайте поиграем со значением s и посмотрим,

140
00:08:57,920 --> 00:09:02,080
что произойдет, если мы изменим его на разные числа от 0 до 1.

141
00:09:04,320 --> 00:09:08,320
Биномиальное распределение, которое он производит, выглядит как эта куча,

142
00:09:08,320 --> 00:09:10,720
сосредоточенная вокруг того, что равно s, умноженному на 50.

143
00:09:11,280 --> 00:09:15,760
Ценность, которая нас волнует, вероятность увидеть 48 отзывов

144
00:09:15,760 --> 00:09:18,640
из 50, представлена этой выделенной 48-й полосой.

145
00:09:19,440 --> 00:09:24,480
Итак, давайте нарисуем второй график внизу, показывающий, как это значение зависит от s.

146
00:09:25,440 --> 00:09:30,640
Когда s равно 0. 96, это значение настолько велико, насколько оно когда-либо сможет достичь.

147
00:09:30,640 --> 00:09:34,640
И это должно иметь смысл, потому что, если вы посмотрите на этот

148
00:09:35,440 --> 00:09:39,280
обзор 96%, наиболее вероятно, что истинный базовый уровень успеха составлял 96%.

149
00:09:41,120 --> 00:09:46,480
По мере увеличения s оно как бы сходит на нет, приближаясь к 0 по мере того, как s

150
00:09:46,480 --> 00:09:50,400
приближается к 1, поскольку у человека с идеальным показателем успеха никогда не будет этих двух отрицательных отзывов.

151
00:09:51,280 --> 00:09:54,400
Кроме того, при движении влево оно довольно быстро приближается к 0.

152
00:09:56,800 --> 00:09:59,760
К тому времени, как вы доберетесь до s, оно будет равно 0. 8,

153
00:09:59,760 --> 00:10:03,280
случайно получить 48 отзывов из 50 — крайне

154
00:10:03,280 --> 00:10:05,040
редко, такое случается один раз на тысячу.

155
00:10:06,160 --> 00:10:10,320
Этот график внизу — отличное начало для получения более количественного

156
00:10:10,320 --> 00:10:13,360
описания, для которого значения s кажутся более или менее правдоподобными.

157
00:10:14,400 --> 00:10:19,280
Записанная в виде формулы, я хочу, чтобы вы запомнили, что кривая в

158
00:10:19,280 --> 00:10:24,960
зависимости от показателя успеха s выглядит как константа, умноженная на s на

159
00:10:24,960 --> 00:10:28,000
количество положительных отзывов, умноженная на 1 минус s на количество отрицательных отзывов.

160
00:10:28,960 --> 00:10:34,560
В принципе, если бы у нас было больше данных, например 480 положительных отзывов и

161
00:10:34,560 --> 00:10:37,440
20 отрицательных отзывов, итоговый график все равно был бы сосредоточен вокруг 0. 96,

162
00:10:37,440 --> 00:10:39,520
но он будет меньше и более сконцентрирован.

163
00:10:40,080 --> 00:10:44,160
Хорошим упражнением прямо сейчас было бы посмотреть, сможете ли вы объяснить, почему это так.

164
00:10:45,360 --> 00:10:49,440
Однако остается вопрос, что на самом деле делать с этими кривыми.

165
00:10:50,000 --> 00:10:54,880
Я имею в виду, что наша цель — вычислить вероятность того, что у

166
00:10:54,880 --> 00:10:55,600
вас будет хороший опыт работы с этим продавцом, и что вам делать?

167
00:10:56,720 --> 00:10:59,760
Наивно вы можете подумать, что вероятность равна 96%, поскольку именно здесь находится

168
00:11:00,400 --> 00:11:05,440
пик графика, что в некотором смысле является наиболее вероятным показателем успеха.

169
00:11:05,440 --> 00:11:08,400
Но подумайте о примере с 10 из 10 положительных результатов.

170
00:11:08,400 --> 00:11:13,200
В этом случае вся биномиальная формула упрощается до s в степени 10.

171
00:11:14,880 --> 00:11:17,840
Вероятность увидеть 10 хороших отзывов подряд — это вероятность

172
00:11:17,840 --> 00:11:20,640
увидеть, что один из них поднимется до 10-го места.

173
00:11:21,360 --> 00:11:26,560
Чем ближе истинный показатель успеха к 1, тем выше вероятность увидеть 10 из 10.

174
00:11:27,120 --> 00:11:30,880
Наш график внизу увеличивается только тогда, когда s приближается к 1.

175
00:11:32,320 --> 00:11:36,560
Но даже если s равно 1 — это значение, которое максимизирует эту

176
00:11:36,560 --> 00:11:40,240
вероятность, вы, конечно, не будете чувствовать себя комфортно, говоря, что лично

177
00:11:40,240 --> 00:11:42,480
у вас есть 100% вероятность хорошего опыта работы с этим продавцом.

178
00:11:43,440 --> 00:11:48,240
Может быть, вы думаете, что вместо этого нам следует поискать какой-то

179
00:11:48,240 --> 00:11:50,240
центр масс этого графа, и это будет абсолютно правильное направление.

180
00:11:51,280 --> 00:11:54,800
Однако сначала нам нужно объяснить, как взять это выражение для

181
00:11:54,800 --> 00:11:58,720
вероятности данных, которые мы видим, при значении s, и

182
00:11:58,720 --> 00:12:02,720
получить вероятность для значения s, чего мы на самом деле

183
00:12:02,720 --> 00:12:04,800
не знаем, учитывая данные, то, что мы действительно знаем.

184
00:12:05,600 --> 00:12:09,920
И это требует от нас поговорить о правиле Байеса, а также о функциях плотности вероятности.

185
00:12:10,480 --> 00:12:13,040
Для них увидимся во второй части.


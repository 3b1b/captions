1
00:00:00,000 --> 00:00:03,200
Вы покупаете товар в Интернете и видите трех разных продавцов.

2
00:00:03,200 --> 00:00:06,560
Все они предлагают один и тот же продукт, по сути, по одной и той же цене.

3
00:00:06,560 --> 00:00:11,040
Один из них имеет 100% положительный рейтинг, но имеет всего 10 отзывов.

4
00:00:11,040 --> 00:00:15,040
Другой имеет положительный рейтинг 96% и общее количество отзывов 50.

5
00:00:15,040 --> 00:00:20,080
И еще один имеет положительный рейтинг 93%, но общее количество отзывов составляет 200.

6
00:00:20,080 --> 00:00:21,200
У какого из них стоит покупать?

7
00:00:21,200 --> 00:00:28,440
Я думаю, что у всех нас есть инстинкт: чем больше данных мы видим,

8
00:00:28,440 --> 00:00:33,520
тем больше уверенности в том или ином рейтинге.

9
00:00:33,520 --> 00:00:36,184
Мы немного подозрительно относимся к 100%-ным оценкам,

10
00:00:36,184 --> 00:00:39,430
поскольку чаще всего они основаны на небольшом количестве обзоров,

11
00:00:39,430 --> 00:00:42,822
что делает более вероятным, что все могло пойти по-другому и получить

12
00:00:42,822 --> 00:00:43,840
более низкий рейтинг.

13
00:00:43,840 --> 00:00:46,240
Но как сделать эту интуицию количественной?

14
00:00:46,240 --> 00:00:49,662
Как рационально рассуждать о компромиссе между уверенностью,

15
00:00:49,662 --> 00:00:54,320
полученной за счет большего количества данных, и более низким абсолютным процентом?

16
00:00:54,320 --> 00:00:57,824
Этот конкретный пример представляет собой небольшую модификацию примера,

17
00:00:57,824 --> 00:01:02,096
который Джон Кук привел в своем превосходном посте в блоге «Байесовский обзор реселлеров

18
00:01:02,096 --> 00:01:02,480
Amazon».

19
00:01:02,480 --> 00:01:05,118
Для нас с вами это прекрасный повод углубиться в

20
00:01:05,118 --> 00:01:08,080
несколько основных тем теории вероятности и статистики.

21
00:01:08,080 --> 00:01:11,360
И чтобы действительно правильно осветить эти темы, требуется время.

22
00:01:11,360 --> 00:01:14,495
Итак, я собираюсь разбить это на три видеоролика,

23
00:01:14,495 --> 00:01:18,947
в первом из которых мы создадим модель ситуации и начнем с разговора о

24
00:01:18,947 --> 00:01:20,640
биномиальном распределении.

25
00:01:20,640 --> 00:01:23,723
Второй принесет идеи байесовского обновления и того,

26
00:01:23,723 --> 00:01:27,040
как работать с вероятностями над непрерывными значениями.

27
00:01:27,040 --> 00:01:30,956
А в-третьих, мы рассмотрим нечто, известное как бета-дистрибутив,

28
00:01:30,956 --> 00:01:34,991
и задействуем небольшой Python для анализа имеющихся у нас данных и

29
00:01:34,991 --> 00:01:39,680
придем к различным ответам в зависимости от того, что вы хотите оптимизировать.

30
00:01:39,680 --> 00:01:42,858
Теперь, чтобы бросить вам кость, прежде чем мы углубимся во всю математику,

31
00:01:42,858 --> 00:01:45,660
позвольте мне просто показать вам, каким окажется один из ответов,

32
00:01:45,660 --> 00:01:47,040
поскольку он восхитительно прост.

33
00:01:47,040 --> 00:01:51,778
Когда вы видите онлайн-рейтинг, что-то вроде этого 10 из 10, вы делаете вид,

34
00:01:51,778 --> 00:01:55,840
что было еще два отзыва: один положительный, другой отрицательный.

35
00:01:55,840 --> 00:02:01,760
В данном случае это означает, что вы притворяетесь, что это 11 из 12, что даст 91.7%.

36
00:02:01,760 --> 00:02:05,126
Это число показывает вероятность того, что у вас

37
00:02:05,126 --> 00:02:08,080
будет хороший опыт работы с этим продавцом.

38
00:02:08,080 --> 00:02:13,320
Итак, в случае с 50 отзывами, где у вас 48 положительных и 2 отрицательных,

39
00:02:13,320 --> 00:02:18,284
вы притворяетесь, что на самом деле 49 положительных и 3 отрицательных,

40
00:02:18,284 --> 00:02:20,560
что даст вам 49 из 52, или 94.2%.

41
00:02:20,560 --> 00:02:25,520
Это ваша вероятность получить хороший опыт работы со вторым продавцом.

42
00:02:25,520 --> 00:02:31,956
Играя в ту же игру с нашим третьим продавцом, у которого было 200 отзывов,

43
00:02:31,956 --> 00:02:34,960
вы получаете 187 из 202, или 92.6%.

44
00:02:34,960 --> 00:02:39,520
Таким образом, согласно этому правилу, лучше всего выбрать продавца номер 2.

45
00:02:39,520 --> 00:02:42,669
Это то, что известно как правило преемственности Лапласа,

46
00:02:42,669 --> 00:02:46,254
оно восходит к 18 веку. Чтобы понять, какие предположения лежат в

47
00:02:46,254 --> 00:02:49,892
основе этого и как изменение этих предположений или вашей основной

48
00:02:49,892 --> 00:02:54,400
цели может изменить ваш выбор, нам действительно нужно пройти через вся математика.

49
00:02:54,400 --> 00:03:00,800
Итак, без дальнейших церемоний, давайте углубимся.

50
00:03:00,800 --> 00:03:06,960
Шаг 1. Как именно мы моделируем ситуацию и что именно вы хотите оптимизировать?

51
00:03:06,960 --> 00:03:10,869
Один из вариантов состоит в том, чтобы думать о каждом продавце как о производителе

52
00:03:10,869 --> 00:03:14,360
случайного опыта, который является либо положительным, либо отрицательным,

53
00:03:14,360 --> 00:03:18,548
и что у каждого продавца есть некоторая постоянная базовая вероятность дать хороший опыт,

54
00:03:18,548 --> 00:03:21,760
которую мы собираемся назвать показателем успеха, или S для короткий.

55
00:03:21,760 --> 00:03:25,520
Вся проблема в том, что мы не знаем С.

56
00:03:25,520 --> 00:03:28,358
Когда вы видите первый рейтинг 100 % при 10 отзывах,

57
00:03:28,358 --> 00:03:31,840
это не означает, что основной показатель успеха составляет 100 %.

58
00:03:31,840 --> 00:03:34,800
Вполне возможно, что это будет около 95%.

59
00:03:34,800 --> 00:03:39,128
И просто для иллюстрации позвольте мне запустить небольшую симуляцию,

60
00:03:39,128 --> 00:03:43,889
в которой я выбираю случайное число от 0 до 1, а также если оно меньше 0.95,

61
00:03:43,889 --> 00:03:48,960
запишу как положительный отзыв, в противном случае запишу как отрицательный отзыв.

62
00:03:48,960 --> 00:03:54,428
Теперь сделайте это 10 раз подряд, а затем сделайте еще 10, и еще 10,

63
00:03:54,428 --> 00:03:59,740
и еще 10, и так далее, чтобы понять, какая последовательность из 10

64
00:03:59,740 --> 00:04:05,600
отзывов у продавца с таким показателем успешности 0.95 будет выглядеть так.

65
00:04:05,600 --> 00:04:09,920
Довольно многие из них, около 60%, дают 10 из 10.

66
00:04:09,920 --> 00:04:13,257
Таким образом, данные, которые мы видим, кажутся вполне правдоподобными,

67
00:04:13,257 --> 00:04:15,680
если истинный уровень успеха продавца составляет 95%.

68
00:04:15,680 --> 00:04:18,720
А может быть, это действительно 90% или 99%.

69
00:04:18,720 --> 00:04:21,440
Вся проблема в том, что мы просто не знаем.

70
00:04:21,440 --> 00:04:25,868
Что касается цели, скажем, вы просто хотите максимизировать вероятность получения

71
00:04:25,868 --> 00:04:30,080
положительного опыта, несмотря на то, что не уверены в этом показателе успеха.

72
00:04:30,080 --> 00:04:31,360
Так что подумайте вот об этом.

73
00:04:31,360 --> 00:04:36,081
У нас есть много различных возможных показателей успеха для каждого продавца,

74
00:04:36,081 --> 00:04:39,531
любое число от 0 до 1, и нам нужно что-то сказать о том,

75
00:04:39,531 --> 00:04:42,800
насколько вероятен каждый из этих показателей успеха,

76
00:04:42,800 --> 00:04:45,040
своего рода вероятность вероятностей.

77
00:04:45,040 --> 00:04:49,202
В отличие от более игровых примеров, таких как подбрасывание монеты и подбрасывание

78
00:04:49,202 --> 00:04:53,414
игральной кости, а также тех вещей, которые вы видите на вводном классе вероятности,

79
00:04:53,414 --> 00:04:57,280
где вы предполагаете долгосрочную частоту, например, 1 половину или 1 шестую,

80
00:04:57,280 --> 00:05:00,650
здесь мы имеем неуверенность в отношении сама долгосрочная частота,

81
00:05:00,650 --> 00:05:02,880
что является гораздо более сильным сомнением.

82
00:05:02,880 --> 00:05:06,098
Я также должен подчеркнуть, что такая установка актуальна для

83
00:05:06,098 --> 00:05:09,109
многих и многих ситуаций в реальном мире, когда вам нужно

84
00:05:09,109 --> 00:05:12,640
вынести суждение о случайном процессе на основе ограниченных данных.

85
00:05:12,640 --> 00:05:16,644
Например, предположим, что вы открываете завод по производству автомобилей,

86
00:05:16,644 --> 00:05:20,965
и при первоначальном тестировании 100 автомобилей у двух из них возникла какая-то

87
00:05:20,965 --> 00:05:21,440
проблема.

88
00:05:21,440 --> 00:05:25,107
Если вы планируете развернуть производство до миллиона автомобилей,

89
00:05:25,107 --> 00:05:29,529
что вы готовы с уверенностью сказать о том, сколько всего автомобилей будет иметь

90
00:05:29,529 --> 00:05:31,040
проблемы, требующие решения?

91
00:05:31,040 --> 00:05:36,716
Это не значит, что тест гарантирует, что истинная доля ошибок составляет 2%,

92
00:05:36,716 --> 00:05:38,560
но что именно он говорит?

93
00:05:38,560 --> 00:05:40,800
В качестве вашего первого задания позвольте мне спросить вас вот о чем.

94
00:05:40,800 --> 00:05:47,051
Если бы вы каким-то волшебным образом узнали истинный процент успеха данного продавца,

95
00:05:47,051 --> 00:05:51,506
скажем, 95%, как бы вы вычислили вероятность увидеть, скажем,

96
00:05:51,506 --> 00:05:57,040
10 положительных отзывов и 0 отрицательных отзывов, или 48 и 2, или 186 и 14?

97
00:05:57,040 --> 00:06:03,040
Другими словами, какова вероятность увидеть данные при предполагаемом показателе успеха?

98
00:06:03,040 --> 00:06:07,456
Минуту назад я показал вам что-то подобное с помощью моделирования,

99
00:06:07,456 --> 00:06:12,392
генерирующего 10 случайных обзоров, и с помощью небольшого программирования

100
00:06:12,392 --> 00:06:16,679
вы могли бы просто проделать это много раз, построив гистограмму,

101
00:06:16,679 --> 00:06:21,680
чтобы получить некоторое представление о том, как выглядит это распределение.

102
00:06:21,680 --> 00:06:25,650
Аналогичным образом вы можете смоделировать наборы из 50 отзывов и получить некоторое

103
00:06:25,650 --> 00:06:29,760
представление о том, насколько вероятно будет увидеть 48 положительных и 2 отрицательных.

104
00:06:29,760 --> 00:06:31,760
Видите ли, в вероятности есть хорошая особенность.

105
00:06:31,760 --> 00:06:34,561
Небольшое программирование почти всегда позволит вам

106
00:06:34,561 --> 00:06:37,680
немного схитрить и заранее увидеть ответ, смоделировав его.

107
00:06:37,680 --> 00:06:41,247
Например, после нескольких сотен тысяч образцов из 50 обзоров,

108
00:06:41,247 --> 00:06:44,532
если предположить, что вероятность успеха составляет 95%,

109
00:06:44,532 --> 00:06:49,120
это будет выглядеть примерно как 26.1% из них дали бы нам этот отзыв на 48 из 50.

110
00:06:49,120 --> 00:06:52,800
К счастью, в этом случае точная формула совсем не плоха.

111
00:06:52,800 --> 00:06:57,600
Вероятность увидеть ровно 48 из 50 выглядит так.

112
00:06:57,600 --> 00:07:03,440
Этот первый термин произносится как 50, выберите 48 и представляет собой общее

113
00:07:03,440 --> 00:07:09,280
количество способов, которыми вы можете занять 50 слотов и заполнить 48 из них.

114
00:07:09,280 --> 00:07:12,506
Например, возможно, вы начинаете с 48 хороших отзывов и заканчиваете

115
00:07:12,506 --> 00:07:16,060
двумя плохими отзывами, или, может быть, вы начинаете с 47 хороших отзывов,

116
00:07:16,060 --> 00:07:18,960
а затем они становятся плохими, хорошими, плохими и так далее.

117
00:07:18,960 --> 00:07:23,352
В принципе, если вам придется перечислить все возможные способы

118
00:07:23,352 --> 00:07:29,254
заполнения 48 из 50 слотов таким образом, общее количество этих шаблонов составит 50,

119
00:07:29,254 --> 00:07:32,480
выберите 48, что в данном случае составит 1225.

120
00:07:32,480 --> 00:07:34,160
Что мы умножим на это число?

121
00:07:34,160 --> 00:07:38,192
Что ж, это вероятность любого из этих шаблонов, то есть вероятность того,

122
00:07:38,192 --> 00:07:41,897
что один положительный отзыв будет увеличен в 48 раз по сравнению с

123
00:07:41,897 --> 00:07:45,440
вероятностью одного отрицательного отзыва, возведенной в квадрат.

124
00:07:45,440 --> 00:07:49,986
Крайне важно то, что мы предполагаем, что каждый обзор независим от предыдущего,

125
00:07:49,986 --> 00:07:53,467
поэтому мы можем перемножить все вероятности вместе, вот так,

126
00:07:53,467 --> 00:07:57,509
и с имеющимися у нас числами, когда вы их оцениваете, получается 0.261,

127
00:07:57,509 --> 00:08:02,000
что соответствует тому, что мы только что увидели эмпирически при моделировании.

128
00:08:02,000 --> 00:08:06,545
Вы также можете заменить это число 48 каким-либо другим значением

129
00:08:06,545 --> 00:08:11,987
и вычислить вероятность увидеть любое другое количество положительных отзывов,

130
00:08:11,987 --> 00:08:14,880
опять же принимая заданный уровень успеха.

131
00:08:14,880 --> 00:08:19,569
Между прочим, то, на что вы сейчас смотрите, известно в бизнесе как биномиальное

132
00:08:19,569 --> 00:08:23,680
распределение, одно из самых фундаментальных распределений вероятности.

133
00:08:23,680 --> 00:08:28,229
Он возникает всякий раз, когда у вас происходит что-то вроде подбрасывания монеты,

134
00:08:28,229 --> 00:08:31,517
случайное событие, которое может пойти одним из двух путей,

135
00:08:31,517 --> 00:08:35,628
и вы повторяете его несколько раз, и вам нужно знать вероятность получения

136
00:08:35,628 --> 00:08:36,560
различных итогов.

137
00:08:36,560 --> 00:08:40,105
Для наших целей эта формула дает нам вероятность увидеть данные с

138
00:08:40,105 --> 00:08:43,651
учетом предполагаемого уровня успеха, которую в конечном итоге мы

139
00:08:43,651 --> 00:08:47,520
хотим каким-то образом использовать для вынесения суждений об обратном,

140
00:08:47,520 --> 00:08:51,120
вероятности успеха с учетом фиксированных данных, которые мы видим.

141
00:08:51,120 --> 00:08:54,560
Они связаны, но определенно различны.

142
00:08:54,560 --> 00:09:00,312
Чтобы добиться большего в этом направлении, давайте поиграем со значением s и посмотрим,

143
00:09:00,312 --> 00:09:04,320
что произойдет, если мы изменим его на разные числа от 0 до 1.

144
00:09:04,320 --> 00:09:08,163
Биномиальное распределение, которое он производит, выглядит как эта куча,

145
00:09:08,163 --> 00:09:11,280
сосредоточенная вокруг того, что равно s, умноженному на 50.

146
00:09:11,280 --> 00:09:16,352
Ценность, которая нас волнует, вероятность увидеть 48 отзывов из 50,

147
00:09:16,352 --> 00:09:19,440
представлена этой выделенной 48-й полосой.

148
00:09:19,440 --> 00:09:25,440
Итак, давайте нарисуем второй график внизу, показывающий, как это значение зависит от s.

149
00:09:25,440 --> 00:09:28,354
Когда s равно 0.96, это значение настолько велико,

150
00:09:28,354 --> 00:09:30,640
насколько оно когда-либо сможет достичь.

151
00:09:30,640 --> 00:09:36,132
И это должно иметь смысл, потому что, если вы посмотрите на этот обзор 96%,

152
00:09:36,132 --> 00:09:41,120
наиболее вероятно, что истинный базовый уровень успеха составлял 96%.

153
00:09:41,120 --> 00:09:44,992
По мере увеличения s оно как бы сходит на нет, приближаясь к 0 по мере того,

154
00:09:44,992 --> 00:09:48,463
как s приближается к 1, поскольку у человека с идеальным показателем

155
00:09:48,463 --> 00:09:51,280
успеха никогда не будет этих двух отрицательных отзывов.

156
00:09:51,280 --> 00:09:56,800
Кроме того, при движении влево оно довольно быстро приближается к 0.

157
00:09:56,800 --> 00:10:00,684
К тому времени, как вы доберетесь до s, оно будет равно 0.8,

158
00:10:00,684 --> 00:10:06,160
случайно получить 48 отзывов из 50 — крайне редко, такое случается один раз на тысячу.

159
00:10:06,160 --> 00:10:10,787
Этот график внизу — отличное начало для получения более количественного описания,

160
00:10:10,787 --> 00:10:14,400
для которого значения s кажутся более или менее правдоподобными.

161
00:10:14,400 --> 00:10:17,736
Записанная в виде формулы, я хочу, чтобы вы запомнили,

162
00:10:17,736 --> 00:10:22,104
что кривая в зависимости от показателя успеха s выглядит как константа,

163
00:10:22,104 --> 00:10:25,320
умноженная на s на количество положительных отзывов,

164
00:10:25,320 --> 00:10:28,960
умноженная на 1 минус s на количество отрицательных отзывов.

165
00:10:28,960 --> 00:10:32,807
В принципе, если бы у нас было больше данных, например 480 положительных

166
00:10:32,807 --> 00:10:36,443
отзывов и 20 отрицательных отзывов, итоговый график все равно был бы

167
00:10:36,443 --> 00:10:40,080
сосредоточен вокруг 0.96, но он будет меньше и более сконцентрирован.

168
00:10:40,080 --> 00:10:43,089
Хорошим упражнением прямо сейчас было бы посмотреть,

169
00:10:43,089 --> 00:10:45,360
сможете ли вы объяснить, почему это так.

170
00:10:45,360 --> 00:10:50,000
Однако остается вопрос, что на самом деле делать с этими кривыми.

171
00:10:50,000 --> 00:10:53,049
Я имею в виду, что наша цель — вычислить вероятность того,

172
00:10:53,049 --> 00:10:56,720
что у вас будет хороший опыт работы с этим продавцом, и что вам делать?

173
00:10:56,720 --> 00:10:59,489
Наивно вы можете подумать, что вероятность равна 96%,

174
00:10:59,489 --> 00:11:03,952
поскольку именно здесь находится пик графика, что в некотором смысле является наиболее

175
00:11:03,952 --> 00:11:05,440
вероятным показателем успеха.

176
00:11:05,440 --> 00:11:08,400
Но подумайте о примере с 10 из 10 положительных результатов.

177
00:11:08,400 --> 00:11:14,880
В этом случае вся биномиальная формула упрощается до s в степени 10.

178
00:11:14,880 --> 00:11:18,993
Вероятность увидеть 10 хороших отзывов подряд — это вероятность увидеть,

179
00:11:18,993 --> 00:11:21,360
что один из них поднимется до 10-го места.

180
00:11:21,360 --> 00:11:27,120
Чем ближе истинный показатель успеха к 1, тем выше вероятность увидеть 10 из 10.

181
00:11:27,120 --> 00:11:32,320
Наш график внизу увеличивается только тогда, когда s приближается к 1.

182
00:11:32,320 --> 00:11:36,373
Но даже если s равно 1 — это значение, которое максимизирует эту вероятность,

183
00:11:36,373 --> 00:11:39,438
вы, конечно, не будете чувствовать себя комфортно, говоря,

184
00:11:39,438 --> 00:11:43,440
что лично у вас есть 100% вероятность хорошего опыта работы с этим продавцом.

185
00:11:43,440 --> 00:11:47,416
Может быть, вы думаете, что вместо этого нам следует поискать какой-то

186
00:11:47,416 --> 00:11:51,280
центр масс этого графа, и это будет абсолютно правильное направление.

187
00:11:51,280 --> 00:11:56,355
Однако сначала нам нужно объяснить, как взять это выражение для вероятности данных,

188
00:11:56,355 --> 00:12:00,766
которые мы видим, при значении s, и получить вероятность для значения s,

189
00:12:00,766 --> 00:12:05,600
чего мы на самом деле не знаем, учитывая данные, то, что мы действительно знаем.

190
00:12:05,600 --> 00:12:08,281
И это требует от нас поговорить о правиле Байеса,

191
00:12:08,281 --> 00:12:10,480
а также о функциях плотности вероятности.

192
00:12:10,480 --> 00:12:10,480
Для них увидимся во второй части.


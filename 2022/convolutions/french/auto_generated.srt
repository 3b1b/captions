1
00:00:00,000 --> 00:00:02,869
Supposons que je vous donne deux listes de nombres différentes, ou peut-être

2
00:00:02,869 --> 00:00:05,738
deux fonctions différentes, et que je vous demande de réfléchir à toutes les

3
00:00:05,738 --> 00:00:08,607
façons dont vous pourriez combiner ces deux listes pour obtenir une nouvelle

4
00:00:08,607 --> 00:00:11,737
liste de nombres, ou combiner les deux fonctions pour obtenir une nouvelle fonction.

5
00:00:11,737 --> 00:00:14,089
Peut-être qu’une façon simple qui me vient à l’esprit

6
00:00:14,089 --> 00:00:16,267
est de simplement les additionner terme par terme.

7
00:00:16,267 --> 00:00:20,050
De même avec les fonctions, vous pouvez ajouter toutes les sorties correspondantes.

8
00:00:20,050 --> 00:00:23,050
Dans le même esprit, vous pouvez également multiplier les deux

9
00:00:23,050 --> 00:00:26,145
listes terme par terme et faire la même chose avec les fonctions.

10
00:00:26,145 --> 00:00:29,967
Mais il existe un autre type de combinaison tout aussi fondamentale que les

11
00:00:29,967 --> 00:00:33,840
deux, mais beaucoup moins souvent évoquée, connue sous le nom de convolution.

12
00:00:33,840 --> 00:00:36,996
Mais contrairement aux deux cas précédents, il ne s’agit pas d’un simple

13
00:00:36,996 --> 00:00:39,893
héritage d’une opération que vous pouvez effectuer sur des nombres.

14
00:00:39,893 --> 00:00:42,116
C'est quelque chose de véritablement nouveau dans le

15
00:00:42,116 --> 00:00:44,716
contexte de listes de nombres ou de combinaisons de fonctions.

16
00:00:44,716 --> 00:00:48,601
Ils apparaissent partout, ils sont omniprésents dans le traitement d'images, c'est

17
00:00:48,601 --> 00:00:52,252
une construction centrale dans la théorie des probabilités, ils sont beaucoup

18
00:00:52,252 --> 00:00:56,044
utilisés dans la résolution d'équations différentielles, et c'est un contexte où

19
00:00:56,044 --> 00:01:00,210
vous l'avez presque certainement vu, sinon par ce nom, multiplie deux polynômes ensemble.

20
00:01:00,210 --> 00:01:03,982
En tant que personne travaillant dans le domaine des explications visuelles, c'est

21
00:01:03,982 --> 00:01:07,709
un sujet particulièrement intéressant, car la définition formelle prise isolément

22
00:01:07,709 --> 00:01:11,346
et sans contexte peut sembler plutôt intimidante, mais si nous prenons le temps

23
00:01:11,346 --> 00:01:15,209
de vraiment comprendre ce qu'elle dit, et avant cela, de réellement motiver pourquoi

24
00:01:15,209 --> 00:01:18,800
vous voudriez quelque chose comme ça, c'est une opération incroyablement belle.

25
00:01:18,800 --> 00:01:21,307
Et je dois admettre que j’ai appris un petit quelque

26
00:01:21,307 --> 00:01:23,436
chose en assemblant les visuels de ce projet.

27
00:01:23,436 --> 00:01:26,454
Dans le cas de la convolution de deux fonctions différentes, j'essayais de

28
00:01:26,454 --> 00:01:29,512
réfléchir à différentes manières d'imaginer ce que cela pourrait signifier,

29
00:01:29,512 --> 00:01:32,369
et avec l'une d'elles, j'ai eu un petit moment de compréhension sur la

30
00:01:32,369 --> 00:01:35,347
raison pour laquelle les distributions normales jouent le rôle qui ils le

31
00:01:35,347 --> 00:01:38,445
font en probabilité, pourquoi c'est une forme si naturelle pour une fonction.

32
00:01:38,445 --> 00:01:41,580
Mais je prends de l'avance, il y a beaucoup de configuration pour celui-là.

33
00:01:41,580 --> 00:01:44,405
Dans cette vidéo, nous allons nous concentrer principalement

34
00:01:44,405 --> 00:01:47,139
sur le cas discret, et en particulier sur la création d'un

35
00:01:47,139 --> 00:01:50,196
algorithme très inattendu mais très intelligent pour les calculer.

36
00:01:50,196 --> 00:01:57,840
Et je vais retirer la discussion du cas continu dans une deuxième partie.

37
00:01:57,840 --> 00:02:01,750
Il est très tentant de s'ouvrir avec les exemples de traitement d'image, car ils sont

38
00:02:01,750 --> 00:02:05,615
visuellement les plus intrigants, mais il y a quelques subtilités qui rendent le cas

39
00:02:05,615 --> 00:02:09,480
de traitement d'image moins représentatif des convolutions dans leur ensemble, alors

40
00:02:09,480 --> 00:02:13,254
commençons plutôt par la probabilité, et en particulier l'un des exemples les plus

41
00:02:13,254 --> 00:02:17,164
simples auxquels, je suis sûr, tout le monde ici a pensé à un moment donné de sa vie,

42
00:02:17,164 --> 00:02:21,211
qui consiste à lancer une paire de dés et à déterminer les chances d'obtenir différentes

43
00:02:21,211 --> 00:02:21,530
sommes.

44
00:02:21,530 --> 00:02:24,170
Et on pourrait dire, pas un problème, pas un problème.

45
00:02:24,170 --> 00:02:28,017
Chacun de vos deux dés a six résultats possibles différents, ce qui nous

46
00:02:28,017 --> 00:02:31,917
donne un total de 36 paires de résultats possibles distinctes, et si nous

47
00:02:31,917 --> 00:02:36,240
les examinons toutes, nous pouvons compter combien de paires ont une somme donnée.

48
00:02:36,240 --> 00:02:39,407
Et en disposant toutes les paires dans une grille comme celle-ci, ce

49
00:02:39,407 --> 00:02:42,529
qui est plutôt sympa, c'est que toutes les paires qui ont une somme

50
00:02:42,529 --> 00:02:45,650
constante sont visibles le long d'une de ces différentes diagonales.

51
00:02:45,650 --> 00:02:49,287
Ainsi, le simple fait de compter combien il y en a sur chacune de ces diagonales

52
00:02:49,287 --> 00:02:52,880
vous indiquera quelle est la probabilité que vous voyiez une somme particulière.

53
00:02:52,880 --> 00:02:55,709
Et je dirais, très bien, très bien, mais pouvez-vous

54
00:02:55,709 --> 00:02:58,699
penser à d’autres façons de visualiser la même question?

55
00:02:58,699 --> 00:03:01,244
D'autres images qui peuvent venir à l'esprit pour penser

56
00:03:01,244 --> 00:03:03,744
à toutes les paires distinctes qui ont une somme donnée?

57
00:03:03,744 --> 00:03:07,550
Et peut-être que l'un de vous lève la main et dit : oui, j'en ai un.

58
00:03:07,550 --> 00:03:10,844
Disons que vous imaginez ces deux ensembles différents de possibilités

59
00:03:10,844 --> 00:03:14,046
chacun dans une rangée, mais que vous inversez cette deuxième rangée.

60
00:03:14,046 --> 00:03:16,455
De cette façon, toutes les différentes paires qui

61
00:03:16,455 --> 00:03:18,960
totalisent sept s'alignent verticalement comme ceci.

62
00:03:18,960 --> 00:03:22,657
Et si nous faisons glisser cette rangée du bas complètement vers la droite, alors

63
00:03:22,657 --> 00:03:26,309
la paire unique qui totalise deux, les yeux du serpent, est la seule à s'aligner.

64
00:03:26,309 --> 00:03:29,598
Et si je place cela sur une unité vers la droite, les paires qui

65
00:03:29,598 --> 00:03:32,886
s'alignent sont les deux paires différentes qui totalisent trois.

66
00:03:32,886 --> 00:03:35,756
Et en général, différentes valeurs de décalage de ce tableau

67
00:03:35,756 --> 00:03:38,814
inférieur, dont je me souviens que j'ai dû d'abord le retourner,

68
00:03:38,814 --> 00:03:41,778
révèlent toutes les paires distinctes qui ont une somme donnée.

69
00:03:41,778 --> 00:03:45,672
En ce qui concerne les questions de probabilité, cela n’est toujours

70
00:03:45,672 --> 00:03:49,283
pas particulièrement intéressant, car tout ce que nous faisons,

71
00:03:49,283 --> 00:03:53,120
c’est compter le nombre de résultats dans chacune de ces catégories.

72
00:03:53,120 --> 00:03:55,317
Mais cela suppose implicitement qu’il y a une

73
00:03:55,317 --> 00:03:57,850
chance égale pour chacun de ces visages d’apparaître.

74
00:03:57,850 --> 00:04:01,897
Mais et si je vous disais que j'ai un jeu de dés spécial qui n'est pas uniforme?

75
00:04:01,897 --> 00:04:05,751
Peut-être que le dé bleu a son propre ensemble de nombres décrivant les probabilités

76
00:04:05,751 --> 00:04:09,740
pour chaque face à venir, et que le dé rouge a son propre ensemble de nombres distincts.

77
00:04:09,740 --> 00:04:12,803
Dans ce cas, si vous vouliez déterminer, par exemple, la

78
00:04:12,803 --> 00:04:16,188
probabilité de voir un deux, vous multiplieriez la probabilité

79
00:04:16,188 --> 00:04:19,895
que le dé bleu soit un par la probabilité que le dé rouge soit un un.

80
00:04:19,895 --> 00:04:23,186
Et pour avoir des chances d'obtenir un trois, vous regardez les deux paires

81
00:04:23,186 --> 00:04:26,562
distinctes lorsque cela est possible, et encore une fois, vous multipliez les

82
00:04:26,562 --> 00:04:29,983
probabilités correspondantes, puis vous additionnez ces deux produits ensemble.

83
00:04:29,983 --> 00:04:33,295
De même, les chances de voir un quatre impliquent de multiplier trois

84
00:04:33,295 --> 00:04:36,748
paires de possibilités différentes et de les additionner toutes ensemble.

85
00:04:36,748 --> 00:04:39,892
Et dans l'esprit de la mise en place de certaines formules, nommons

86
00:04:39,892 --> 00:04:42,805
ces probabilités supérieures a1, a2, a3, et ainsi de suite, et

87
00:04:42,805 --> 00:04:45,903
nommons les probabilités inférieures b1, b2, b3, et ainsi de suite.

88
00:04:45,903 --> 00:04:49,699
Et en général, ce processus, où nous prenons deux tableaux différents de

89
00:04:49,699 --> 00:04:53,547
nombres, retournons le second, puis les alignons à différentes valeurs de

90
00:04:53,547 --> 00:04:57,447
décalage, prenons un tas de produits par paires et les additionnons, c'est

91
00:04:57,447 --> 00:05:01,139
l'un des façons fondamentales de réfléchir à ce qu’est une convolution.

92
00:05:01,139 --> 00:05:05,864
Donc, pour l'exprimer un peu plus précisément, grâce à ce processus, nous avons

93
00:05:05,864 --> 00:05:11,002
simplement généré des probabilités de voir deux, trois, quatre, ainsi de suite jusqu'à

94
00:05:11,002 --> 00:05:16,258
12, et nous les avons obtenues en mélangeant une liste de valeurs, a et une autre. liste

95
00:05:16,258 --> 00:05:17,084
de valeurs, b.

96
00:05:17,084 --> 00:05:20,597
Dans le jargon, nous dirions que la convolution de ces deux séquences

97
00:05:20,597 --> 00:05:23,758
nous donne cette nouvelle séquence, la nouvelle séquence de 11

98
00:05:23,758 --> 00:05:27,120
valeurs, dont chacune ressemble à une somme de produits par paires.

99
00:05:27,120 --> 00:05:30,417
Si vous préférez, une autre façon de penser à la même opération

100
00:05:30,417 --> 00:05:33,765
est de créer d’abord un tableau de tous les produits par paires,

101
00:05:33,765 --> 00:05:36,702
puis de les additionner le long de toutes ces diagonales.

102
00:05:36,702 --> 00:05:39,564
Encore une fois, c'est une façon de mélanger ces deux séquences

103
00:05:39,564 --> 00:05:42,247
de nombres pour obtenir une nouvelle séquence de 11 nombres.

104
00:05:42,247 --> 00:05:44,491
C'est le même fonctionnement que celui pensé pour

105
00:05:44,491 --> 00:05:46,960
les fenêtres coulissantes, juste une autre perspective.

106
00:05:46,960 --> 00:05:50,314
En y mettant une petite note, voici comment vous pourriez le voir écrit.

107
00:05:50,314 --> 00:05:55,014
La convolution de a et b, notée par ce petit astérisque, est une nouvelle liste, et le

108
00:05:55,014 --> 00:05:59,876
nième élément de cette liste ressemble à une somme, et cette somme s'étend sur toutes les

109
00:05:59,876 --> 00:06:04,738
différentes paires d'indices, i et j, de sorte que la somme de ces indices sont égaux à n.

110
00:06:04,738 --> 00:06:10,471
C'est un peu long, mais par exemple, si n était 6, les paires que nous examinons sont 1

111
00:06:10,471 --> 00:06:16,269
et 5, 2 et 4, 3 et 3, 4 et 2, 5 et 1, toutes les différentes paires qui s'additionnent à

112
00:06:16,269 --> 00:06:16,400
6.

113
00:06:16,400 --> 00:06:18,419
Mais honnêtement, quelle que soit la manière dont vous

114
00:06:18,419 --> 00:06:20,475
l’écrivez, la notation est secondaire en importance par

115
00:06:20,475 --> 00:06:23,082
rapport au visuel que vous pourriez avoir en tête pendant le processus.

116
00:06:23,082 --> 00:06:27,163
Ici, il serait peut-être utile de faire un exemple très simple, dans lequel je pourrais

117
00:06:27,163 --> 00:06:30,967
vous demander quelle est la convolution de la liste 1, 2, 3 avec la liste 4, 5, 6.

118
00:06:30,967 --> 00:06:34,303
Vous pourriez imaginer prendre ces deux listes, retourner la

119
00:06:34,303 --> 00:06:37,857
seconde, puis commencer avec son couvercle complètement à gauche.

120
00:06:37,857 --> 00:06:40,987
Ensuite, la paire de valeurs qui s'alignent sont 1 et 4, multipliez-les

121
00:06:40,987 --> 00:06:43,813
ensemble, et cela nous donne notre premier terme de notre sortie.

122
00:06:43,813 --> 00:06:47,356
Faites glisser ce tableau inférieur d'une unité vers la droite, les paires

123
00:06:47,356 --> 00:06:51,040
qui s'alignent sont 1 et 5, et 2 et 4, multipliez ces paires, additionnez-les

124
00:06:51,040 --> 00:06:54,300
ensemble, et cela nous donne 13, l'entrée suivante dans notre sortie.

125
00:06:54,300 --> 00:06:57,859
Faites glisser les choses une fois de plus, et nous prendrons

126
00:06:57,859 --> 00:07:01,591
1 fois 6, plus 2 fois 5, plus 3 fois 4, ce qui se trouve être 28.

127
00:07:01,591 --> 00:07:06,211
Encore une slide, et on obtient 2 fois 6, plus 3 fois 5, et ça nous

128
00:07:06,211 --> 00:07:10,560
donne 27, et finalement le dernier terme ressemblera à 3 fois 6.

129
00:07:10,560 --> 00:07:13,508
Si vous le souhaitez, vous pouvez afficher votre langage de programmation

130
00:07:13,508 --> 00:07:16,376
préféré et votre bibliothèque préférée qui comprend diverses opérations

131
00:07:16,376 --> 00:07:18,807
numériques, et vous pouvez confirmer que je ne vous mens pas.

132
00:07:18,807 --> 00:07:21,753
Si vous prenez la convolution de 1, 2, 3, contre

133
00:07:21,753 --> 00:07:24,880
4, 5, 6, c'est bien le résultat que vous obtiendrez.

134
00:07:24,880 --> 00:07:27,532
Nous avons vu un cas où il s'agit d'une opération naturelle

135
00:07:27,532 --> 00:07:29,919
et souhaitable, qui s'additionne aux distributions de

136
00:07:29,919 --> 00:07:32,881
probabilité, et un autre exemple courant serait une moyenne mobile.

137
00:07:32,881 --> 00:07:35,921
Imaginez que vous avez une longue liste de nombres et que vous prenez

138
00:07:35,921 --> 00:07:38,788
une autre liste plus petite de nombres dont la somme donne tous 1.

139
00:07:38,788 --> 00:07:41,085
Dans ce cas, j'ai juste une petite liste de 5

140
00:07:41,085 --> 00:07:43,381
valeurs, et elles sont toutes égales à 1 5ème.

141
00:07:43,381 --> 00:07:47,347
Ensuite, si nous effectuons ce processus de convolution par fenêtre coulissante, fermons

142
00:07:47,347 --> 00:07:51,224
en quelque sorte les yeux et balayons sous le tapis ce qui se passe au tout début, une

143
00:07:51,224 --> 00:07:54,878
fois que notre plus petite liste de valeurs chevauche entièrement la plus grande,

144
00:07:54,878 --> 00:07:58,622
réfléchissez à ce que signifie chaque terme de cette liste. la convolution signifie

145
00:07:58,622 --> 00:07:59,023
vraiment.

146
00:07:59,023 --> 00:08:02,959
À chaque itération, vous multipliez chacune des valeurs de vos

147
00:08:02,959 --> 00:08:06,708
données par 1 5 et les additionnez toutes, c'est-à-dire que

148
00:08:06,708 --> 00:08:10,769
vous prenez une moyenne de vos données dans cette petite fenêtre.

149
00:08:10,769 --> 00:08:13,878
Dans l'ensemble, le processus vous donne une version lissée des données

150
00:08:13,878 --> 00:08:16,771
d'origine, et vous pouvez la modifier en commençant par une petite

151
00:08:16,771 --> 00:08:19,750
liste de nombres différente, et tant que cette petite liste totalise

152
00:08:19,750 --> 00:08:22,816
1, vous pouvez toujours l'interpréter comme une valeur mobile. moyenne.

153
00:08:22,816 --> 00:08:25,375
Dans l'exemple présenté ici, cette moyenne mobile

154
00:08:25,375 --> 00:08:27,781
accorderait plus de poids à la valeur centrale.

155
00:08:27,781 --> 00:08:33,200
Cela se traduit également par une version lissée des données.

156
00:08:33,200 --> 00:08:35,875
Si vous faites une sorte d’analogue bidimensionnel, cela vous

157
00:08:35,875 --> 00:08:38,594
donne un algorithme amusant pour rendre floue une image donnée.

158
00:08:38,594 --> 00:08:41,759
Et je dois dire que les animations que je m'apprête à montrer sont modifiées

159
00:08:41,759 --> 00:08:44,843
à partir de quelque chose que j'ai initialement créé pour une partie d'une

160
00:08:44,843 --> 00:08:47,762
série de conférences que j'ai données avec le Julia Lab au MIT pour un

161
00:08:47,762 --> 00:08:50,887
certain cours OpenCourseWare qui comprenait une unité de traitement d'image.

162
00:08:50,887 --> 00:08:53,649
Là, nous avons fait un peu plus pour plonger dans le code derrière

163
00:08:53,649 --> 00:08:56,452
tout cela, donc si vous êtes curieux, je vous laisse quelques liens.

164
00:08:56,452 --> 00:09:00,817
Mais en revenant sur cet exemple de flou, ce qui se passe, c'est que j'ai cette petite

165
00:09:00,817 --> 00:09:05,183
grille de valeurs 3x3 qui défile le long de notre image d'origine, et si nous zoomons,

166
00:09:05,183 --> 00:09:09,499
chacune de ces valeurs est 1 9ème, et ce que je fais à chaque itération, on multiplie

167
00:09:09,499 --> 00:09:13,312
chacune de ces valeurs par le pixel correspondant sur lequel elle se trouve.

168
00:09:13,312 --> 00:09:16,810
Et bien sûr, en informatique, nous considérons les couleurs comme de petits

169
00:09:16,810 --> 00:09:20,400
vecteurs de trois valeurs, représentant les composantes rouge, verte et bleue.

170
00:09:20,400 --> 00:09:23,702
Lorsque je multiplie toutes ces petites valeurs par 1 9 et que je les

171
00:09:23,702 --> 00:09:27,145
additionne, cela nous donne une moyenne pour chaque canal de couleur, et

172
00:09:27,145 --> 00:09:30,966
le pixel correspondant pour l'image de droite est défini comme étant cette somme.

173
00:09:30,966 --> 00:09:34,518
L'effet global, lorsque nous faisons cela pour chaque pixel de

174
00:09:34,518 --> 00:09:37,958
l'image, est que chacun d'entre eux se reflète dans tous ses

175
00:09:37,958 --> 00:09:41,680
voisins, ce qui nous donne une version plus floue que l'originale.

176
00:09:41,680 --> 00:09:44,457
Dans le jargon, nous dirions que l'image de droite est une

177
00:09:44,457 --> 00:09:47,800
convolution de notre image originale avec une petite grille de valeurs.

178
00:09:47,800 --> 00:09:51,160
Ou plus techniquement, je devrais peut-être dire que c'est la convolution

179
00:09:51,160 --> 00:09:54,430
avec une version tournée à 180 degrés de cette petite grille de valeurs.

180
00:09:54,430 --> 00:09:58,340
Cela n'a pas d'importance lorsque la grille est symétrique, mais il convient simplement

181
00:09:58,340 --> 00:10:01,805
de garder à l'esprit que la définition d'une convolution, héritée du contexte

182
00:10:01,805 --> 00:10:05,760
mathématique pur, devrait toujours vous inviter à penser à retourner ce deuxième tableau.

183
00:10:05,760 --> 00:10:08,465
Si nous modifions légèrement cela, nous pouvons obtenir un effet de flou

184
00:10:08,465 --> 00:10:11,059
beaucoup plus élégant en choisissant une grille de valeurs différente.

185
00:10:11,059 --> 00:10:15,920
Dans ce cas, j'ai une petite grille 5x5, mais la distinction n'est pas tant sa taille.

186
00:10:15,920 --> 00:10:19,229
Si nous zoomons, nous remarquons que la valeur au milieu est beaucoup plus grande

187
00:10:19,229 --> 00:10:22,822
que la valeur vers les bords, et cela vient du fait qu'elles sont toutes échantillonnées

188
00:10:22,822 --> 00:10:26,010
à partir d'une courbe en cloche, connue sous le nom de distribution gaussienne.

189
00:10:26,010 --> 00:10:29,447
De cette façon, lorsque nous multiplions toutes ces valeurs par le pixel

190
00:10:29,447 --> 00:10:32,884
correspondant sur lequel elles se trouvent, nous accordons beaucoup plus

191
00:10:32,884 --> 00:10:36,367
de poids à ce pixel central et beaucoup moins à ceux situés en périphérie.

192
00:10:36,367 --> 00:10:40,373
Et comme auparavant, le pixel correspondant à droite est défini comme étant cette somme.

193
00:10:40,373 --> 00:10:43,551
Comme nous effectuons ce processus pour chaque pixel, cela donne

194
00:10:43,551 --> 00:10:46,728
un effet de flou qui simule de manière beaucoup plus authentique

195
00:10:46,728 --> 00:10:49,760
la notion de flou de votre objectif ou quelque chose comme ça.

196
00:10:49,760 --> 00:10:53,474
Mais le flou est loin d’être la seule chose que l’on peut faire avec cette idée.

197
00:10:53,474 --> 00:10:56,706
Par exemple, jetez un œil à cette petite grille de valeurs, qui

198
00:10:56,706 --> 00:10:59,889
implique des nombres positifs à gauche et des nombres négatifs

199
00:10:59,889 --> 00:11:03,071
à droite, que je colorierai respectivement en bleu et en rouge.

200
00:11:03,071 --> 00:11:06,484
Prenez un moment pour voir si vous pouvez prédire et

201
00:11:06,484 --> 00:11:09,769
comprendre quel effet cela aura sur l'image finale.

202
00:11:09,769 --> 00:11:13,806
Donc, dans ce cas, je penserai simplement à l'image en niveaux de gris plutôt qu'en

203
00:11:13,806 --> 00:11:18,082
couleur, donc chacun des pixels est simplement représenté par un nombre au lieu de trois.

204
00:11:18,082 --> 00:11:20,550
Et une chose à noter est que lorsque nous effectuons cette

205
00:11:20,550 --> 00:11:23,102
convolution, il est possible d'obtenir des valeurs négatives.

206
00:11:23,102 --> 00:11:26,178
Par exemple, à ce stade, si nous zoomons sur la moitié gauche de notre petite

207
00:11:26,178 --> 00:11:29,373
grille, elle se trouve entièrement au-dessus des pixels noirs, ce qui aurait une

208
00:11:29,373 --> 00:11:32,607
valeur de zéro, mais la moitié droite des valeurs négatives se trouve entièrement

209
00:11:32,607 --> 00:11:36,000
au-dessus des pixels blancs, ce qui aurait une valeur de zéro. avoir une valeur de un.

210
00:11:36,000 --> 00:11:39,348
Ainsi, lorsque nous multiplions les termes correspondants et les additionnons, les

211
00:11:39,348 --> 00:11:42,576
résultats seront très négatifs, et la façon dont j'affiche cela avec l'image de

212
00:11:42,576 --> 00:11:46,046
droite est de colorer les valeurs négatives en rouge et les valeurs positives en bleu.

213
00:11:46,046 --> 00:11:48,950
Une autre chose à remarquer est que lorsque vous êtes sur un

214
00:11:48,950 --> 00:11:51,902
patch qui est tout de même de la même couleur, tout va à zéro

215
00:11:51,902 --> 00:11:54,854
puisque la somme des valeurs de notre petite grille est nulle.

216
00:11:54,854 --> 00:11:58,831
Ceci est très différent des deux exemples précédents où la somme de notre petite grille

217
00:11:58,831 --> 00:12:02,764
était une, ce qui nous permettait de l'interpréter comme une moyenne mobile et donc un

218
00:12:02,764 --> 00:12:02,990
flou.

219
00:12:02,990 --> 00:12:07,494
Dans l'ensemble, ce petit processus détecte essentiellement les variations de

220
00:12:07,494 --> 00:12:12,113
la valeur des pixels lorsque vous vous déplacez de gauche à droite, ce qui vous

221
00:12:12,113 --> 00:12:16,560
donne une sorte de moyen de détecter tous les bords verticaux de votre image.

222
00:12:16,560 --> 00:12:20,933
Et de même, si nous faisons pivoter cette grille pour qu'elle varie à mesure que vous

223
00:12:20,933 --> 00:12:25,409
vous déplacez de haut en bas, cela reprendra tous les bords horizontaux, ce qui dans le

224
00:12:25,409 --> 00:12:29,986
cas de notre petite image de créature en tarte se traduira par des yeux assez démoniaques.

225
00:12:29,986 --> 00:12:32,641
D'ailleurs, cette grille plus petite est souvent appelée noyau, et la beauté

226
00:12:32,641 --> 00:12:35,296
ici réside dans la façon dont, en choisissant simplement un noyau différent,

227
00:12:35,296 --> 00:12:37,986
vous pouvez obtenir différents effets de traitement d'image, non seulement en

228
00:12:37,986 --> 00:12:40,710
brouillant votre détection de contour, mais également en améliorant la netteté.

229
00:12:40,710 --> 00:12:44,392
Pour ceux d'entre vous qui ont entendu parler d'un réseau neuronal convolutif,

230
00:12:44,392 --> 00:12:47,935
l'idée est d'utiliser des données pour déterminer ce que devraient être les

231
00:12:47,935 --> 00:12:51,618
noyaux en premier lieu, en fonction de ce que le réseau neuronal veut détecter.

232
00:12:51,618 --> 00:12:55,378
Une autre chose que je devrais peut-être aborder est la durée de la sortie.

233
00:12:55,378 --> 00:12:58,567
Pour quelque chose comme l'exemple de moyenne mobile, vous voudrez peut-être

234
00:12:58,567 --> 00:13:01,838
penser aux termes uniquement lorsque les deux fenêtres s'alignent complètement

235
00:13:01,838 --> 00:13:05,068
l'une avec l'autre, ou dans l'exemple de traitement d'image, vous souhaiterez

236
00:13:05,068 --> 00:13:07,760
peut-être que la sortie finale ait la même taille que l'original.

237
00:13:07,760 --> 00:13:10,704
Désormais, les convolutions en tant qu'opération mathématique pure produisent

238
00:13:10,704 --> 00:13:13,611
toujours un tableau plus grand que les deux tableaux avec lesquels vous avez

239
00:13:13,611 --> 00:13:16,405
commencé, du moins en supposant que l'un d'eux n'a pas une longueur de un.

240
00:13:16,405 --> 00:13:19,027
Sachez simplement que dans certains contextes informatiques,

241
00:13:19,027 --> 00:13:21,520
vous souhaitez souvent délibérément tronquer cette sortie.

242
00:13:21,520 --> 00:13:25,923
Une autre chose qui mérite d'être soulignée est que dans le contexte informatique,

243
00:13:25,923 --> 00:13:29,955
cette notion de retourner ce noyau avant de le laisser parcourir l'original

244
00:13:29,955 --> 00:13:34,041
semble souvent vraiment étrange et tout simplement déplacée, mais encore une

245
00:13:34,041 --> 00:13:38,232
fois, notez que c'est ce qui est hérité du contexte mathématique pur où, comme

246
00:13:38,232 --> 00:13:42,530
nous, vu avec les probabilités, c'est une chose incroyablement naturelle à faire.

247
00:13:42,530 --> 00:13:45,810
Et en fait, je peux vous montrer un autre exemple mathématique pur où

248
00:13:45,810 --> 00:13:49,090
même les programmeurs devraient s'intéresser à celui-ci, car il ouvre

249
00:13:49,090 --> 00:13:52,370
la porte à un algorithme beaucoup plus rapide pour calculer tout cela.

250
00:13:52,370 --> 00:13:54,667
Pour configurer ce que j'entends par plus rapidement ici,

251
00:13:54,667 --> 00:13:57,123
permettez-moi de revenir en arrière et de récupérer du python

252
00:13:57,123 --> 00:13:59,579
et je vais créer deux tableaux différents relativement grands.

253
00:13:59,579 --> 00:14:03,521
Chacun contiendra cent mille éléments aléatoires et je vais évaluer le

254
00:14:03,521 --> 00:14:07,575
temps d'exécution de la fonction de convolution de la bibliothèque numpy.

255
00:14:07,575 --> 00:14:11,430
Et dans ce cas, il l'exécute pendant plusieurs itérations différentes, essaie de

256
00:14:11,430 --> 00:14:15,619
trouver une moyenne, et il semble que sur cet ordinateur, au moins, la moyenne est de 4.

257
00:14:15,619 --> 00:14:16,321
87 secondes.

258
00:14:16,321 --> 00:14:21,105
En revanche, si j'utilise une fonction différente de la bibliothèque scipy appelée

259
00:14:21,105 --> 00:14:26,061
fftconvolve, c'est la même chose, juste implémentée différemment, cela ne prend que 4.

260
00:14:26,061 --> 00:14:30,640
3 millisecondes en moyenne, donc une amélioration de trois ordres de grandeur.

261
00:14:30,640 --> 00:14:33,413
Et encore une fois, même si elle porte un nom différent, elle donne

262
00:14:33,413 --> 00:14:36,024
le même résultat que l'autre fonction de convolution, elle fait

263
00:14:36,024 --> 00:14:38,880
simplement quelque chose pour y parvenir de manière plus intelligente.

264
00:14:38,880 --> 00:14:43,312
Rappelez-vous comment, avec l'exemple de probabilité, j'ai dit qu'une autre

265
00:14:43,312 --> 00:14:47,978
façon de penser à la convolution était de créer ce tableau de tous les produits

266
00:14:47,978 --> 00:14:52,528
par paires, puis d'additionner ces produits par paires le long des diagonales.

267
00:14:52,528 --> 00:14:55,795
Il n'y a bien sûr rien de spécifique à la probabilité. Chaque fois que vous

268
00:14:55,795 --> 00:14:59,321
convoquez deux listes différentes de nombres, vous pouvez y penser de cette façon.

269
00:14:59,321 --> 00:15:02,895
Créez ce type de table de multiplication avec tous les produits par paires, puis

270
00:15:02,895 --> 00:15:06,381
chaque somme le long de la diagonale correspond à l'un de vos résultats finaux.

271
00:15:06,381 --> 00:15:09,434
Un contexte dans lequel cette vue est particulièrement

272
00:15:09,434 --> 00:15:12,431
naturelle est celui où vous multipliez deux polynômes.

273
00:15:12,431 --> 00:15:16,163
Par exemple, permettez-moi de prendre la petite grille que nous

274
00:15:16,163 --> 00:15:19,954
avons déjà et de remplacer les termes supérieurs par 1, 2x et 3x

275
00:15:19,954 --> 00:15:23,920
au carré et de remplacer les autres termes par 4, 5x et 6x au carré.

276
00:15:23,920 --> 00:15:26,272
Pensez maintenant à ce que cela signifie lorsque nous créons

277
00:15:26,272 --> 00:15:28,664
tous ces différents produits par paires entre les deux listes.

278
00:15:28,664 --> 00:15:32,259
Ce que vous faites consiste essentiellement à étendre le produit complet

279
00:15:32,259 --> 00:15:35,904
des deux polynômes que j'ai écrits, puis lorsque vous additionnez le long

280
00:15:35,904 --> 00:15:39,647
de la diagonale qui correspond à la collecte de tous les termes similaires,

281
00:15:39,647 --> 00:15:43,341
ce qui est plutôt intéressant, étendre un polynôme et collecter des termes

282
00:15:43,341 --> 00:15:46,937
similaires est exactement le résultat. même processus qu’une convolution.

283
00:15:46,937 --> 00:15:49,760
Mais cela nous permet de faire quelque chose de

284
00:15:49,760 --> 00:15:52,642
plutôt cool, car pensez à ce que nous disons ici.

285
00:15:52,642 --> 00:15:56,732
Nous disons que si vous prenez deux fonctions différentes et que vous les multipliez

286
00:15:56,732 --> 00:16:00,629
ensemble, ce qui est une simple opération ponctuelle, c'est la même chose que si

287
00:16:00,629 --> 00:16:04,575
vous aviez d'abord extrait les coefficients de chacune d'elles en supposant qu'il

288
00:16:04,575 --> 00:16:08,761
s'agit de polynômes, puis pris une convolution de ceux-ci. deux listes de coefficients.

289
00:16:08,761 --> 00:16:12,319
Ce qui rend cela si intéressant, c'est que les convolutions semblent en principe

290
00:16:12,319 --> 00:16:15,526
beaucoup plus compliquées qu'une simple multiplication et je ne veux pas

291
00:16:15,526 --> 00:16:18,909
seulement dire que sur le plan conceptuel, il est plus difficile d'y penser,

292
00:16:18,909 --> 00:16:22,423
je veux dire que sur le plan informatique, il faut plus d'étapes pour effectuer

293
00:16:22,423 --> 00:16:26,070
une convolution que pour effectuer une produit ponctuel de deux listes différentes.

294
00:16:26,070 --> 00:16:30,035
Par exemple, disons que je vous ai donné deux très gros polynômes, disons chacun

295
00:16:30,035 --> 00:16:33,854
avec une centaine de coefficients différents, alors si la façon dont vous les

296
00:16:33,854 --> 00:16:37,672
multipliez était d'étendre ce produit, vous savez, en remplissant toute cette

297
00:16:37,672 --> 00:16:41,540
grille de 100 par 100 de produits par paires qui vous obligeraient à effectuez

298
00:16:41,540 --> 00:16:45,603
10 000 produits différents, puis lorsque vous collectez tous les termes similaires

299
00:16:45,603 --> 00:16:49,666
le long des diagonales, vous obtenez un autre ensemble d'environ 10 000 opérations.

300
00:16:49,666 --> 00:16:53,419
Plus généralement, dans le jargon, nous dirions que l'algorithme est

301
00:16:53,419 --> 00:16:57,117
O de n au carré, ce qui signifie pour deux listes de taille n de la

302
00:16:57,117 --> 00:17:00,816
manière dont le nombre d'opérations est proportionnel au carré de n.

303
00:17:00,816 --> 00:17:04,747
D'un autre côté, si je pense à deux polynômes en termes de leurs sorties, par

304
00:17:04,747 --> 00:17:08,426
exemple en échantillonnant leurs valeurs sur une poignée d'entrées, leur

305
00:17:08,426 --> 00:17:12,508
multiplication ne nécessite qu'autant d'opérations que le nombre d'échantillons,

306
00:17:12,508 --> 00:17:16,540
car encore une fois, c'est une opération ponctuelle et avec les polynômes, vous

307
00:17:16,540 --> 00:17:20,471
n'avez besoin que de un nombre fini d'échantillons pour pouvoir récupérer les

308
00:17:20,471 --> 00:17:21,126
coefficients.

309
00:17:21,126 --> 00:17:24,923
Par exemple, deux sorties suffisent pour spécifier de manière unique un polynôme

310
00:17:24,923 --> 00:17:28,720
linéaire, trois sorties suffiraient pour spécifier de manière unique un polynôme

311
00:17:28,720 --> 00:17:32,704
quadratique et en général, si vous connaissez n sorties distinctes, cela suffit pour

312
00:17:32,704 --> 00:17:36,595
spécifier de manière unique un polynôme qui a n coefficients différents ou si vous

313
00:17:36,595 --> 00:17:40,814
préférez, nous pourrions Exprimez ceci dans le langage des systèmes d'équations. Imaginez

314
00:17:40,814 --> 00:17:45,033
que je vous dis que j'ai un polynôme mais je ne vous dis pas quels sont les coefficients,

315
00:17:45,033 --> 00:17:46,439
ils sont un mystère pour vous.

316
00:17:46,439 --> 00:17:50,495
Dans notre exemple, vous pourriez considérer cela comme le produit que nous essayons

317
00:17:50,495 --> 00:17:54,790
de comprendre, puis supposez que je dis que je vais simplement vous dire quelles seraient

318
00:17:54,790 --> 00:17:58,893
les sorties de ce polynôme si vous saisissiez différentes entrées telles que 0, 1, 2.

319
00:17:58,893 --> 00:18:02,997
, 3, encore et encore et je vous en donne assez pour que vous ayez autant d'équations

320
00:18:02,997 --> 00:18:06,958
que d'inconnues il se trouve même que ce soit un système d'équations linéaire donc

321
00:18:06,958 --> 00:18:11,061
c'est sympa et en principe au moins cela devrait suffire à récupérer les coefficients.


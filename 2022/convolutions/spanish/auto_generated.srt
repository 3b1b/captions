1
00:00:00,000 --> 00:00:02,410
Supongamos que le doy dos listas diferentes de números,

2
00:00:02,410 --> 00:00:05,251
o tal vez dos funciones diferentes, y le pido que piense en todas

3
00:00:05,251 --> 00:00:08,135
las formas en que podría combinar esas dos listas para obtener una

4
00:00:08,135 --> 00:00:11,793
nueva lista de números, o combinar las dos funciones para obtener una nueva función.

5
00:00:11,793 --> 00:00:14,056
. Quizás una forma sencilla que se nos ocurra

6
00:00:14,056 --> 00:00:16,320
sea simplemente sumarlos término por término.

7
00:00:16,320 --> 00:00:20,106
Así mismo con las funciones, puedes agregar todas las salidas correspondientes.

8
00:00:20,106 --> 00:00:23,283
De manera similar, también puedes multiplicar las dos listas

9
00:00:23,283 --> 00:00:26,199
término por término y hacer lo mismo con las funciones.

10
00:00:26,199 --> 00:00:30,248
Pero hay otro tipo de combinación tan fundamental como ambas,

11
00:00:30,248 --> 00:00:33,840
pero mucho menos discutida, conocida como convolución.

12
00:00:33,840 --> 00:00:36,030
Pero a diferencia de los dos casos anteriores,

13
00:00:36,030 --> 00:00:39,946
no es algo que simplemente se hereda de una operación que puedes hacer con números.

14
00:00:39,946 --> 00:00:44,778
Es algo realmente nuevo para el contexto de listas de números o combinación de funciones.

15
00:00:44,778 --> 00:00:48,577
Aparecen por todas partes, son omnipresentes en el procesamiento de imágenes,

16
00:00:48,577 --> 00:00:51,547
es una construcción central en la teoría de la probabilidad,

17
00:00:51,547 --> 00:00:55,443
se usan mucho para resolver ecuaciones diferenciales y es un contexto en el que

18
00:00:55,443 --> 00:00:58,317
es casi seguro que lo hayas visto, si no. con este nombre,

19
00:00:58,317 --> 00:01:00,265
es multiplicar dos polinomios entre sí.

20
00:01:00,265 --> 00:01:03,345
Como alguien en el negocio de las explicaciones visuales,

21
00:01:03,345 --> 00:01:07,700
este es un tema especialmente bueno, porque la definición formulada aislada y sin

22
00:01:07,700 --> 00:01:12,373
contexto puede parecer un poco intimidante, pero si nos tomamos el tiempo para analizar

23
00:01:12,373 --> 00:01:16,622
realmente lo que dice, y antes de eso, motivar por qué querrías algo como esto,

24
00:01:16,622 --> 00:01:18,800
es una operación increíblemente hermosa.

25
00:01:18,800 --> 00:01:21,141
Y tengo que admitir que en realidad aprendí algo

26
00:01:21,141 --> 00:01:23,482
mientras armaba las imágenes para este proyecto.

27
00:01:23,482 --> 00:01:25,772
En el caso de convolucionar dos funciones diferentes,

28
00:01:25,772 --> 00:01:29,460
estaba tratando de pensar en diferentes formas en las que podría imaginarse lo que eso

29
00:01:29,460 --> 00:01:33,149
podría significar, y con una de ellas tuve un pequeño momento de ajá sobre por qué las

30
00:01:33,149 --> 00:01:36,329
distribuciones normales desempeñan el papel que lo hacen con probabilidad,

31
00:01:36,329 --> 00:01:38,491
por qué es una forma tan natural para una función.

32
00:01:38,491 --> 00:01:41,626
Pero me estoy adelantando, hay mucha preparación para eso.

33
00:01:41,626 --> 00:01:45,993
En este video, nuestro enfoque principal será el caso discreto y, en particular,

34
00:01:45,993 --> 00:01:50,251
desarrollar un algoritmo muy inesperado pero muy inteligente para calcularlos.

35
00:01:50,251 --> 00:01:57,840
Y llevaré la discusión del caso continuo a una segunda parte.

36
00:01:57,840 --> 00:02:01,192
Es muy tentador comenzar con los ejemplos de procesamiento de imágenes,

37
00:02:01,192 --> 00:02:05,196
ya que son visualmente los más intrigantes, pero hay un par de detalles que hacen que

38
00:02:05,196 --> 00:02:09,200
el caso de procesamiento de imágenes sea menos representativo de las convoluciones en

39
00:02:09,200 --> 00:02:11,481
general, así que comencemos con la probabilidad.

40
00:02:11,481 --> 00:02:15,485
y en particular uno de los ejemplos más simples en el que estoy seguro todos aquí han

41
00:02:15,485 --> 00:02:19,257
pensado en algún momento de su vida, que es tirar un par de dados y calcular las

42
00:02:19,257 --> 00:02:21,585
posibilidades de obtener varias sumas diferentes.

43
00:02:21,585 --> 00:02:24,225
Y se podría decir, no es un problema, no es un problema.

44
00:02:24,225 --> 00:02:27,959
Cada uno de tus dos dados tiene seis resultados posibles diferentes,

45
00:02:27,959 --> 00:02:31,693
lo que nos da un total de 36 pares de resultados posibles distintos,

46
00:02:31,693 --> 00:02:36,240
y si los analizamos todos podemos contar cuántos pares tienen una suma determinada.

47
00:02:36,240 --> 00:02:39,081
Y al organizar todos los pares en una cuadrícula como esta,

48
00:02:39,081 --> 00:02:42,254
una cosa bastante buena es que todos los pares que tienen una suma

49
00:02:42,254 --> 00:02:45,711
constante son visibles a lo largo de una de estas diagonales diferentes.

50
00:02:45,711 --> 00:02:49,137
Entonces, simplemente contar cuántos existen en cada una de esas

51
00:02:49,137 --> 00:02:52,880
diagonales le indicará la probabilidad de que vea una suma particular.

52
00:02:52,880 --> 00:02:55,788
Y yo diría, muy bien, muy bien, pero ¿se te ocurre

53
00:02:55,788 --> 00:02:58,754
alguna otra manera de visualizar la misma pregunta?

54
00:02:58,754 --> 00:03:01,320
¿Otras imágenes que te pueden venir a la cabeza al pensar en

55
00:03:01,320 --> 00:03:03,801
todos los distintos pares que tienen una suma determinada?

56
00:03:03,801 --> 00:03:07,607
Y tal vez uno de ustedes levante la mano y diga: sí, tengo uno.

57
00:03:07,607 --> 00:03:11,026
Digamos que imaginas estos dos conjuntos diferentes de posibilidades,

58
00:03:11,026 --> 00:03:14,103
cada uno en una fila, pero le das la vuelta a la segunda fila.

59
00:03:14,103 --> 00:03:19,017
De esa manera, todos los diferentes pares que suman siete se alinean verticalmente así.

60
00:03:19,017 --> 00:03:22,096
Y si deslizamos la fila inferior completamente hacia la derecha,

61
00:03:22,096 --> 00:03:26,360
entonces el par único que suma dos, los ojos de serpiente, son los únicos que se alinean.

62
00:03:26,360 --> 00:03:29,039
Y si lo distribuyo una unidad hacia la derecha,

63
00:03:29,039 --> 00:03:32,945
los pares que se alinean son los dos pares diferentes que suman tres.

64
00:03:32,945 --> 00:03:36,524
Y, en general, los diferentes valores de compensación de esta matriz inferior,

65
00:03:36,524 --> 00:03:38,834
que recuerdo que tuve que darle la vuelta primero,

66
00:03:38,834 --> 00:03:41,870
revelan todos los pares distintos que tienen una suma determinada.

67
00:03:41,870 --> 00:03:44,780
En lo que respecta a las preguntas de probabilidad,

68
00:03:44,780 --> 00:03:48,474
esto todavía no es especialmente interesante, porque lo único que

69
00:03:48,474 --> 00:03:53,120
estamos haciendo es contar cuántos resultados hay en cada una de estas categorías.

70
00:03:53,120 --> 00:03:55,599
Pero eso es con el supuesto implícito de que hay la misma

71
00:03:55,599 --> 00:03:57,907
probabilidad de que aparezca cada una de estas caras.

72
00:03:57,907 --> 00:04:01,954
Pero ¿y si te dijera que tengo un juego de dados especial que no es uniforme?

73
00:04:01,954 --> 00:04:04,538
Tal vez el dado azul tenga su propio conjunto de números que

74
00:04:04,538 --> 00:04:06,783
describen las probabilidades de que salga cada cara,

75
00:04:06,783 --> 00:04:09,790
y el dado rojo tenga su propio conjunto de números distintivo y único.

76
00:04:09,790 --> 00:04:13,854
En ese caso, si quisieras calcular, digamos, la probabilidad de ver un dos,

77
00:04:13,854 --> 00:04:17,169
multiplicarías la probabilidad de que el dado azul sea un uno

78
00:04:17,169 --> 00:04:19,949
por la probabilidad de que el dado rojo sea un uno.

79
00:04:19,949 --> 00:04:22,446
Y para conocer las posibilidades de ver un tres,

80
00:04:22,446 --> 00:04:25,860
observas los dos pares distintos cuando sea posible y, nuevamente,

81
00:04:25,860 --> 00:04:30,039
multiplicas las probabilidades correspondientes y luego sumas esos dos productos.

82
00:04:30,039 --> 00:04:33,267
De manera similar, las posibilidades de ver un cuatro implican

83
00:04:33,267 --> 00:04:36,802
multiplicar tres pares diferentes de posibilidades y sumarlos todos.

84
00:04:36,802 --> 00:04:39,619
Y con el ánimo de establecer algunas fórmulas,

85
00:04:39,619 --> 00:04:43,275
llamemos a estas probabilidades superiores a1, a2, a3, etc.,

86
00:04:43,275 --> 00:04:45,973
y llamemos a las inferiores b1, b2, b3, etc.

87
00:04:45,973 --> 00:04:50,180
Y en general, este proceso, en el que tomamos dos conjuntos diferentes de números,

88
00:04:50,180 --> 00:04:54,691
volteamos el segundo y luego los alineamos en varios valores de compensación diferentes,

89
00:04:54,691 --> 00:04:57,529
tomamos un montón de productos por pares y los sumamos,

90
00:04:57,529 --> 00:05:01,229
ese es uno de los Formas fundamentales de pensar qué es una convolución.

91
00:05:01,229 --> 00:05:06,423
Entonces, para explicarlo un poco más exactamente, a través de este proceso,

92
00:05:06,423 --> 00:05:11,751
simplemente generamos probabilidades de ver dos, tres, cuatro, y así hasta 12,

93
00:05:11,751 --> 00:05:17,147
y las obtuvimos mezclando una lista de valores, a, y otra. lista de valores, b.

94
00:05:17,147 --> 00:05:20,524
En la jerga, diríamos que la convolución de esas dos secuencias

95
00:05:20,524 --> 00:05:23,848
nos da esta nueva secuencia, la nueva secuencia de 11 valores,

96
00:05:23,848 --> 00:05:27,172
cada uno de los cuales parece una suma de productos por pares.

97
00:05:27,172 --> 00:05:31,841
Si lo prefieres, otra forma de pensar en la misma operación es crear primero

98
00:05:31,841 --> 00:05:36,753
una tabla de todos los productos por pares y luego sumar todas estas diagonales.

99
00:05:36,753 --> 00:05:39,572
Nuevamente, esa es una forma de mezclar estas dos secuencias

100
00:05:39,572 --> 00:05:42,299
de números para obtener una nueva secuencia de 11 números.

101
00:05:42,299 --> 00:05:45,390
Es el mismo funcionamiento que pensaban las ventanas correderas,

102
00:05:45,390 --> 00:05:46,960
sólo que desde otra perspectiva.

103
00:05:46,960 --> 00:05:50,360
Poniéndole una pequeña notación, así es como podría verlo escrito.

104
00:05:50,360 --> 00:05:55,135
La convolución de a y b, indicada con este pequeño asterisco, es una nueva lista,

105
00:05:55,135 --> 00:05:58,163
y el enésimo elemento de esa lista parece una suma,

106
00:05:58,163 --> 00:06:01,889
y esa suma abarca todos los diferentes pares de índices, i y j,

107
00:06:01,889 --> 00:06:04,800
de modo que la suma de esos índices es igual a n.

108
00:06:04,800 --> 00:06:08,667
Es un poco complicado, pero por ejemplo, si n fuera 6,

109
00:06:08,667 --> 00:06:13,236
los pares que repasaremos son 1 y 5, 2 y 4, 3 y 3, 4 y 2, 5 y 1,

110
00:06:13,236 --> 00:06:16,400
todos los pares diferentes que se suman a 6.

111
00:06:16,400 --> 00:06:18,723
Pero, sinceramente, independientemente de cómo lo escribas,

112
00:06:18,723 --> 00:06:22,093
la notación tiene una importancia secundaria frente a la imagen que puedas tener en tu

113
00:06:22,093 --> 00:06:23,139
cabeza durante el proceso.

114
00:06:23,139 --> 00:06:26,075
Aquí, tal vez sea útil hacer un ejemplo súper simple,

115
00:06:26,075 --> 00:06:29,828
donde podría preguntarte cuál es la convolución de la lista 1, 2, 3,

116
00:06:29,828 --> 00:06:31,024
con la lista 4, 5, 6.

117
00:06:31,024 --> 00:06:34,599
Podrías imaginarte tomar ambas listas, darle la vuelta a la segunda

118
00:06:34,599 --> 00:06:37,910
y luego comenzar con la tapa completamente hacia la izquierda.

119
00:06:37,910 --> 00:06:40,357
Luego, el par de valores que se alinean son 1 y 4,

120
00:06:40,357 --> 00:06:43,860
los multiplicamos y eso nos da nuestro primer término de nuestra salida.

121
00:06:43,860 --> 00:06:46,954
Deslice la matriz inferior una unidad hacia la derecha,

122
00:06:46,954 --> 00:06:50,767
los pares que se alinean son 1 y 5, y 2 y 4, multiplique esos pares,

123
00:06:50,767 --> 00:06:54,360
súmelos y eso nos da 13, la siguiente entrada en nuestra salida.

124
00:06:54,360 --> 00:06:58,085
Desliza las cosas una vez más y tomaremos 1 por 6,

125
00:06:58,085 --> 00:07:01,665
más 2 por 5, más 3 por 4, lo que resulta ser 28.

126
00:07:01,665 --> 00:07:05,538
Una diapositiva más y obtenemos 2 por 6, más 3 por 5,

127
00:07:05,538 --> 00:07:10,560
y eso nos da 27, y finalmente el último término se verá como 3 por 6.

128
00:07:10,560 --> 00:07:13,215
Si lo desea, puede consultar cualquiera que sea su lenguaje de

129
00:07:13,215 --> 00:07:16,966
programación favorito y su biblioteca favorita que incluya varias operaciones numéricas,

130
00:07:16,966 --> 00:07:18,862
y podrá confirmar que no le estoy mintiendo.

131
00:07:18,862 --> 00:07:21,871
Si tomas la convolución de 1, 2, 3 contra 4, 5,

132
00:07:21,871 --> 00:07:24,880
6, este es de hecho el resultado que obtendrás.

133
00:07:24,880 --> 00:07:28,568
Hemos visto un caso en el que se trata de una operación natural y deseable,

134
00:07:28,568 --> 00:07:32,936
que se suma a distribuciones de probabilidad, y otro ejemplo común sería una media móvil.

135
00:07:32,936 --> 00:07:35,743
Imagina que tienes una lista larga de números y

136
00:07:35,743 --> 00:07:38,842
tomas otra lista más pequeña de números que suman 1.

137
00:07:38,842 --> 00:07:43,437
En este caso, solo tengo una pequeña lista de 5 valores y todos son iguales a 15.

138
00:07:43,437 --> 00:07:46,758
Luego, si hacemos este proceso de convolución de ventana deslizante,

139
00:07:46,758 --> 00:07:50,657
cerramos los ojos y escondemos debajo de la alfombra lo que sucede al principio,

140
00:07:50,657 --> 00:07:54,603
una vez que nuestra lista más pequeña de valores se superpone por completo con la

141
00:07:54,603 --> 00:07:58,454
más grande, piense en lo que significa cada término en este realmente significa

142
00:07:58,454 --> 00:07:59,080
convolución.

143
00:07:59,080 --> 00:08:02,918
En cada iteración, lo que estás haciendo es multiplicar cada uno

144
00:08:02,918 --> 00:08:06,638
de los valores de tus datos por 15 y sumarlos todos, es decir,

145
00:08:06,638 --> 00:08:10,831
estás tomando un promedio de tus datos dentro de esta pequeña ventana.

146
00:08:10,831 --> 00:08:14,591
En general, el proceso le brinda una versión suavizada de los datos originales,

147
00:08:14,591 --> 00:08:18,116
y puede modificarla comenzando con una pequeña lista diferente de números,

148
00:08:18,116 --> 00:08:22,346
y mientras esa pequeña lista sume 1, aún puede interpretarla como una lista en movimiento.

149
00:08:22,346 --> 00:08:22,864
promedio.

150
00:08:22,864 --> 00:08:27,833
En el ejemplo que se muestra aquí, esa media móvil daría más peso al valor central.

151
00:08:27,833 --> 00:08:33,200
Esto también da como resultado una versión suavizada de los datos.

152
00:08:33,200 --> 00:08:35,566
Si haces una especie de analogía bidimensional de esto,

153
00:08:35,566 --> 00:08:38,652
obtendrás un algoritmo divertido para desenfocar una imagen determinada.

154
00:08:38,652 --> 00:08:41,700
Y debo decir que las animaciones que estoy a punto de mostrar están

155
00:08:41,700 --> 00:08:44,703
modificadas de algo que hice originalmente para parte de una serie

156
00:08:44,703 --> 00:08:47,751
de conferencias que di con el Julia Lab en el MIT para cierta clase

157
00:08:47,751 --> 00:08:50,933
de OpenCourseWare que incluía una unidad de procesamiento de imágenes.

158
00:08:50,933 --> 00:08:54,137
Allí hicimos un poco más para profundizar en el código detrás de todo esto,

159
00:08:54,137 --> 00:08:56,499
así que si tienes curiosidad te dejaré algunos enlaces.

160
00:08:56,499 --> 00:08:58,934
Pero volviendo a centrarnos en este ejemplo borroso,

161
00:08:58,934 --> 00:09:02,197
lo que está pasando es que tengo esta pequeña cuadrícula de valores de

162
00:09:02,197 --> 00:09:05,598
3x3 que avanza a lo largo de nuestra imagen original, y si nos acercamos,

163
00:09:05,598 --> 00:09:08,999
cada uno de esos valores es 19, y lo que estoy haciendo en cada iteración

164
00:09:08,999 --> 00:09:12,399
se multiplica cada uno de esos valores por el píxel correspondiente sobre

165
00:09:12,399 --> 00:09:13,365
el que se encuentra.

166
00:09:13,365 --> 00:09:16,692
Y, por supuesto, en informática pensamos en los colores como pequeños

167
00:09:16,692 --> 00:09:20,400
vectores de tres valores, que representan los componentes rojo, verde y azul.

168
00:09:20,400 --> 00:09:23,889
Cuando multiplico todos estos pequeños valores por 19 y los sumo,

169
00:09:23,889 --> 00:09:26,903
obtenemos un promedio a lo largo de cada canal de color,

170
00:09:26,903 --> 00:09:31,027
y el píxel correspondiente a la imagen de la derecha se define como esa suma.

171
00:09:31,027 --> 00:09:35,022
El efecto general, al hacer esto para cada píxel de la imagen,

172
00:09:35,022 --> 00:09:38,192
es que cada uno se fusiona con todos sus vecinos,

173
00:09:38,192 --> 00:09:41,680
lo que nos da una versión más borrosa que la original.

174
00:09:41,680 --> 00:09:44,813
En la jerga diríamos que la imagen de la derecha es una convolución

175
00:09:44,813 --> 00:09:47,855
de nuestra imagen original con una pequeña cuadrícula de valores.

176
00:09:47,855 --> 00:09:51,141
O más técnicamente tal vez debería decir que es la convolución con

177
00:09:51,141 --> 00:09:54,477
una versión girada 180 grados de esa pequeña cuadrícula de valores.

178
00:09:54,477 --> 00:09:57,111
No es que importe cuando la cuadrícula es simétrica,

179
00:09:57,111 --> 00:10:00,491
pero vale la pena tener en cuenta que la definición de convolución,

180
00:10:00,491 --> 00:10:04,169
heredada del contexto matemático puro, siempre debería invitarte a pensar

181
00:10:04,169 --> 00:10:05,760
en invertir esa segunda matriz.

182
00:10:05,760 --> 00:10:08,592
Si modificamos esto ligeramente podemos conseguir un efecto de desenfoque

183
00:10:08,592 --> 00:10:11,118
mucho más elegante eligiendo una cuadrícula de valores diferente.

184
00:10:11,118 --> 00:10:13,727
En este caso tengo una pequeña cuadrícula de 5x5,

185
00:10:13,727 --> 00:10:15,920
pero la distinción no es tanto su tamaño.

186
00:10:15,920 --> 00:10:19,238
Si nos acercamos, notamos que el valor en el medio es mucho mayor que

187
00:10:19,238 --> 00:10:22,651
el valor hacia los bordes, y esto se debe a que todos están muestreados

188
00:10:22,651 --> 00:10:26,064
a partir de una curva de campana, conocida como distribución gaussiana.

189
00:10:26,064 --> 00:10:29,325
De esa manera, cuando multiplicamos todos estos valores por el

190
00:10:29,325 --> 00:10:31,913
píxel correspondiente sobre el que se encuentran,

191
00:10:31,913 --> 00:10:36,416
le damos mucho más peso a ese píxel central y mucho menos a los que están en el borde.

192
00:10:36,416 --> 00:10:40,430
Y al igual que antes, el píxel correspondiente a la derecha se define como esta suma.

193
00:10:40,430 --> 00:10:43,308
A medida que realizamos este proceso para cada píxel,

194
00:10:43,308 --> 00:10:47,894
se obtiene un efecto de desenfoque que simula de manera mucho más auténtica la noción

195
00:10:47,894 --> 00:10:49,760
de desenfocar la lente o algo así.

196
00:10:49,760 --> 00:10:53,527
Pero difuminar está lejos de ser lo único que se puede hacer con esta idea.

197
00:10:53,527 --> 00:10:56,603
Por ejemplo, eche un vistazo a esta pequeña cuadrícula de valores,

198
00:10:56,603 --> 00:10:59,862
que incluye algunos números positivos a la izquierda y algunos números

199
00:10:59,862 --> 00:11:03,121
negativos a la derecha, que colorearé con azul y rojo respectivamente.

200
00:11:03,121 --> 00:11:06,284
Tómate un momento para ver si puedes predecir y

201
00:11:06,284 --> 00:11:09,843
comprender qué efecto tendrá esto en la imagen final.

202
00:11:09,843 --> 00:11:14,035
Entonces, en este caso, pensaré en la imagen en escala de grises en lugar de coloreada,

203
00:11:14,035 --> 00:11:18,133
de modo que cada uno de los píxeles esté representado por un número en lugar de tres.

204
00:11:18,133 --> 00:11:20,572
Y una cosa que vale la pena señalar es que al hacer

205
00:11:20,572 --> 00:11:23,152
esta convolución es posible obtener valores negativos.

206
00:11:23,152 --> 00:11:26,375
Por ejemplo, en este punto, si hacemos zoom, la mitad izquierda de nuestra

207
00:11:26,375 --> 00:11:29,297
pequeña cuadrícula se ubica completamente sobre los píxeles negros,

208
00:11:29,297 --> 00:11:32,304
lo que tendría un valor de cero, pero la mitad derecha de los valores

209
00:11:32,304 --> 00:11:36,000
negativos se ubicará sobre los píxeles blancos, lo que tendría tiene un valor de uno.

210
00:11:36,000 --> 00:11:39,118
Entonces, cuando multiplicamos los términos correspondientes y los sumamos,

211
00:11:39,118 --> 00:11:42,441
los resultados serán muy negativos, y la forma en que muestro esto con la imagen

212
00:11:42,441 --> 00:11:46,092
de la derecha es colorear los valores negativos en rojo y los valores positivos en azul.

213
00:11:46,092 --> 00:11:50,427
Otra cosa a tener en cuenta es que cuando estás en una zona que es del mismo color,

214
00:11:50,427 --> 00:11:54,917
todo llega a cero ya que la suma de los valores en nuestra pequeña cuadrícula es cero.

215
00:11:54,917 --> 00:11:57,644
Esto es muy diferente de los dos ejemplos anteriores donde la suma

216
00:11:57,644 --> 00:12:00,046
de nuestra pequeña cuadrícula era uno, lo que nos permitió

217
00:12:00,046 --> 00:12:03,057
interpretarla como una media móvil y, por tanto, como una imagen borrosa.

218
00:12:03,057 --> 00:12:07,539
En general, este pequeño proceso básicamente detecta dónde hay variación en el

219
00:12:07,539 --> 00:12:11,113
valor del píxel a medida que te mueves de izquierda a derecha,

220
00:12:11,113 --> 00:12:15,765
por lo que te brinda una especie de forma de detectar todos los bordes verticales

221
00:12:15,765 --> 00:12:16,560
de tu imagen.

222
00:12:16,560 --> 00:12:20,972
Y de manera similar, si rotamos esa cuadrícula para que varíe a medida que te mueves de

223
00:12:20,972 --> 00:12:24,331
arriba a abajo, esto se recogerá en todos los bordes horizontales,

224
00:12:24,331 --> 00:12:28,744
lo que en el caso de nuestra imagen de la pequeña criatura de pastel resulta en algunos

225
00:12:28,744 --> 00:12:30,048
ojos bastante demoníacos.

226
00:12:30,048 --> 00:12:32,608
Por cierto, esta cuadrícula más pequeña a menudo se llama kernel,

227
00:12:32,608 --> 00:12:35,247
y la belleza aquí es cómo simplemente eligiendo un kernel diferente

228
00:12:35,247 --> 00:12:37,730
puedes obtener diferentes efectos de procesamiento de imágenes,

229
00:12:37,730 --> 00:12:40,757
no solo desenfocar la detección de bordes sino también cosas como la nitidez.

230
00:12:40,757 --> 00:12:44,897
Para aquellos de ustedes que han oído hablar de una red neuronal convolucional,

231
00:12:44,897 --> 00:12:48,313
la idea es utilizar datos para determinar cuáles deberían ser los

232
00:12:48,313 --> 00:12:51,677
núcleos en primer lugar, según lo que determine la red neuronal.

233
00:12:51,677 --> 00:12:55,421
Otra cosa que tal vez debería mencionar es la duración de la salida.

234
00:12:55,421 --> 00:12:59,227
Para algo como el ejemplo de media móvil, es posible que solo desee pensar en los

235
00:12:59,227 --> 00:13:02,290
términos cuando ambas ventanas se alinean completamente entre sí,

236
00:13:02,290 --> 00:13:06,420
o en el ejemplo de procesamiento de imágenes, tal vez desee que la salida final tenga el

237
00:13:06,420 --> 00:13:07,813
mismo tamaño que el original.

238
00:13:07,813 --> 00:13:10,584
Ahora bien, las convoluciones como operación matemática pura siempre

239
00:13:10,584 --> 00:13:13,797
producen una matriz que es más grande que las dos matrices con las que comenzó,

240
00:13:13,797 --> 00:13:16,448
al menos asumiendo que una de ellas no tiene una longitud de uno.

241
00:13:16,448 --> 00:13:18,907
Solo sepa que en ciertos contextos informáticos

242
00:13:18,907 --> 00:13:21,520
a menudo desea truncar deliberadamente esa salida.

243
00:13:21,520 --> 00:13:25,570
Otra cosa que vale la pena destacar es que en el contexto de las ciencias de la

244
00:13:25,570 --> 00:13:29,772
computación esta noción de darle la vuelta a ese núcleo antes de dejarlo avanzar a

245
00:13:29,772 --> 00:13:33,873
través del original a menudo parece realmente extraña y simplemente innecesaria,

246
00:13:33,873 --> 00:13:38,126
pero nuevamente tenga en cuenta que eso es lo que se hereda del contexto matemático

247
00:13:38,126 --> 00:13:42,582
puro donde, como nosotros Vi con las probabilidades que es algo increíblemente natural.

248
00:13:42,582 --> 00:13:45,879
Y de hecho, puedo mostrarles un ejemplo más de matemáticas puras en el

249
00:13:45,879 --> 00:13:49,222
que incluso los programadores deberían preocuparse por este porque abre

250
00:13:49,222 --> 00:13:52,426
las puertas a un algoritmo mucho más rápido para calcular todo esto.

251
00:13:52,426 --> 00:13:54,944
Para configurar lo que quiero decir con más rápido aquí,

252
00:13:54,944 --> 00:13:58,611
déjame regresar y abrir algo de Python nuevamente y crearé dos matrices diferentes

253
00:13:58,611 --> 00:13:59,627
relativamente grandes.

254
00:13:59,627 --> 00:14:03,807
Cada uno tendrá cien mil elementos aleatorios y voy a evaluar el tiempo

255
00:14:03,807 --> 00:14:07,638
de ejecución de la función de convolución de la biblioteca numpy.

256
00:14:07,638 --> 00:14:11,030
Y en este caso lo ejecuta durante múltiples iteraciones diferentes,

257
00:14:11,030 --> 00:14:15,521
intenta encontrar un promedio y parece que en esta computadora al menos tiene un promedio

258
00:14:15,521 --> 00:14:16,419
de 4.87 segundos.

259
00:14:16,419 --> 00:14:21,119
Por el contrario, si uso una función diferente de la biblioteca scipy llamada

260
00:14:21,119 --> 00:14:25,216
fftconvolve, que es lo mismo pero implementado de manera diferente,

261
00:14:25,216 --> 00:14:30,640
solo toma 4.3 milisegundos en promedio, es decir, una mejora de tres órdenes de magnitud.

262
00:14:30,640 --> 00:14:32,732
Y nuevamente, aunque tiene un nombre diferente,

263
00:14:32,732 --> 00:14:35,610
está dando el mismo resultado que la otra función de convolución,

264
00:14:35,610 --> 00:14:38,880
simplemente está haciendo algo para hacerlo de una manera más inteligente.

265
00:14:38,880 --> 00:14:43,553
Recuerde que en el ejemplo de probabilidad dije que otra forma de pensar

266
00:14:43,553 --> 00:14:48,163
en la convolución era crear esta tabla de todos los productos por pares

267
00:14:48,163 --> 00:14:52,581
y luego sumar esos productos por pares a lo largo de las diagonales.

268
00:14:52,581 --> 00:14:55,241
Por supuesto, no hay nada específico sobre la probabilidad.

269
00:14:55,241 --> 00:14:57,946
Cada vez que convolucionas dos listas diferentes de números,

270
00:14:57,946 --> 00:14:59,365
puedes pensarlo de esta manera.

271
00:14:59,365 --> 00:15:02,906
Crea este tipo de tabla de multiplicar con todos los productos por pares y luego

272
00:15:02,906 --> 00:15:06,447
cada suma a lo largo de la diagonal corresponde a uno de tus resultados finales.

273
00:15:06,447 --> 00:15:09,665
Un contexto en el que esta visión resulta especialmente

274
00:15:09,665 --> 00:15:12,481
natural es cuando se multiplican dos polinomios.

275
00:15:12,481 --> 00:15:16,015
Por ejemplo, permítanme tomar la pequeña cuadrícula que ya

276
00:15:16,015 --> 00:15:19,129
tenemos y reemplazar los términos superiores con 1,

277
00:15:19,129 --> 00:15:23,920
2x y 3x al cuadrado y reemplazar los otros términos con 4, 5x y 6x al cuadrado.

278
00:15:23,920 --> 00:15:26,235
Ahora piense en lo que significa cuando creamos todos

279
00:15:26,235 --> 00:15:28,721
estos productos diferentes en pares entre las dos listas.

280
00:15:28,721 --> 00:15:32,796
Lo que estás haciendo es esencialmente expandir el producto completo de los dos

281
00:15:32,796 --> 00:15:37,379
polinomios que he escrito y luego, cuando sumas a lo largo de la diagonal que corresponde

282
00:15:37,379 --> 00:15:40,995
a recolectar todos los términos semejantes, lo cual es bastante bueno,

283
00:15:40,995 --> 00:15:45,070
expandir un polinomio y recolectar términos semejantes es exactamente lo mismo.

284
00:15:45,070 --> 00:15:47,005
El mismo proceso que una convolución.

285
00:15:47,005 --> 00:15:52,627
Pero esto nos permite hacer algo muy bueno porque piensen en lo que estamos diciendo aquí.

286
00:15:52,627 --> 00:15:52,690


287
00:15:52,690 --> 00:15:56,642
Estamos diciendo que si tomas dos funciones diferentes y las multiplicas,

288
00:15:56,642 --> 00:16:00,541
que es una operación puntual simple, es lo mismo que si primero hubieras

289
00:16:00,541 --> 00:16:04,708
extraído los coeficientes de cada una de ellas, asumiendo que son polinomios,

290
00:16:04,708 --> 00:16:08,820
y luego hubieras tomado una convolución de esas. dos listas de coeficientes.

291
00:16:08,820 --> 00:16:13,158
Lo que hace que esto sea tan interesante es que las convoluciones parecen, en principio,

292
00:16:13,158 --> 00:16:17,496
mucho más complicadas que una simple multiplicación y no me refiero sólo conceptualmente

293
00:16:17,496 --> 00:16:21,737
a que son más difíciles de pensar, sino que computacionalmente requiere más pasos para

294
00:16:21,737 --> 00:16:26,124
realizar una convolución que para realizar una Producto puntual de dos listas diferentes.

295
00:16:26,124 --> 00:16:29,347
Por ejemplo, digamos que te di dos polinomios realmente grandes,

296
00:16:29,347 --> 00:16:32,373
digamos cada uno con cien coeficientes diferentes, entonces,

297
00:16:32,373 --> 00:16:36,092
si la forma en que los multiplicas fuera expandir este producto, ya sabes,

298
00:16:36,092 --> 00:16:40,010
completando esta cuadrícula completa de 100 por 100 de productos por pares que

299
00:16:40,010 --> 00:16:43,036
requerirían que realice 10.000 productos diferentes y luego,

300
00:16:43,036 --> 00:16:46,805
cuando recopile todos los términos semejantes a lo largo de las diagonales,

301
00:16:46,805 --> 00:16:49,731
ese será otro conjunto de alrededor de 10.000 operaciones.

302
00:16:49,731 --> 00:16:54,087
De manera más general, en la jerga diríamos que el algoritmo es O de n al cuadrado,

303
00:16:54,087 --> 00:16:57,613
lo que significa que para dos listas de tamaño n la forma en que el

304
00:16:57,613 --> 00:17:00,880
número de operaciones escala es proporcional al cuadrado de n.

305
00:17:00,880 --> 00:17:05,710
Por otro lado, si pienso en dos polinomios en términos de sus salidas, por ejemplo,

306
00:17:05,710 --> 00:17:08,585
muestreando sus valores en un puñado de entradas,

307
00:17:08,585 --> 00:17:12,956
multiplicarlos solo requiere tantas operaciones como el número de muestras,

308
00:17:12,956 --> 00:17:17,844
ya que nuevamente es una operación puntual y con polinomios solo necesitas un número

309
00:17:17,844 --> 00:17:21,179
finito de muestras para poder recuperar los coeficientes.

310
00:17:21,152 --> 00:17:23,161
Por ejemplo, dos salidas son suficientes para

311
00:17:23,161 --> 00:17:25,214
especificar de forma única un polinomio lineal.

312
00:17:25,214 --> 00:17:27,583
Tres resultados serían suficientes para especificar

313
00:17:27,583 --> 00:17:29,360
de forma única un polinomio cuadrático.

314
00:17:29,360 --> 00:17:32,948
Y, en general, si conoce n salidas distintas, eso es suficiente para

315
00:17:32,948 --> 00:17:36,901
especificar de forma única un polinomio que tiene n coeficientes diferentes.

316
00:17:36,901 --> 00:17:41,188
O si lo prefieres, podríamos expresarlo en el lenguaje de los sistemas de ecuaciones.

317
00:17:41,188 --> 00:17:45,168
Imagina que te digo que tengo un polinomio pero no te digo cuáles son los coeficientes,

318
00:17:45,168 --> 00:17:46,480
esos son un misterio para ti.

319
00:17:46,480 --> 00:17:48,573
En nuestro ejemplo, podría pensar que esto es

320
00:17:48,573 --> 00:17:50,666
el producto que estamos tratando de descubrir.

321
00:17:50,666 --> 00:17:54,943
Entonces supongamos que digo que simplemente le diré cuáles serían las salidas de este

322
00:17:54,943 --> 00:17:59,269
polinomio si ingresara varias entradas diferentes como 0, 1, 2, 3, y así sucesivamente,

323
00:17:59,269 --> 00:18:02,906
y le doy lo suficiente para que tenga tantas ecuaciones como sea posible.

324
00:18:02,906 --> 00:18:03,791
tienes incógnitas.

325
00:18:03,791 --> 00:18:07,245
Incluso resulta ser un sistema lineal de ecuaciones, así que está bien.

326
00:18:07,245 --> 00:18:11,137
Y al menos en principio, esto debería ser suficiente para recuperar los coeficientes.

327
00:18:11,137 --> 00:18:15,318
Entonces, el esquema aproximado del algoritmo sería que cuando quieras convolucionar

328
00:18:15,318 --> 00:18:19,253
dos listas de números, los trates como si fueran coeficientes de dos polinomios.

329
00:18:19,253 --> 00:18:22,697
Se toman muestras de esos polinomios con suficientes salidas,

330
00:18:22,697 --> 00:18:26,753
se multiplican esas muestras puntualmente y luego se resuelve el sistema

331
00:18:26,753 --> 00:18:31,364
para recuperar los coeficientes como una forma furtiva de encontrar la convolución.

332
00:18:31,364 --> 00:18:35,594
Y como lo he dicho al menos hasta ahora, algunos de ustedes podrían quejarse con razón:

333
00:18:35,594 --> 00:18:37,564
&quot;Grant, ese es un plan idiota&quot;.

334
00:18:37,564 --> 00:18:41,388
Porque, por un lado, simplemente calcular todas estas muestras para uno de

335
00:18:41,388 --> 00:18:45,467
los polinomios que conocemos ya requiere el orden de n operaciones al cuadrado,

336
00:18:45,467 --> 00:18:49,291
sin mencionar que resolver ese sistema ciertamente será computacionalmente

337
00:18:49,291 --> 00:18:52,656
tan difícil como simplemente hacer la convolución en primer lugar.

338
00:18:52,656 --> 00:18:57,102
Entonces, seguro que tenemos esta conexión entre multiplicación y convoluciones,

339
00:18:57,102 --> 00:19:01,054
pero toda la complejidad ocurre al traducir de un punto de vista a otro.

340
00:19:01,054 --> 00:19:04,535
Pero hay un truco, y aquellos de ustedes que conocen las transformadas

341
00:19:04,535 --> 00:19:07,673
de Fourier y el algoritmo FFT podrían ver hacia dónde se dirige.

342
00:19:07,673 --> 00:19:09,880
Si no está familiarizado con estos temas, lo que

343
00:19:09,880 --> 00:19:12,176
voy a decir puede parecer completamente inesperado.

344
00:19:12,176 --> 00:19:15,045
Sólo debes saber que hay ciertos caminos que podrías haber recorrido

345
00:19:15,045 --> 00:19:17,582
en matemáticas y que hacen que este sea un paso más esperado.

346
00:19:17,582 --> 00:19:20,697
Básicamente la idea es que aquí tenemos libertad de elección.

347
00:19:20,697 --> 00:19:25,220
Si en lugar de evaluar en algún conjunto arbitrario de entradas como 0, 1, 2, 3,

348
00:19:25,220 --> 00:19:30,080
etc., elige evaluar en un conjunto de números complejos muy especialmente seleccionado.

349
00:19:30,080 --> 00:19:33,229
Específicamente los que se encuentran espaciados uniformemente en el círculo unitario,

350
00:19:33,229 --> 00:19:34,894
lo que se conoce como las raíces de la unidad.

351
00:19:34,894 --> 00:19:37,364
Esto nos da un sistema más amigable.

352
00:19:37,364 --> 00:19:41,822
La idea básica es que al encontrar un número en el que la toma de sus potencias

353
00:19:41,822 --> 00:19:46,392
caiga en este patrón cíclico, significa que el sistema que generamos tendrá mucha

354
00:19:46,392 --> 00:19:49,902
redundancia en los diferentes términos que estamos calculando,

355
00:19:49,902 --> 00:19:53,580
y al ser inteligente acerca de cómo Si aprovecha esa redundancia,

356
00:19:53,580 --> 00:19:55,252
puede ahorrarse mucho trabajo.

357
00:19:55,252 --> 00:19:58,894
Este conjunto de resultados que he escrito tiene un nombre especial,

358
00:19:58,894 --> 00:20:02,166
se llama transformada discreta de Fourier de los coeficientes.

359
00:20:02,166 --> 00:20:05,608
Y si quieres aprender más, de hecho di otra conferencia para esa

360
00:20:05,608 --> 00:20:09,103
misma clase de Julia MIT sobre transformadas discretas de Fourier.

361
00:20:09,103 --> 00:20:13,159
Y también hay un video realmente excelente en el canal reducible que habla sobre la

362
00:20:13,159 --> 00:20:17,263
transformada rápida de Fourier, que es un algoritmo para calcularlos más rápidamente.

363
00:20:17,263 --> 00:20:20,498
Además, Veritasium hizo recientemente un video realmente bueno sobre FFT,

364
00:20:20,498 --> 00:20:21,984
por lo que tienes muchas opciones.

365
00:20:21,984 --> 00:20:24,786
Y ese algoritmo rápido realmente es el punto para nosotros.

366
00:20:24,786 --> 00:20:28,401
Nuevamente, debido a toda esta redundancia, existe un método para pasar de los

367
00:20:28,401 --> 00:20:32,016
coeficientes a todas estas salidas, donde en lugar de realizar operaciones del

368
00:20:32,016 --> 00:20:35,998
orden de n al cuadrado, se realizan del orden de n veces el registro de n operaciones,

369
00:20:35,998 --> 00:20:39,293
lo cual es mucho más. mucho mejor a medida que escalas a listas grandes.

370
00:20:39,293 --> 00:20:42,386
Y lo más importante es que este algoritmo fft funciona en ambos sentidos.

371
00:20:42,386 --> 00:20:45,515
También te permite pasar de las salidas a los coeficientes.

372
00:20:45,515 --> 00:20:49,054
Entonces, juntándolo todo, volvamos a ver el esquema de nuestro algoritmo.

373
00:20:49,054 --> 00:20:53,326
Ahora podemos decir que siempre que tengas dos listas largas de números y quieras

374
00:20:53,326 --> 00:20:57,702
tomar su convolución, primero calcula la transformada rápida de Fourier de cada uno

375
00:20:57,702 --> 00:21:02,286
de ellos, lo que en el fondo puedes considerar como tratarlos como son los coeficientes

376
00:21:02,286 --> 00:21:06,766
de un polinomio y se evalúan en un conjunto de puntos muy especialmente seleccionados.

377
00:21:06,766 --> 00:21:10,273
Luego multiplique los dos resultados que acaba de obtener puntualmente,

378
00:21:10,273 --> 00:21:14,365
lo cual es bueno y rápido, y luego haga una transformada rápida inversa de Fourier,

379
00:21:14,365 --> 00:21:18,408
y lo que eso le dará es la manera furtiva de calcular la convolución que estábamos

380
00:21:18,408 --> 00:21:18,847
buscando.

381
00:21:18,847 --> 00:21:22,957
Pero esta vez solo involucra O de n log n operaciones.

382
00:21:22,957 --> 00:21:24,865
¡Eso es realmente genial para mí!

383
00:21:24,865 --> 00:21:29,077
Este contexto tan específico donde aparecen convoluciones al multiplicar dos polinomios,

384
00:21:29,077 --> 00:21:32,248
abre las puertas a un algoritmo que es relevante en cualquier otro

385
00:21:32,248 --> 00:21:34,235
lugar donde puedan aparecer convoluciones.

386
00:21:34,235 --> 00:21:36,317
Si desea agregar distribuciones de probabilidad,

387
00:21:36,317 --> 00:21:38,822
realice un procesamiento de imágenes grandes, sea cual sea.

388
00:21:38,822 --> 00:21:43,496
Y creo que es un buen ejemplo de por qué debería emocionarse cuando ve alguna operación

389
00:21:43,496 --> 00:21:47,798
o concepto en matemáticas aparecer en muchas áreas aparentemente no relacionadas.

390
00:21:47,798 --> 00:21:51,967
Si quieres un poco de tarea, aquí tienes algo en lo que es divertido pensar.

391
00:21:51,967 --> 00:21:54,488
Explica por qué cuando multiplicas dos números diferentes,

392
00:21:54,488 --> 00:21:58,206
simplemente una multiplicación ordinaria como todos aprendemos en la escuela primaria,

393
00:21:58,206 --> 00:22:01,924
lo que estás haciendo es básicamente una convolución entre los dígitos de esos números.

394
00:22:01,924 --> 00:22:04,702
Hay algunos pasos adicionales con acarreos y similares,

395
00:22:04,702 --> 00:22:06,785
pero el paso principal es una convolución.

396
00:22:06,785 --> 00:22:09,142
A la luz de la existencia de un algoritmo rápido,

397
00:22:09,142 --> 00:22:12,489
lo que eso significa es que si tienes dos números enteros muy grandes,

398
00:22:12,489 --> 00:22:16,449
entonces existe una manera de encontrar su producto que es más rápida que el método

399
00:22:16,449 --> 00:22:18,240
que aprendemos en la escuela primaria.

400
00:22:18,240 --> 00:22:22,660
Que en lugar de requerir O de n operaciones al cuadrado solo requiere O de n log n,

401
00:22:22,660 --> 00:22:25,291
lo que ni siquiera parece que debería ser posible.

402
00:22:25,291 --> 00:22:28,686
El problema es que antes de que esto sea realmente útil en la práctica,

403
00:22:28,686 --> 00:22:31,280
sus números tendrían que ser absolutamente monstruosos.

404
00:22:31,280 --> 00:22:34,445
Pero aun así, es genial que exista un algoritmo así.

405
00:22:34,445 --> 00:22:37,312
A continuación centraremos nuestra atención en el caso continuo

406
00:22:37,312 --> 00:22:40,000
con especial atención en las distribuciones de probabilidad.


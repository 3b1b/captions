1
00:00:00,000 --> 00:00:02,313
Supongamos que le doy dos listas diferentes de números, 

2
00:00:02,313 --> 00:00:05,040
o tal vez dos funciones diferentes, y le pido que piense en todas 

3
00:00:05,040 --> 00:00:07,808
las formas en que podría combinar esas dos listas para obtener una 

4
00:00:07,808 --> 00:00:11,320
nueva lista de números, o combinar las dos funciones para obtener una nueva función. 

5
00:00:12,120 --> 00:00:14,440
. Quizás una forma sencilla que se nos ocurra 

6
00:00:14,440 --> 00:00:16,760
sea simplemente sumarlos término por término. 

7
00:00:17,160 --> 00:00:19,920
Así mismo con las funciones, puedes agregar todas las salidas correspondientes. 

8
00:00:20,540 --> 00:00:23,219
De manera similar, también puedes multiplicar las dos listas 

9
00:00:23,219 --> 00:00:25,680
término por término y hacer lo mismo con las funciones. 

10
00:00:26,360 --> 00:00:30,143
Pero hay otro tipo de combinación tan fundamental como ambas, 

11
00:00:30,143 --> 00:00:33,500
pero mucho menos discutida, conocida como convolución. 

12
00:00:34,080 --> 00:00:36,139
Pero a diferencia de los dos casos anteriores, 

13
00:00:36,139 --> 00:00:39,820
no es algo que simplemente se hereda de una operación que puedes hacer con números. 

14
00:00:39,980 --> 00:00:44,700
Es algo realmente nuevo para el contexto de listas de números o combinación de funciones. 

15
00:00:45,320 --> 00:00:48,979
Aparecen por todas partes, son omnipresentes en el procesamiento de imágenes, 

16
00:00:48,979 --> 00:00:51,841
es una construcción central en la teoría de la probabilidad, 

17
00:00:51,841 --> 00:00:55,595
se usan mucho para resolver ecuaciones diferenciales y es un contexto en el que 

18
00:00:55,595 --> 00:00:58,363
es casi seguro que lo hayas visto, si no. con este nombre, 

19
00:00:58,363 --> 00:01:00,240
es multiplicar dos polinomios entre sí. 

20
00:01:00,740 --> 00:01:03,661
Como alguien en el negocio de las explicaciones visuales, 

21
00:01:03,661 --> 00:01:07,792
este es un tema especialmente bueno, porque la definición formulada aislada y sin 

22
00:01:07,792 --> 00:01:12,224
contexto puede parecer un poco intimidante, pero si nos tomamos el tiempo para analizar 

23
00:01:12,224 --> 00:01:16,254
realmente lo que dice, y antes de eso, motivar por qué querrías algo como esto, 

24
00:01:16,254 --> 00:01:18,320
es una operación increíblemente hermosa. 

25
00:01:18,960 --> 00:01:21,250
Y tengo que admitir que en realidad aprendí algo 

26
00:01:21,250 --> 00:01:23,540
mientras armaba las imágenes para este proyecto. 

27
00:01:23,540 --> 00:01:25,825
En el caso de convolucionar dos funciones diferentes, 

28
00:01:25,825 --> 00:01:29,506
estaba tratando de pensar en diferentes formas en las que podría imaginarse lo que eso 

29
00:01:29,506 --> 00:01:33,188
podría significar, y con una de ellas tuve un pequeño momento de ajá sobre por qué las 

30
00:01:33,188 --> 00:01:36,361
distribuciones normales desempeñan el papel que lo hacen con probabilidad, 

31
00:01:36,361 --> 00:01:38,520
por qué es una forma tan natural para una función. 

32
00:01:39,020 --> 00:01:41,520
Pero me estoy adelantando, hay mucha preparación para eso. 

33
00:01:41,840 --> 00:01:46,102
En este video, nuestro enfoque principal será el caso discreto y, en particular, 

34
00:01:46,102 --> 00:01:50,260
desarrollar un algoritmo muy inesperado pero muy inteligente para calcularlos. 

35
00:01:50,260 --> 00:01:54,480
Y llevaré la discusión del caso continuo a una segunda parte. 

36
00:01:58,580 --> 00:02:01,815
Es muy tentador comenzar con los ejemplos de procesamiento de imágenes, 

37
00:02:01,815 --> 00:02:05,680
ya que son visualmente los más intrigantes, pero hay un par de detalles que hacen que 

38
00:02:05,680 --> 00:02:09,545
el caso de procesamiento de imágenes sea menos representativo de las convoluciones en 

39
00:02:09,545 --> 00:02:11,747
general, así que comencemos con la probabilidad. 

40
00:02:11,747 --> 00:02:15,612
y en particular uno de los ejemplos más simples en el que estoy seguro todos aquí han 

41
00:02:15,612 --> 00:02:19,252
pensado en algún momento de su vida, que es tirar un par de dados y calcular las 

42
00:02:19,252 --> 00:02:21,500
posibilidades de obtener varias sumas diferentes. 

43
00:02:22,460 --> 00:02:24,460
Y se podría decir, no es un problema, no es un problema. 

44
00:02:24,680 --> 00:02:28,154
Cada uno de tus dos dados tiene seis resultados posibles diferentes, 

45
00:02:28,154 --> 00:02:31,629
lo que nos da un total de 36 pares de resultados posibles distintos, 

46
00:02:31,629 --> 00:02:35,860
y si los analizamos todos podemos contar cuántos pares tienen una suma determinada. 

47
00:02:36,600 --> 00:02:39,251
Y al organizar todos los pares en una cuadrícula como esta, 

48
00:02:39,251 --> 00:02:42,213
una cosa bastante buena es que todos los pares que tienen una suma 

49
00:02:42,213 --> 00:02:45,440
constante son visibles a lo largo de una de estas diagonales diferentes. 

50
00:02:45,440 --> 00:02:48,632
Entonces, simplemente contar cuántos existen en cada una de esas 

51
00:02:48,632 --> 00:02:52,120
diagonales le indicará la probabilidad de que vea una suma particular. 

52
00:02:53,220 --> 00:02:55,913
Y yo diría, muy bien, muy bien, pero ¿se te ocurre 

53
00:02:55,913 --> 00:02:58,660
alguna otra manera de visualizar la misma pregunta? 

54
00:02:59,300 --> 00:03:01,719
¿Otras imágenes que te pueden venir a la cabeza al pensar en 

55
00:03:01,719 --> 00:03:04,060
todos los distintos pares que tienen una suma determinada? 

56
00:03:04,860 --> 00:03:07,980
Y tal vez uno de ustedes levante la mano y diga: sí, tengo uno. 

57
00:03:08,280 --> 00:03:11,164
Digamos que imaginas estos dos conjuntos diferentes de posibilidades, 

58
00:03:11,164 --> 00:03:13,760
cada uno en una fila, pero le das la vuelta a la segunda fila. 

59
00:03:13,760 --> 00:03:18,760
De esa manera, todos los diferentes pares que suman siete se alinean verticalmente así. 

60
00:03:19,360 --> 00:03:22,261
Y si deslizamos la fila inferior completamente hacia la derecha, 

61
00:03:22,261 --> 00:03:26,280
entonces el par único que suma dos, los ojos de serpiente, son los únicos que se alinean. 

62
00:03:26,620 --> 00:03:28,841
Y si lo distribuyo una unidad hacia la derecha, 

63
00:03:28,841 --> 00:03:32,080
los pares que se alinean son los dos pares diferentes que suman tres. 

64
00:03:32,880 --> 00:03:36,320
Y, en general, los diferentes valores de compensación de esta matriz inferior, 

65
00:03:36,320 --> 00:03:38,541
que recuerdo que tuve que darle la vuelta primero, 

66
00:03:38,541 --> 00:03:41,460
revelan todos los pares distintos que tienen una suma determinada. 

67
00:03:44,820 --> 00:03:46,843
En lo que respecta a las preguntas de probabilidad, 

68
00:03:46,843 --> 00:03:49,410
esto todavía no es especialmente interesante, porque lo único que 

69
00:03:49,410 --> 00:03:52,640
estamos haciendo es contar cuántos resultados hay en cada una de estas categorías. 

70
00:03:52,980 --> 00:03:55,641
Pero eso es con el supuesto implícito de que hay la misma 

71
00:03:55,641 --> 00:03:58,120
probabilidad de que aparezca cada una de estas caras. 

72
00:03:58,360 --> 00:04:01,620
Pero ¿y si te dijera que tengo un juego de dados especial que no es uniforme? 

73
00:04:02,060 --> 00:04:04,598
Tal vez el dado azul tenga su propio conjunto de números que 

74
00:04:04,598 --> 00:04:06,804
describen las probabilidades de que salga cada cara, 

75
00:04:06,804 --> 00:04:09,760
y el dado rojo tenga su propio conjunto de números distintivo y único. 

76
00:04:10,299 --> 00:04:13,923
En ese caso, si quisieras calcular, digamos, la probabilidad de ver un dos, 

77
00:04:13,923 --> 00:04:16,880
multiplicarías la probabilidad de que el dado azul sea un uno 

78
00:04:16,880 --> 00:04:19,360
por la probabilidad de que el dado rojo sea un uno. 

79
00:04:19,360 --> 00:04:21,913
Y para conocer las posibilidades de ver un tres, 

80
00:04:21,913 --> 00:04:25,406
observas los dos pares distintos cuando sea posible y, nuevamente, 

81
00:04:25,406 --> 00:04:29,680
multiplicas las probabilidades correspondientes y luego sumas esos dos productos. 

82
00:04:30,100 --> 00:04:33,307
De manera similar, las posibilidades de ver un cuatro implican 

83
00:04:33,307 --> 00:04:36,820
multiplicar tres pares diferentes de posibilidades y sumarlos todos. 

84
00:04:36,820 --> 00:04:39,627
Y con el ánimo de establecer algunas fórmulas, 

85
00:04:39,627 --> 00:04:43,271
llamemos a estas probabilidades superiores a1, a2, a3, etc., 

86
00:04:43,271 --> 00:04:45,960
y llamemos a las inferiores b1, b2, b3, etc. 

87
00:04:46,400 --> 00:04:50,354
Y en general, este proceso, en el que tomamos dos conjuntos diferentes de números, 

88
00:04:50,354 --> 00:04:54,594
volteamos el segundo y luego los alineamos en varios valores de compensación diferentes, 

89
00:04:54,594 --> 00:04:57,262
tomamos un montón de productos por pares y los sumamos, 

90
00:04:57,262 --> 00:05:00,740
ese es uno de los Formas fundamentales de pensar qué es una convolución. 

91
00:05:00,740 --> 00:05:06,038
Entonces, para explicarlo un poco más exactamente, a través de este proceso, 

92
00:05:06,038 --> 00:05:11,474
simplemente generamos probabilidades de ver dos, tres, cuatro, y así hasta 12, 

93
00:05:11,474 --> 00:05:16,980
y las obtuvimos mezclando una lista de valores, a, y otra. lista de valores, b. 

94
00:05:17,440 --> 00:05:20,774
En la jerga, diríamos que la convolución de esas dos secuencias 

95
00:05:20,774 --> 00:05:24,057
nos da esta nueva secuencia, la nueva secuencia de 11 valores, 

96
00:05:24,057 --> 00:05:27,340
cada uno de los cuales parece una suma de productos por pares. 

97
00:05:27,340 --> 00:05:32,037
Si lo prefieres, otra forma de pensar en la misma operación es crear primero 

98
00:05:32,037 --> 00:05:36,980
una tabla de todos los productos por pares y luego sumar todas estas diagonales. 

99
00:05:37,460 --> 00:05:40,154
Nuevamente, esa es una forma de mezclar estas dos secuencias 

100
00:05:40,154 --> 00:05:42,760
de números para obtener una nueva secuencia de 11 números. 

101
00:05:43,240 --> 00:05:45,375
Es el mismo funcionamiento que pensaban las ventanas correderas, 

102
00:05:45,375 --> 00:05:46,460
sólo que desde otra perspectiva. 

103
00:05:47,140 --> 00:05:49,800
Poniéndole una pequeña notación, así es como podría verlo escrito. 

104
00:05:50,220 --> 00:05:55,060
La convolución de a y b, indicada con este pequeño asterisco, es una nueva lista, 

105
00:05:55,060 --> 00:05:58,130
y el enésimo elemento de esa lista parece una suma, 

106
00:05:58,130 --> 00:06:01,908
y esa suma abarca todos los diferentes pares de índices, i y j, 

107
00:06:01,908 --> 00:06:04,860
de modo que la suma de esos índices es igual a n. 

108
00:06:05,280 --> 00:06:08,786
Es un poco complicado, pero por ejemplo, si n fuera 6, 

109
00:06:08,786 --> 00:06:12,930
los pares que repasaremos son 1 y 5, 2 y 4, 3 y 3, 4 y 2, 5 y 1, 

110
00:06:12,930 --> 00:06:15,800
todos los pares diferentes que se suman a 6. 

111
00:06:16,620 --> 00:06:18,592
Pero, sinceramente, independientemente de cómo lo escribas, 

112
00:06:18,592 --> 00:06:21,452
la notación tiene una importancia secundaria frente a la imagen que puedas tener en tu 

113
00:06:21,452 --> 00:06:22,340
cabeza durante el proceso. 

114
00:06:23,280 --> 00:06:26,073
Aquí, tal vez sea útil hacer un ejemplo súper simple, 

115
00:06:26,073 --> 00:06:29,642
donde podría preguntarte cuál es la convolución de la lista 1, 2, 3, 

116
00:06:29,642 --> 00:06:30,780
con la lista 4, 5, 6. 

117
00:06:31,480 --> 00:06:34,698
Podrías imaginarte tomar ambas listas, darle la vuelta a la segunda 

118
00:06:34,698 --> 00:06:37,680
y luego comenzar con la tapa completamente hacia la izquierda. 

119
00:06:38,180 --> 00:06:40,384
Luego, el par de valores que se alinean son 1 y 4, 

120
00:06:40,384 --> 00:06:43,540
los multiplicamos y eso nos da nuestro primer término de nuestra salida. 

121
00:06:43,960 --> 00:06:47,054
Deslice la matriz inferior una unidad hacia la derecha, 

122
00:06:47,054 --> 00:06:50,867
los pares que se alinean son 1 y 5, y 2 y 4, multiplique esos pares, 

123
00:06:50,867 --> 00:06:54,460
súmelos y eso nos da 13, la siguiente entrada en nuestra salida. 

124
00:06:54,960 --> 00:06:58,326
Desliza las cosas una vez más y tomaremos 1 por 6, 

125
00:06:58,326 --> 00:07:01,560
más 2 por 5, más 3 por 4, lo que resulta ser 28. 

126
00:07:02,020 --> 00:07:05,547
Una diapositiva más y obtenemos 2 por 6, más 3 por 5, 

127
00:07:05,547 --> 00:07:10,120
y eso nos da 27, y finalmente el último término se verá como 3 por 6. 

128
00:07:10,660 --> 00:07:13,320
Si lo desea, puede consultar cualquiera que sea su lenguaje de 

129
00:07:13,320 --> 00:07:17,079
programación favorito y su biblioteca favorita que incluya varias operaciones numéricas, 

130
00:07:17,079 --> 00:07:18,980
y podrá confirmar que no le estoy mintiendo. 

131
00:07:18,980 --> 00:07:21,730
Si tomas la convolución de 1, 2, 3 contra 4, 5, 

132
00:07:21,730 --> 00:07:24,480
6, este es de hecho el resultado que obtendrás. 

133
00:07:25,920 --> 00:07:29,463
Hemos visto un caso en el que se trata de una operación natural y deseable, 

134
00:07:29,463 --> 00:07:33,660
que se suma a distribuciones de probabilidad, y otro ejemplo común sería una media móvil. 

135
00:07:34,080 --> 00:07:36,779
Imagina que tienes una lista larga de números y 

136
00:07:36,779 --> 00:07:39,760
tomas otra lista más pequeña de números que suman 1. 

137
00:07:40,100 --> 00:07:44,060
En este caso, solo tengo una pequeña lista de 5 valores y todos son iguales a 15. 

138
00:07:44,060 --> 00:07:47,168
Luego, si hacemos este proceso de convolución de ventana deslizante, 

139
00:07:47,168 --> 00:07:50,816
cerramos los ojos y escondemos debajo de la alfombra lo que sucede al principio, 

140
00:07:50,816 --> 00:07:54,510
una vez que nuestra lista más pequeña de valores se superpone por completo con la 

141
00:07:54,510 --> 00:07:58,114
más grande, piense en lo que significa cada término en este realmente significa 

142
00:07:58,114 --> 00:07:58,700
convolución. 

143
00:07:59,400 --> 00:08:03,032
En cada iteración, lo que estás haciendo es multiplicar cada uno 

144
00:08:03,032 --> 00:08:06,552
de los valores de tus datos por 15 y sumarlos todos, es decir, 

145
00:08:06,552 --> 00:08:10,520
estás tomando un promedio de tus datos dentro de esta pequeña ventana. 

146
00:08:11,100 --> 00:08:14,731
En general, el proceso le brinda una versión suavizada de los datos originales, 

147
00:08:14,731 --> 00:08:18,135
y puede modificarla comenzando con una pequeña lista diferente de números, 

148
00:08:18,135 --> 00:08:22,220
y mientras esa pequeña lista sume 1, aún puede interpretarla como una lista en movimiento.

149
00:08:22,220 --> 00:08:22,720
 promedio. 

150
00:08:23,400 --> 00:08:27,760
En el ejemplo que se muestra aquí, esa media móvil daría más peso al valor central. 

151
00:08:28,420 --> 00:08:30,800
Esto también da como resultado una versión suavizada de los datos. 

152
00:08:33,140 --> 00:08:35,562
Si haces una especie de analogía bidimensional de esto, 

153
00:08:35,562 --> 00:08:38,720
obtendrás un algoritmo divertido para desenfocar una imagen determinada. 

154
00:08:38,720 --> 00:08:41,787
Y debo decir que las animaciones que estoy a punto de mostrar están 

155
00:08:41,787 --> 00:08:44,809
modificadas de algo que hice originalmente para parte de una serie 

156
00:08:44,809 --> 00:08:47,877
de conferencias que di con el Julia Lab en el MIT para cierta clase 

157
00:08:47,877 --> 00:08:51,080
de OpenCourseWare que incluía una unidad de procesamiento de imágenes. 

158
00:08:51,560 --> 00:08:54,277
Allí hicimos un poco más para profundizar en el código detrás de todo esto, 

159
00:08:54,277 --> 00:08:56,280
así que si tienes curiosidad te dejaré algunos enlaces. 

160
00:08:56,620 --> 00:08:59,075
Pero volviendo a centrarnos en este ejemplo borroso, 

161
00:08:59,075 --> 00:09:02,363
lo que está pasando es que tengo esta pequeña cuadrícula de valores de 

162
00:09:02,363 --> 00:09:05,791
3x3 que avanza a lo largo de nuestra imagen original, y si nos acercamos, 

163
00:09:05,791 --> 00:09:09,219
cada uno de esos valores es 19, y lo que estoy haciendo en cada iteración 

164
00:09:09,219 --> 00:09:12,647
se multiplica cada uno de esos valores por el píxel correspondiente sobre 

165
00:09:12,647 --> 00:09:13,620
el que se encuentra. 

166
00:09:13,900 --> 00:09:16,879
Y, por supuesto, en informática pensamos en los colores como pequeños 

167
00:09:16,879 --> 00:09:20,200
vectores de tres valores, que representan los componentes rojo, verde y azul. 

168
00:09:20,560 --> 00:09:24,053
Cuando multiplico todos estos pequeños valores por 19 y los sumo, 

169
00:09:24,053 --> 00:09:27,071
obtenemos un promedio a lo largo de cada canal de color, 

170
00:09:27,071 --> 00:09:31,200
y el píxel correspondiente a la imagen de la derecha se define como esa suma. 

171
00:09:31,940 --> 00:09:35,285
El efecto general, al hacer esto para cada píxel de la imagen, 

172
00:09:35,285 --> 00:09:37,939
es que cada uno se fusiona con todos sus vecinos, 

173
00:09:37,939 --> 00:09:40,860
lo que nos da una versión más borrosa que la original. 

174
00:09:41,720 --> 00:09:44,774
En la jerga diríamos que la imagen de la derecha es una convolución 

175
00:09:44,774 --> 00:09:47,740
de nuestra imagen original con una pequeña cuadrícula de valores. 

176
00:09:48,140 --> 00:09:51,246
O más técnicamente tal vez debería decir que es la convolución con 

177
00:09:51,246 --> 00:09:54,400
una versión girada 180 grados de esa pequeña cuadrícula de valores. 

178
00:09:54,620 --> 00:09:57,099
No es que importe cuando la cuadrícula es simétrica, 

179
00:09:57,099 --> 00:10:00,280
pero vale la pena tener en cuenta que la definición de convolución, 

180
00:10:00,280 --> 00:10:03,742
heredada del contexto matemático puro, siempre debería invitarte a pensar 

181
00:10:03,742 --> 00:10:05,240
en invertir esa segunda matriz. 

182
00:10:05,960 --> 00:10:08,676
Si modificamos esto ligeramente podemos conseguir un efecto de desenfoque 

183
00:10:08,676 --> 00:10:11,100
mucho más elegante eligiendo una cuadrícula de valores diferente. 

184
00:10:11,440 --> 00:10:13,798
En este caso tengo una pequeña cuadrícula de 5x5, 

185
00:10:13,798 --> 00:10:15,780
pero la distinción no es tanto su tamaño. 

186
00:10:15,980 --> 00:10:19,237
Si nos acercamos, notamos que el valor en el medio es mucho mayor que 

187
00:10:19,237 --> 00:10:22,588
el valor hacia los bordes, y esto se debe a que todos están muestreados 

188
00:10:22,588 --> 00:10:25,940
a partir de una curva de campana, conocida como distribución gaussiana. 

189
00:10:26,800 --> 00:10:29,817
De esa manera, cuando multiplicamos todos estos valores por el 

190
00:10:29,817 --> 00:10:32,212
píxel correspondiente sobre el que se encuentran, 

191
00:10:32,212 --> 00:10:36,380
le damos mucho más peso a ese píxel central y mucho menos a los que están en el borde. 

192
00:10:36,800 --> 00:10:40,560
Y al igual que antes, el píxel correspondiente a la derecha se define como esta suma. 

193
00:10:41,320 --> 00:10:43,912
A medida que realizamos este proceso para cada píxel, 

194
00:10:43,912 --> 00:10:48,040
se obtiene un efecto de desenfoque que simula de manera mucho más auténtica la noción 

195
00:10:48,040 --> 00:10:49,720
de desenfocar la lente o algo así. 

196
00:10:49,900 --> 00:10:53,360
Pero difuminar está lejos de ser lo único que se puede hacer con esta idea. 

197
00:10:53,800 --> 00:10:56,717
Por ejemplo, eche un vistazo a esta pequeña cuadrícula de valores, 

198
00:10:56,717 --> 00:10:59,808
que incluye algunos números positivos a la izquierda y algunos números 

199
00:10:59,808 --> 00:11:02,900
negativos a la derecha, que colorearé con azul y rojo respectivamente. 

200
00:11:03,640 --> 00:11:05,917
Tómate un momento para ver si puedes predecir y 

201
00:11:05,917 --> 00:11:08,480
comprender qué efecto tendrá esto en la imagen final. 

202
00:11:10,720 --> 00:11:14,462
Entonces, en este caso, pensaré en la imagen en escala de grises en lugar de coloreada, 

203
00:11:14,462 --> 00:11:18,120
de modo que cada uno de los píxeles esté representado por un número en lugar de tres. 

204
00:11:18,440 --> 00:11:20,685
Y una cosa que vale la pena señalar es que al hacer 

205
00:11:20,685 --> 00:11:23,060
esta convolución es posible obtener valores negativos. 

206
00:11:23,060 --> 00:11:26,170
Por ejemplo, en este punto, si hacemos zoom, la mitad izquierda de nuestra 

207
00:11:26,170 --> 00:11:28,990
pequeña cuadrícula se ubica completamente sobre los píxeles negros, 

208
00:11:28,990 --> 00:11:31,893
lo que tendría un valor de cero, pero la mitad derecha de los valores 

209
00:11:31,893 --> 00:11:35,460
negativos se ubicará sobre los píxeles blancos, lo que tendría tiene un valor de uno. 

210
00:11:36,180 --> 00:11:39,325
Entonces, cuando multiplicamos los términos correspondientes y los sumamos, 

211
00:11:39,325 --> 00:11:42,676
los resultados serán muy negativos, y la forma en que muestro esto con la imagen 

212
00:11:42,676 --> 00:11:46,360
de la derecha es colorear los valores negativos en rojo y los valores positivos en azul. 

213
00:11:46,880 --> 00:11:50,416
Otra cosa a tener en cuenta es que cuando estás en una zona que es del mismo color, 

214
00:11:50,416 --> 00:11:54,080
todo llega a cero ya que la suma de los valores en nuestra pequeña cuadrícula es cero. 

215
00:11:55,180 --> 00:11:57,525
Esto es muy diferente de los dos ejemplos anteriores donde la suma 

216
00:11:57,525 --> 00:11:59,589
de nuestra pequeña cuadrícula era uno, lo que nos permitió 

217
00:11:59,589 --> 00:12:02,180
interpretarla como una media móvil y, por tanto, como una imagen borrosa. 

218
00:12:03,640 --> 00:12:07,052
En general, este pequeño proceso básicamente detecta dónde hay variación en el 

219
00:12:07,052 --> 00:12:09,773
valor del píxel a medida que te mueves de izquierda a derecha, 

220
00:12:09,773 --> 00:12:13,315
por lo que te brinda una especie de forma de detectar todos los bordes verticales 

221
00:12:13,315 --> 00:12:13,920
de tu imagen. 

222
00:12:16,500 --> 00:12:20,700
Y de manera similar, si rotamos esa cuadrícula para que varíe a medida que te mueves de 

223
00:12:20,700 --> 00:12:23,898
arriba a abajo, esto se recogerá en todos los bordes horizontales, 

224
00:12:23,898 --> 00:12:28,098
lo que en el caso de nuestra imagen de la pequeña criatura de pastel resulta en algunos 

225
00:12:28,098 --> 00:12:29,340
ojos bastante demoníacos. 

226
00:12:30,400 --> 00:12:32,896
Por cierto, esta cuadrícula más pequeña a menudo se llama kernel, 

227
00:12:32,896 --> 00:12:35,468
y la belleza aquí es cómo simplemente eligiendo un kernel diferente 

228
00:12:35,468 --> 00:12:37,889
puedes obtener diferentes efectos de procesamiento de imágenes, 

229
00:12:37,889 --> 00:12:40,840
no solo desenfocar la detección de bordes sino también cosas como la nitidez. 

230
00:12:40,840 --> 00:12:44,874
Para aquellos de ustedes que han oído hablar de una red neuronal convolucional, 

231
00:12:44,874 --> 00:12:48,202
la idea es utilizar datos para determinar cuáles deberían ser los 

232
00:12:48,202 --> 00:12:51,480
núcleos en primer lugar, según lo que determine la red neuronal. 

233
00:12:52,760 --> 00:12:55,520
Otra cosa que tal vez debería mencionar es la duración de la salida. 

234
00:12:55,820 --> 00:12:59,339
Para algo como el ejemplo de media móvil, es posible que solo desee pensar en los 

235
00:12:59,339 --> 00:13:02,172
términos cuando ambas ventanas se alinean completamente entre sí, 

236
00:13:02,172 --> 00:13:05,992
o en el ejemplo de procesamiento de imágenes, tal vez desee que la salida final tenga el 

237
00:13:05,992 --> 00:13:07,280
mismo tamaño que el original. 

238
00:13:07,280 --> 00:13:10,136
Ahora bien, las convoluciones como operación matemática pura siempre 

239
00:13:10,136 --> 00:13:13,447
producen una matriz que es más grande que las dos matrices con las que comenzó, 

240
00:13:13,447 --> 00:13:16,180
al menos asumiendo que una de ellas no tiene una longitud de uno. 

241
00:13:16,720 --> 00:13:19,047
Solo sepa que en ciertos contextos informáticos 

242
00:13:19,047 --> 00:13:21,520
a menudo desea truncar deliberadamente esa salida. 

243
00:13:24,720 --> 00:13:28,127
Otra cosa que vale la pena destacar es que en el contexto de las ciencias de la 

244
00:13:28,127 --> 00:13:31,663
computación esta noción de darle la vuelta a ese núcleo antes de dejarlo avanzar a 

245
00:13:31,663 --> 00:13:35,113
través del original a menudo parece realmente extraña y simplemente innecesaria, 

246
00:13:35,113 --> 00:13:38,691
pero nuevamente tenga en cuenta que eso es lo que se hereda del contexto matemático 

247
00:13:38,691 --> 00:13:42,440
puro donde, como nosotros Vi con las probabilidades que es algo increíblemente natural. 

248
00:13:43,020 --> 00:13:46,034
Y de hecho, puedo mostrarles un ejemplo más de matemáticas puras en el 

249
00:13:46,034 --> 00:13:49,090
que incluso los programadores deberían preocuparse por este porque abre 

250
00:13:49,090 --> 00:13:52,020
las puertas a un algoritmo mucho más rápido para calcular todo esto. 

251
00:13:52,620 --> 00:13:55,123
Para configurar lo que quiero decir con más rápido aquí, 

252
00:13:55,123 --> 00:13:58,769
déjame regresar y abrir algo de Python nuevamente y crearé dos matrices diferentes 

253
00:13:58,769 --> 00:13:59,780
relativamente grandes. 

254
00:13:59,940 --> 00:14:03,905
Cada uno tendrá cien mil elementos aleatorios y voy a evaluar el tiempo 

255
00:14:03,905 --> 00:14:07,540
de ejecución de la función de convolución de la biblioteca numpy. 

256
00:14:08,180 --> 00:14:11,402
Y en este caso lo ejecuta durante múltiples iteraciones diferentes, 

257
00:14:11,402 --> 00:14:15,667
intenta encontrar un promedio y parece que en esta computadora al menos tiene un promedio 

258
00:14:15,667 --> 00:14:16,520
de 4.87 segundos. 

259
00:14:16,960 --> 00:14:21,322
Por el contrario, si uso una función diferente de la biblioteca scipy llamada 

260
00:14:21,322 --> 00:14:25,126
fftconvolve, que es lo mismo pero implementado de manera diferente, 

261
00:14:25,126 --> 00:14:30,160
solo toma 4.3 milisegundos en promedio, es decir, una mejora de tres órdenes de magnitud. 

262
00:14:30,160 --> 00:14:32,435
Y nuevamente, aunque tiene un nombre diferente, 

263
00:14:32,435 --> 00:14:35,564
está dando el mismo resultado que la otra función de convolución, 

264
00:14:35,564 --> 00:14:39,120
simplemente está haciendo algo para hacerlo de una manera más inteligente. 

265
00:14:42,200 --> 00:14:45,774
Recuerde que en el ejemplo de probabilidad dije que otra forma de pensar 

266
00:14:45,774 --> 00:14:49,300
en la convolución era crear esta tabla de todos los productos por pares 

267
00:14:49,300 --> 00:14:52,680
y luego sumar esos productos por pares a lo largo de las diagonales. 

268
00:14:53,660 --> 00:14:55,769
Por supuesto, no hay nada específico sobre la probabilidad. 

269
00:14:55,769 --> 00:14:57,914
Cada vez que convolucionas dos listas diferentes de números, 

270
00:14:57,914 --> 00:14:59,040
puedes pensarlo de esta manera. 

271
00:14:59,040 --> 00:15:02,750
Crea este tipo de tabla de multiplicar con todos los productos por pares y luego 

272
00:15:02,750 --> 00:15:06,460
cada suma a lo largo de la diagonal corresponde a uno de tus resultados finales. 

273
00:15:07,600 --> 00:15:10,373
Un contexto en el que esta visión resulta especialmente 

274
00:15:10,373 --> 00:15:12,800
natural es cuando se multiplican dos polinomios. 

275
00:15:13,300 --> 00:15:16,481
Por ejemplo, permítanme tomar la pequeña cuadrícula que ya 

276
00:15:16,481 --> 00:15:19,285
tenemos y reemplazar los términos superiores con 1, 

277
00:15:19,285 --> 00:15:23,600
2x y 3x al cuadrado y reemplazar los otros términos con 4, 5x y 6x al cuadrado. 

278
00:15:24,000 --> 00:15:26,333
Ahora piense en lo que significa cuando creamos todos 

279
00:15:26,333 --> 00:15:28,840
estos productos diferentes en pares entre las dos listas. 

280
00:15:29,040 --> 00:15:32,917
Lo que estás haciendo es esencialmente expandir el producto completo de los dos 

281
00:15:32,917 --> 00:15:37,279
polinomios que he escrito y luego, cuando sumas a lo largo de la diagonal que corresponde 

282
00:15:37,279 --> 00:15:40,720
a recolectar todos los términos semejantes, lo cual es bastante bueno, 

283
00:15:40,720 --> 00:15:44,598
expandir un polinomio y recolectar términos semejantes es exactamente lo mismo. 

284
00:15:44,598 --> 00:15:46,440
El mismo proceso que una convolución. 

285
00:15:47,740 --> 00:15:52,289
Pero esto nos permite hacer algo muy bueno porque piensen en lo que estamos diciendo aquí.

286
00:15:52,289 --> 00:15:52,340
 

287
00:15:52,340 --> 00:15:56,383
Estamos diciendo que si tomas dos funciones diferentes y las multiplicas, 

288
00:15:56,383 --> 00:16:00,371
que es una operación puntual simple, es lo mismo que si primero hubieras 

289
00:16:00,371 --> 00:16:04,633
extraído los coeficientes de cada una de ellas, asumiendo que son polinomios, 

290
00:16:04,633 --> 00:16:08,840
y luego hubieras tomado una convolución de esas. dos listas de coeficientes. 

291
00:16:09,620 --> 00:16:13,666
Lo que hace que esto sea tan interesante es que las convoluciones parecen, en principio, 

292
00:16:13,666 --> 00:16:17,712
mucho más complicadas que una simple multiplicación y no me refiero sólo conceptualmente 

293
00:16:17,712 --> 00:16:21,668
a que son más difíciles de pensar, sino que computacionalmente requiere más pasos para 

294
00:16:21,668 --> 00:16:25,760
realizar una convolución que para realizar una Producto puntual de dos listas diferentes. 

295
00:16:26,319 --> 00:16:29,534
Por ejemplo, digamos que te di dos polinomios realmente grandes, 

296
00:16:29,534 --> 00:16:32,551
digamos cada uno con cien coeficientes diferentes, entonces, 

297
00:16:32,551 --> 00:16:36,260
si la forma en que los multiplicas fuera expandir este producto, ya sabes, 

298
00:16:36,260 --> 00:16:40,167
completando esta cuadrícula completa de 100 por 100 de productos por pares que 

299
00:16:40,167 --> 00:16:43,183
requerirían que realice 10.000 productos diferentes y luego, 

300
00:16:43,183 --> 00:16:46,942
cuando recopile todos los términos semejantes a lo largo de las diagonales, 

301
00:16:46,942 --> 00:16:49,860
ese será otro conjunto de alrededor de 10.000 operaciones. 

302
00:16:50,700 --> 00:16:54,778
De manera más general, en la jerga diríamos que el algoritmo es O de n al cuadrado, 

303
00:16:54,778 --> 00:16:58,080
lo que significa que para dos listas de tamaño n la forma en que el 

304
00:16:58,080 --> 00:17:01,140
número de operaciones escala es proporcional al cuadrado de n. 

305
00:17:01,820 --> 00:17:06,274
Por otro lado, si pienso en dos polinomios en términos de sus salidas, por ejemplo, 

306
00:17:06,274 --> 00:17:08,926
muestreando sus valores en un puñado de entradas, 

307
00:17:08,926 --> 00:17:12,956
multiplicarlos solo requiere tantas operaciones como el número de muestras, 

308
00:17:12,956 --> 00:17:17,464
ya que nuevamente es una operación puntual y con polinomios solo necesitas un número 

309
00:17:17,464 --> 00:17:20,540
finito de muestras para poder recuperar los coeficientes. 

310
00:17:20,540 --> 00:17:22,775
Por ejemplo, dos salidas son suficientes para 

311
00:17:22,775 --> 00:17:25,060
especificar de forma única un polinomio lineal.

312
00:17:25,660 --> 00:17:27,797
Tres resultados serían suficientes para especificar 

313
00:17:27,797 --> 00:17:29,400
de forma única un polinomio cuadrático.

314
00:17:29,640 --> 00:17:33,446
Y, en general, si conoce n salidas distintas, eso es suficiente para 

315
00:17:33,446 --> 00:17:37,640
especificar de forma única un polinomio que tiene n coeficientes diferentes.

316
00:17:37,780 --> 00:17:40,720
O si lo prefieres, podríamos expresarlo en el lenguaje de los sistemas de ecuaciones.

317
00:17:41,200 --> 00:17:45,201
Imagina que te digo que tengo un polinomio pero no te digo cuáles son los coeficientes, 

318
00:17:45,201 --> 00:17:46,520
esos son un misterio para ti.

319
00:17:46,700 --> 00:17:48,750
En nuestro ejemplo, podría pensar que esto es 

320
00:17:48,750 --> 00:17:50,800
el producto que estamos tratando de descubrir.

321
00:17:50,800 --> 00:17:54,925
Entonces supongamos que digo que simplemente le diré cuáles serían las salidas de este 

322
00:17:54,925 --> 00:17:59,097
polinomio si ingresara varias entradas diferentes como 0, 1, 2, 3, y así sucesivamente, 

323
00:17:59,097 --> 00:18:02,606
y le doy lo suficiente para que tenga tantas ecuaciones como sea posible. 

324
00:18:02,606 --> 00:18:03,460
tienes incógnitas.

325
00:18:04,140 --> 00:18:07,340
Incluso resulta ser un sistema lineal de ecuaciones, así que está bien.

326
00:18:07,780 --> 00:18:10,900
Y al menos en principio, esto debería ser suficiente para recuperar los coeficientes.

327
00:18:11,740 --> 00:18:15,480
Entonces, el esquema aproximado del algoritmo sería que cuando quieras convolucionar 

328
00:18:15,480 --> 00:18:19,000
dos listas de números, los trates como si fueran coeficientes de dos polinomios.

329
00:18:19,420 --> 00:18:22,588
Se toman muestras de esos polinomios con suficientes salidas, 

330
00:18:22,588 --> 00:18:26,318
se multiplican esas muestras puntualmente y luego se resuelve el sistema 

331
00:18:26,318 --> 00:18:30,560
para recuperar los coeficientes como una forma furtiva de encontrar la convolución.

332
00:18:31,420 --> 00:18:35,458
Y como lo he dicho al menos hasta ahora, algunos de ustedes podrían quejarse con razón: 

333
00:18:35,458 --> 00:18:37,340
&quot;Grant, ese es un plan idiota&quot;.

334
00:18:37,580 --> 00:18:41,259
Porque, por un lado, simplemente calcular todas estas muestras para uno de 

335
00:18:41,259 --> 00:18:45,183
los polinomios que conocemos ya requiere el orden de n operaciones al cuadrado, 

336
00:18:45,183 --> 00:18:48,862
sin mencionar que resolver ese sistema ciertamente será computacionalmente 

337
00:18:48,862 --> 00:18:52,100
tan difícil como simplemente hacer la convolución en primer lugar.

338
00:18:52,600 --> 00:18:56,771
Entonces, seguro que tenemos esta conexión entre multiplicación y convoluciones, 

339
00:18:56,771 --> 00:19:00,480
pero toda la complejidad ocurre al traducir de un punto de vista a otro.

340
00:19:01,600 --> 00:19:04,829
Pero hay un truco, y aquellos de ustedes que conocen las transformadas 

341
00:19:04,829 --> 00:19:07,740
de Fourier y el algoritmo FFT podrían ver hacia dónde se dirige.

342
00:19:07,740 --> 00:19:09,915
Si no está familiarizado con estos temas, lo que 

343
00:19:09,915 --> 00:19:12,180
voy a decir puede parecer completamente inesperado.

344
00:19:12,260 --> 00:19:14,701
Sólo debes saber que hay ciertos caminos que podrías haber recorrido 

345
00:19:14,701 --> 00:19:16,860
en matemáticas y que hacen que este sea un paso más esperado.

346
00:19:17,720 --> 00:19:20,360
Básicamente la idea es que aquí tenemos libertad de elección.

347
00:19:20,540 --> 00:19:24,956
Si en lugar de evaluar en algún conjunto arbitrario de entradas como 0, 1, 2, 3, 

348
00:19:24,956 --> 00:19:29,700
etc., elige evaluar en un conjunto de números complejos muy especialmente seleccionado.

349
00:19:30,240 --> 00:19:33,249
Específicamente los que se encuentran espaciados uniformemente en el círculo unitario, 

350
00:19:33,249 --> 00:19:34,840
lo que se conoce como las raíces de la unidad.

351
00:19:35,200 --> 00:19:36,880
Esto nos da un sistema más amigable.

352
00:19:38,360 --> 00:19:42,372
La idea básica es que al encontrar un número en el que la toma de sus potencias 

353
00:19:42,372 --> 00:19:46,485
caiga en este patrón cíclico, significa que el sistema que generamos tendrá mucha 

354
00:19:46,485 --> 00:19:49,645
redundancia en los diferentes términos que estamos calculando, 

355
00:19:49,645 --> 00:19:52,955
y al ser inteligente acerca de cómo Si aprovecha esa redundancia, 

356
00:19:52,955 --> 00:19:54,460
puede ahorrarse mucho trabajo.

357
00:19:56,020 --> 00:19:59,317
Este conjunto de resultados que he escrito tiene un nombre especial, 

358
00:19:59,317 --> 00:20:02,280
se llama transformada discreta de Fourier de los coeficientes.

359
00:20:02,500 --> 00:20:05,794
Y si quieres aprender más, de hecho di otra conferencia para esa 

360
00:20:05,794 --> 00:20:09,140
misma clase de Julia MIT sobre transformadas discretas de Fourier.

361
00:20:09,220 --> 00:20:13,146
Y también hay un video realmente excelente en el canal reducible que habla sobre la 

362
00:20:13,146 --> 00:20:17,120
transformada rápida de Fourier, que es un algoritmo para calcularlos más rápidamente.

363
00:20:17,480 --> 00:20:20,412
Además, Veritasium hizo recientemente un video realmente bueno sobre FFT, 

364
00:20:20,412 --> 00:20:21,760
por lo que tienes muchas opciones.

365
00:20:22,260 --> 00:20:24,660
Y ese algoritmo rápido realmente es el punto para nosotros.

366
00:20:25,120 --> 00:20:28,628
Nuevamente, debido a toda esta redundancia, existe un método para pasar de los 

367
00:20:28,628 --> 00:20:32,137
coeficientes a todas estas salidas, donde en lugar de realizar operaciones del 

368
00:20:32,137 --> 00:20:36,002
orden de n al cuadrado, se realizan del orden de n veces el registro de n operaciones, 

369
00:20:36,002 --> 00:20:39,200
lo cual es mucho más. mucho mejor a medida que escalas a listas grandes.

370
00:20:39,660 --> 00:20:42,540
Y lo más importante es que este algoritmo fft funciona en ambos sentidos.

371
00:20:42,700 --> 00:20:45,480
También te permite pasar de las salidas a los coeficientes.

372
00:20:46,220 --> 00:20:49,060
Entonces, juntándolo todo, volvamos a ver el esquema de nuestro algoritmo.

373
00:20:49,420 --> 00:20:53,510
Ahora podemos decir que siempre que tengas dos listas largas de números y quieras 

374
00:20:53,510 --> 00:20:57,700
tomar su convolución, primero calcula la transformada rápida de Fourier de cada uno 

375
00:20:57,700 --> 00:21:02,090
de ellos, lo que en el fondo puedes considerar como tratarlos como son los coeficientes 

376
00:21:02,090 --> 00:21:06,380
de un polinomio y se evalúan en un conjunto de puntos muy especialmente seleccionados.

377
00:21:06,899 --> 00:21:10,383
Luego multiplique los dos resultados que acaba de obtener puntualmente, 

378
00:21:10,383 --> 00:21:14,448
lo cual es bueno y rápido, y luego haga una transformada rápida inversa de Fourier, 

379
00:21:14,448 --> 00:21:18,464
y lo que eso le dará es la manera furtiva de calcular la convolución que estábamos 

380
00:21:18,464 --> 00:21:18,900
buscando.

381
00:21:19,040 --> 00:21:22,240
Pero esta vez solo involucra O de n log n operaciones.

382
00:21:23,139 --> 00:21:24,740
¡Eso es realmente genial para mí!

383
00:21:25,120 --> 00:21:29,156
Este contexto tan específico donde aparecen convoluciones al multiplicar dos polinomios, 

384
00:21:29,156 --> 00:21:32,195
abre las puertas a un algoritmo que es relevante en cualquier otro 

385
00:21:32,195 --> 00:21:34,100
lugar donde puedan aparecer convoluciones.

386
00:21:34,180 --> 00:21:36,366
Si desea agregar distribuciones de probabilidad, 

387
00:21:36,366 --> 00:21:39,000
realice un procesamiento de imágenes grandes, sea cual sea.

388
00:21:39,220 --> 00:21:43,521
Y creo que es un buen ejemplo de por qué debería emocionarse cuando ve alguna operación 

389
00:21:43,521 --> 00:21:47,480
o concepto en matemáticas aparecer en muchas áreas aparentemente no relacionadas.

390
00:21:48,480 --> 00:21:51,500
Si quieres un poco de tarea, aquí tienes algo en lo que es divertido pensar.

391
00:21:51,720 --> 00:21:54,318
Explica por qué cuando multiplicas dos números diferentes, 

392
00:21:54,318 --> 00:21:58,149
simplemente una multiplicación ordinaria como todos aprendemos en la escuela primaria, 

393
00:21:58,149 --> 00:22:01,980
lo que estás haciendo es básicamente una convolución entre los dígitos de esos números.

394
00:22:02,500 --> 00:22:04,762
Hay algunos pasos adicionales con acarreos y similares, 

395
00:22:04,762 --> 00:22:06,460
pero el paso principal es una convolución.

396
00:22:07,280 --> 00:22:09,461
A la luz de la existencia de un algoritmo rápido, 

397
00:22:09,461 --> 00:22:12,558
lo que eso significa es que si tienes dos números enteros muy grandes, 

398
00:22:12,558 --> 00:22:16,222
entonces existe una manera de encontrar su producto que es más rápida que el método 

399
00:22:16,222 --> 00:22:17,880
que aprendemos en la escuela primaria.

400
00:22:18,140 --> 00:22:22,390
Que en lugar de requerir O de n operaciones al cuadrado solo requiere O de n log n, 

401
00:22:22,390 --> 00:22:24,920
lo que ni siquiera parece que debería ser posible.

402
00:22:25,380 --> 00:22:28,475
El problema es que antes de que esto sea realmente útil en la práctica, 

403
00:22:28,475 --> 00:22:30,840
sus números tendrían que ser absolutamente monstruosos.

404
00:22:31,220 --> 00:22:35,340
Pero aun así, es genial que exista un algoritmo así.

405
00:22:35,340 --> 00:22:37,559
A continuación centraremos nuestra atención en el caso continuo 

406
00:22:37,559 --> 00:22:39,640
con especial atención en las distribuciones de probabilidad.


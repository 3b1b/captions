1
00:00:00,000 --> 00:00:02,840
Supongamos que le doy dos listas diferentes de números, o tal vez

2
00:00:02,840 --> 00:00:05,724
dos funciones diferentes, y le pido que piense en todas las formas

3
00:00:05,724 --> 00:00:08,651
en que podría combinar esas dos listas para obtener una nueva lista

4
00:00:08,651 --> 00:00:11,793
de números, o combinar las dos funciones para obtener una nueva función.

5
00:00:11,793 --> 00:00:14,056
. Quizás una forma sencilla que se nos ocurra

6
00:00:14,056 --> 00:00:16,320
sea simplemente sumarlos término por término.

7
00:00:16,320 --> 00:00:20,106
Así mismo con las funciones, puedes agregar todas las salidas correspondientes.

8
00:00:20,106 --> 00:00:23,283
De manera similar, también puedes multiplicar las dos listas

9
00:00:23,283 --> 00:00:26,199
término por término y hacer lo mismo con las funciones.

10
00:00:26,199 --> 00:00:29,790
Pero hay otro tipo de combinación tan fundamental como

11
00:00:29,790 --> 00:00:33,840
ambas, pero mucho menos discutida, conocida como convolución.

12
00:00:33,840 --> 00:00:36,730
Pero a diferencia de los dos casos anteriores, no es algo que

13
00:00:36,730 --> 00:00:39,946
simplemente se hereda de una operación que puedes hacer con números.

14
00:00:39,946 --> 00:00:44,778
Es algo realmente nuevo para el contexto de listas de números o combinación de funciones.

15
00:00:44,778 --> 00:00:48,577
Aparecen por todas partes, son omnipresentes en el procesamiento de imágenes,

16
00:00:48,577 --> 00:00:52,473
es una construcción central en la teoría de la probabilidad, se usan mucho para

17
00:00:52,473 --> 00:00:56,369
resolver ecuaciones diferenciales y es un contexto en el que es casi seguro que

18
00:00:56,369 --> 00:01:00,265
lo hayas visto, si no. con este nombre, es multiplicar dos polinomios entre sí.

19
00:01:00,265 --> 00:01:04,938
Como alguien en el negocio de las explicaciones visuales, este es un tema especialmente

20
00:01:04,938 --> 00:01:09,346
bueno, porque la definición formulada aislada y sin contexto puede parecer un poco

21
00:01:09,346 --> 00:01:14,020
intimidante, pero si nos tomamos el tiempo para analizar realmente lo que dice, y antes

22
00:01:14,020 --> 00:01:18,800
de eso, motivar por qué querrías algo como esto, es una operación increíblemente hermosa.

23
00:01:18,800 --> 00:01:21,141
Y tengo que admitir que en realidad aprendí algo

24
00:01:21,141 --> 00:01:23,482
mientras armaba las imágenes para este proyecto.

25
00:01:23,482 --> 00:01:27,001
En el caso de convolucionar dos funciones diferentes, estaba tratando de pensar en

26
00:01:27,001 --> 00:01:30,690
diferentes formas en las que podría imaginarse lo que eso podría significar, y con una

27
00:01:30,690 --> 00:01:34,166
de ellas tuve un pequeño momento de ajá sobre por qué las distribuciones normales

28
00:01:34,166 --> 00:01:37,940
desempeñan el papel que lo hacen con probabilidad, por qué es una forma tan natural para

29
00:01:37,940 --> 00:01:38,491
una función.

30
00:01:38,491 --> 00:01:41,626
Pero me estoy adelantando, hay mucha preparación para eso.

31
00:01:41,626 --> 00:01:45,993
En este video, nuestro enfoque principal será el caso discreto y, en particular,

32
00:01:45,993 --> 00:01:50,251
desarrollar un algoritmo muy inesperado pero muy inteligente para calcularlos.

33
00:01:50,251 --> 00:01:57,840
Y llevaré la discusión del caso continuo a una segunda parte.

34
00:01:57,840 --> 00:02:01,704
Es muy tentador comenzar con los ejemplos de procesamiento de imágenes, ya que son

35
00:02:01,704 --> 00:02:05,708
visualmente los más intrigantes, pero hay un par de detalles que hacen que el caso de

36
00:02:05,708 --> 00:02:09,619
procesamiento de imágenes sea menos representativo de las convoluciones en general,

37
00:02:09,619 --> 00:02:13,716
así que comencemos con la probabilidad. y en particular uno de los ejemplos más simples

38
00:02:13,716 --> 00:02:17,534
en el que estoy seguro todos aquí han pensado en algún momento de su vida, que es

39
00:02:17,534 --> 00:02:21,585
tirar un par de dados y calcular las posibilidades de obtener varias sumas diferentes.

40
00:02:21,585 --> 00:02:24,225
Y se podría decir, no es un problema, no es un problema.

41
00:02:24,225 --> 00:02:28,121
Cada uno de tus dos dados tiene seis resultados posibles diferentes, lo

42
00:02:28,121 --> 00:02:32,180
que nos da un total de 36 pares de resultados posibles distintos, y si los

43
00:02:32,180 --> 00:02:36,240
analizamos todos podemos contar cuántos pares tienen una suma determinada.

44
00:02:36,240 --> 00:02:39,270
Y al organizar todos los pares en una cuadrícula como esta, una

45
00:02:39,270 --> 00:02:42,254
cosa bastante buena es que todos los pares que tienen una suma

46
00:02:42,254 --> 00:02:45,711
constante son visibles a lo largo de una de estas diagonales diferentes.

47
00:02:45,711 --> 00:02:49,137
Entonces, simplemente contar cuántos existen en cada una de esas

48
00:02:49,137 --> 00:02:52,880
diagonales le indicará la probabilidad de que vea una suma particular.

49
00:02:52,880 --> 00:02:55,788
Y yo diría, muy bien, muy bien, pero ¿se te ocurre

50
00:02:55,788 --> 00:02:58,754
alguna otra manera de visualizar la misma pregunta?

51
00:02:58,754 --> 00:03:01,320
¿Otras imágenes que te pueden venir a la cabeza al pensar en

52
00:03:01,320 --> 00:03:03,801
todos los distintos pares que tienen una suma determinada?

53
00:03:03,801 --> 00:03:07,607
Y tal vez uno de ustedes levante la mano y diga: sí, tengo uno.

54
00:03:07,607 --> 00:03:11,026
Digamos que imaginas estos dos conjuntos diferentes de posibilidades,

55
00:03:11,026 --> 00:03:14,103
cada uno en una fila, pero le das la vuelta a la segunda fila.

56
00:03:14,103 --> 00:03:19,017
De esa manera, todos los diferentes pares que suman siete se alinean verticalmente así.

57
00:03:19,017 --> 00:03:22,665
Y si deslizamos la fila inferior completamente hacia la derecha, entonces el

58
00:03:22,665 --> 00:03:26,360
par único que suma dos, los ojos de serpiente, son los únicos que se alinean.

59
00:03:26,360 --> 00:03:29,597
Y si lo distribuyo una unidad hacia la derecha, los pares

60
00:03:29,597 --> 00:03:32,945
que se alinean son los dos pares diferentes que suman tres.

61
00:03:32,945 --> 00:03:35,754
Y, en general, los diferentes valores de compensación de esta

62
00:03:35,754 --> 00:03:38,834
matriz inferior, que recuerdo que tuve que darle la vuelta primero,

63
00:03:38,834 --> 00:03:41,870
revelan todos los pares distintos que tienen una suma determinada.

64
00:03:41,870 --> 00:03:45,676
En lo que respecta a las preguntas de probabilidad, esto todavía no

65
00:03:45,676 --> 00:03:49,426
es especialmente interesante, porque lo único que estamos haciendo

66
00:03:49,426 --> 00:03:53,120
es contar cuántos resultados hay en cada una de estas categorías.

67
00:03:53,120 --> 00:03:55,599
Pero eso es con el supuesto implícito de que hay la misma

68
00:03:55,599 --> 00:03:57,907
probabilidad de que aparezca cada una de estas caras.

69
00:03:57,907 --> 00:04:01,954
Pero ¿y si te dijera que tengo un juego de dados especial que no es uniforme?

70
00:04:01,954 --> 00:04:04,538
Tal vez el dado azul tenga su propio conjunto de números que

71
00:04:04,538 --> 00:04:07,207
describen las probabilidades de que salga cada cara, y el dado

72
00:04:07,207 --> 00:04:09,790
rojo tenga su propio conjunto de números distintivo y único.

73
00:04:09,790 --> 00:04:13,212
En ese caso, si quisieras calcular, digamos, la probabilidad de

74
00:04:13,212 --> 00:04:16,581
ver un dos, multiplicarías la probabilidad de que el dado azul

75
00:04:16,581 --> 00:04:19,949
sea un uno por la probabilidad de que el dado rojo sea un uno.

76
00:04:19,949 --> 00:04:23,313
Y para conocer las posibilidades de ver un tres, observas los dos

77
00:04:23,313 --> 00:04:26,676
pares distintos cuando sea posible y, nuevamente, multiplicas las

78
00:04:26,676 --> 00:04:30,039
probabilidades correspondientes y luego sumas esos dos productos.

79
00:04:30,039 --> 00:04:33,267
De manera similar, las posibilidades de ver un cuatro implican

80
00:04:33,267 --> 00:04:36,802
multiplicar tres pares diferentes de posibilidades y sumarlos todos.

81
00:04:36,802 --> 00:04:41,537
Y con el ánimo de establecer algunas fórmulas, llamemos a estas probabilidades

82
00:04:41,537 --> 00:04:45,973
superiores a1, a2, a3, etc., y llamemos a las inferiores b1, b2, b3, etc.

83
00:04:45,973 --> 00:04:49,723
Y en general, este proceso, en el que tomamos dos conjuntos diferentes de

84
00:04:49,723 --> 00:04:53,423
números, volteamos el segundo y luego los alineamos en varios valores de

85
00:04:53,423 --> 00:04:57,073
compensación diferentes, tomamos un montón de productos por pares y los

86
00:04:57,073 --> 00:05:01,229
sumamos, ese es uno de los Formas fundamentales de pensar qué es una convolución.

87
00:05:01,229 --> 00:05:06,423
Entonces, para explicarlo un poco más exactamente, a través de este proceso,

88
00:05:06,423 --> 00:05:11,751
simplemente generamos probabilidades de ver dos, tres, cuatro, y así hasta 12,

89
00:05:11,751 --> 00:05:17,147
y las obtuvimos mezclando una lista de valores, a, y otra. lista de valores, b.

90
00:05:17,147 --> 00:05:20,524
En la jerga, diríamos que la convolución de esas dos secuencias

91
00:05:20,524 --> 00:05:23,848
nos da esta nueva secuencia, la nueva secuencia de 11 valores,

92
00:05:23,848 --> 00:05:27,172
cada uno de los cuales parece una suma de productos por pares.

93
00:05:27,172 --> 00:05:31,841
Si lo prefieres, otra forma de pensar en la misma operación es crear primero

94
00:05:31,841 --> 00:05:36,753
una tabla de todos los productos por pares y luego sumar todas estas diagonales.

95
00:05:36,753 --> 00:05:39,572
Nuevamente, esa es una forma de mezclar estas dos secuencias

96
00:05:39,572 --> 00:05:42,299
de números para obtener una nueva secuencia de 11 números.

97
00:05:42,299 --> 00:05:44,819
Es el mismo funcionamiento que pensaban las ventanas

98
00:05:44,819 --> 00:05:46,960
correderas, sólo que desde otra perspectiva.

99
00:05:46,960 --> 00:05:50,360
Poniéndole una pequeña notación, así es como podría verlo escrito.

100
00:05:50,360 --> 00:05:55,135
La convolución de a y b, indicada con este pequeño asterisco, es una nueva lista,

101
00:05:55,135 --> 00:05:59,793
y el enésimo elemento de esa lista parece una suma, y esa suma abarca todos los

102
00:05:59,793 --> 00:06:04,800
diferentes pares de índices, i y j, de modo que la suma de esos índices es igual a n.

103
00:06:04,800 --> 00:06:10,494
Es un poco complicado, pero por ejemplo, si n fuera 6, los pares que repasaremos

104
00:06:10,494 --> 00:06:16,400
son 1 y 5, 2 y 4, 3 y 3, 4 y 2, 5 y 1, todos los pares diferentes que se suman a 6.

105
00:06:16,400 --> 00:06:19,575
Pero, sinceramente, independientemente de cómo lo escribas, la notación tiene una

106
00:06:19,575 --> 00:06:22,790
importancia secundaria frente a la imagen que puedas tener en tu cabeza durante el

107
00:06:22,790 --> 00:06:23,139
proceso.

108
00:06:23,139 --> 00:06:26,782
Aquí, tal vez sea útil hacer un ejemplo súper simple, donde podría

109
00:06:26,782 --> 00:06:31,024
preguntarte cuál es la convolución de la lista 1, 2, 3, con la lista 4, 5, 6.

110
00:06:31,024 --> 00:06:34,599
Podrías imaginarte tomar ambas listas, darle la vuelta a la segunda

111
00:06:34,599 --> 00:06:37,910
y luego comenzar con la tapa completamente hacia la izquierda.

112
00:06:37,910 --> 00:06:40,549
Luego, el par de valores que se alinean son 1 y 4, los

113
00:06:40,549 --> 00:06:43,860
multiplicamos y eso nos da nuestro primer término de nuestra salida.

114
00:06:43,860 --> 00:06:47,175
Deslice la matriz inferior una unidad hacia la derecha, los

115
00:06:47,175 --> 00:06:50,767
pares que se alinean son 1 y 5, y 2 y 4, multiplique esos pares,

116
00:06:50,767 --> 00:06:54,360
súmelos y eso nos da 13, la siguiente entrada en nuestra salida.

117
00:06:54,360 --> 00:06:58,085
Desliza las cosas una vez más y tomaremos 1 por 6,

118
00:06:58,085 --> 00:07:01,665
más 2 por 5, más 3 por 4, lo que resulta ser 28.

119
00:07:01,665 --> 00:07:05,969
Una diapositiva más y obtenemos 2 por 6, más 3 por 5, y eso

120
00:07:05,969 --> 00:07:10,560
nos da 27, y finalmente el último término se verá como 3 por 6.

121
00:07:10,560 --> 00:07:13,215
Si lo desea, puede consultar cualquiera que sea su lenguaje de

122
00:07:13,215 --> 00:07:15,996
programación favorito y su biblioteca favorita que incluya varias

123
00:07:15,996 --> 00:07:18,862
operaciones numéricas, y podrá confirmar que no le estoy mintiendo.

124
00:07:18,862 --> 00:07:21,871
Si tomas la convolución de 1, 2, 3 contra 4, 5,

125
00:07:21,871 --> 00:07:24,880
6, este es de hecho el resultado que obtendrás.

126
00:07:24,880 --> 00:07:28,908
Hemos visto un caso en el que se trata de una operación natural y deseable, que se

127
00:07:28,908 --> 00:07:32,936
suma a distribuciones de probabilidad, y otro ejemplo común sería una media móvil.

128
00:07:32,936 --> 00:07:35,743
Imagina que tienes una lista larga de números y

129
00:07:35,743 --> 00:07:38,842
tomas otra lista más pequeña de números que suman 1.

130
00:07:38,842 --> 00:07:43,437
En este caso, solo tengo una pequeña lista de 5 valores y todos son iguales a 15.

131
00:07:43,437 --> 00:07:47,384
Luego, si hacemos este proceso de convolución de ventana deslizante, cerramos los

132
00:07:47,384 --> 00:07:51,234
ojos y escondemos debajo de la alfombra lo que sucede al principio, una vez que

133
00:07:51,234 --> 00:07:55,181
nuestra lista más pequeña de valores se superpone por completo con la más grande,

134
00:07:55,181 --> 00:07:59,080
piense en lo que significa cada término en este realmente significa convolución.

135
00:07:59,080 --> 00:08:02,918
En cada iteración, lo que estás haciendo es multiplicar cada uno

136
00:08:02,918 --> 00:08:06,638
de los valores de tus datos por 15 y sumarlos todos, es decir,

137
00:08:06,638 --> 00:08:10,831
estás tomando un promedio de tus datos dentro de esta pequeña ventana.

138
00:08:10,831 --> 00:08:14,685
En general, el proceso le brinda una versión suavizada de los datos originales, y

139
00:08:14,685 --> 00:08:18,633
puede modificarla comenzando con una pequeña lista diferente de números, y mientras

140
00:08:18,633 --> 00:08:22,864
esa pequeña lista sume 1, aún puede interpretarla como una lista en movimiento. promedio.

141
00:08:22,864 --> 00:08:27,833
En el ejemplo que se muestra aquí, esa media móvil daría más peso al valor central.

142
00:08:27,833 --> 00:08:33,200
Esto también da como resultado una versión suavizada de los datos.

143
00:08:33,200 --> 00:08:35,989
Si haces una especie de analogía bidimensional de esto, obtendrás

144
00:08:35,989 --> 00:08:38,652
un algoritmo divertido para desenfocar una imagen determinada.

145
00:08:38,652 --> 00:08:41,700
Y debo decir que las animaciones que estoy a punto de mostrar están

146
00:08:41,700 --> 00:08:44,703
modificadas de algo que hice originalmente para parte de una serie

147
00:08:44,703 --> 00:08:47,751
de conferencias que di con el Julia Lab en el MIT para cierta clase

148
00:08:47,751 --> 00:08:50,933
de OpenCourseWare que incluía una unidad de procesamiento de imágenes.

149
00:08:50,933 --> 00:08:53,674
Allí hicimos un poco más para profundizar en el código detrás de

150
00:08:53,674 --> 00:08:56,499
todo esto, así que si tienes curiosidad te dejaré algunos enlaces.

151
00:08:56,499 --> 00:08:59,853
Pero volviendo a centrarnos en este ejemplo borroso, lo que está pasando

152
00:08:59,853 --> 00:09:03,116
es que tengo esta pequeña cuadrícula de valores de 3x3 que avanza a lo

153
00:09:03,116 --> 00:09:06,379
largo de nuestra imagen original, y si nos acercamos, cada uno de esos

154
00:09:06,379 --> 00:09:09,642
valores es 19, y lo que estoy haciendo en cada iteración se multiplica

155
00:09:09,642 --> 00:09:13,365
cada uno de esos valores por el píxel correspondiente sobre el que se encuentra.

156
00:09:13,365 --> 00:09:16,692
Y, por supuesto, en informática pensamos en los colores como pequeños

157
00:09:16,692 --> 00:09:20,400
vectores de tres valores, que representan los componentes rojo, verde y azul.

158
00:09:20,400 --> 00:09:23,889
Cuando multiplico todos estos pequeños valores por 19 y los sumo,

159
00:09:23,889 --> 00:09:27,485
obtenemos un promedio a lo largo de cada canal de color, y el píxel

160
00:09:27,485 --> 00:09:31,027
correspondiente a la imagen de la derecha se define como esa suma.

161
00:09:31,027 --> 00:09:36,226
El efecto general, al hacer esto para cada píxel de la imagen, es que cada uno se

162
00:09:36,226 --> 00:09:41,680
fusiona con todos sus vecinos, lo que nos da una versión más borrosa que la original.

163
00:09:41,680 --> 00:09:44,813
En la jerga diríamos que la imagen de la derecha es una convolución

164
00:09:44,813 --> 00:09:47,855
de nuestra imagen original con una pequeña cuadrícula de valores.

165
00:09:47,855 --> 00:09:51,141
O más técnicamente tal vez debería decir que es la convolución con

166
00:09:51,141 --> 00:09:54,477
una versión girada 180 grados de esa pequeña cuadrícula de valores.

167
00:09:54,477 --> 00:09:58,304
No es que importe cuando la cuadrícula es simétrica, pero vale la pena tener

168
00:09:58,304 --> 00:10:02,131
en cuenta que la definición de convolución, heredada del contexto matemático

169
00:10:02,131 --> 00:10:05,760
puro, siempre debería invitarte a pensar en invertir esa segunda matriz.

170
00:10:05,760 --> 00:10:08,592
Si modificamos esto ligeramente podemos conseguir un efecto de desenfoque

171
00:10:08,592 --> 00:10:11,118
mucho más elegante eligiendo una cuadrícula de valores diferente.

172
00:10:11,118 --> 00:10:13,727
En este caso tengo una pequeña cuadrícula de 5x5,

173
00:10:13,727 --> 00:10:15,920
pero la distinción no es tanto su tamaño.

174
00:10:15,920 --> 00:10:19,238
Si nos acercamos, notamos que el valor en el medio es mucho mayor que

175
00:10:19,238 --> 00:10:22,651
el valor hacia los bordes, y esto se debe a que todos están muestreados

176
00:10:22,651 --> 00:10:26,064
a partir de una curva de campana, conocida como distribución gaussiana.

177
00:10:26,064 --> 00:10:29,325
De esa manera, cuando multiplicamos todos estos valores por el

178
00:10:29,325 --> 00:10:32,689
píxel correspondiente sobre el que se encuentran, le damos mucho

179
00:10:32,689 --> 00:10:36,416
más peso a ese píxel central y mucho menos a los que están en el borde.

180
00:10:36,416 --> 00:10:40,430
Y al igual que antes, el píxel correspondiente a la derecha se define como esta suma.

181
00:10:40,430 --> 00:10:45,174
A medida que realizamos este proceso para cada píxel, se obtiene un efecto de desenfoque

182
00:10:45,174 --> 00:10:49,760
que simula de manera mucho más auténtica la noción de desenfocar la lente o algo así.

183
00:10:49,760 --> 00:10:53,527
Pero difuminar está lejos de ser lo único que se puede hacer con esta idea.

184
00:10:53,527 --> 00:10:56,603
Por ejemplo, eche un vistazo a esta pequeña cuadrícula de valores,

185
00:10:56,603 --> 00:10:59,862
que incluye algunos números positivos a la izquierda y algunos números

186
00:10:59,862 --> 00:11:03,121
negativos a la derecha, que colorearé con azul y rojo respectivamente.

187
00:11:03,121 --> 00:11:06,284
Tómate un momento para ver si puedes predecir y

188
00:11:06,284 --> 00:11:09,843
comprender qué efecto tendrá esto en la imagen final.

189
00:11:09,843 --> 00:11:14,035
Entonces, en este caso, pensaré en la imagen en escala de grises en lugar de coloreada,

190
00:11:14,035 --> 00:11:18,133
de modo que cada uno de los píxeles esté representado por un número en lugar de tres.

191
00:11:18,133 --> 00:11:20,572
Y una cosa que vale la pena señalar es que al hacer

192
00:11:20,572 --> 00:11:23,152
esta convolución es posible obtener valores negativos.

193
00:11:23,152 --> 00:11:26,375
Por ejemplo, en este punto, si hacemos zoom, la mitad izquierda de nuestra

194
00:11:26,375 --> 00:11:29,597
pequeña cuadrícula se ubica completamente sobre los píxeles negros, lo que

195
00:11:29,597 --> 00:11:32,734
tendría un valor de cero, pero la mitad derecha de los valores negativos

196
00:11:32,734 --> 00:11:36,000
se ubicará sobre los píxeles blancos, lo que tendría tiene un valor de uno.

197
00:11:36,000 --> 00:11:39,282
Entonces, cuando multiplicamos los términos correspondientes y los sumamos, los

198
00:11:39,282 --> 00:11:42,687
resultados serán muy negativos, y la forma en que muestro esto con la imagen de la

199
00:11:42,687 --> 00:11:46,092
derecha es colorear los valores negativos en rojo y los valores positivos en azul.

200
00:11:46,092 --> 00:11:50,427
Otra cosa a tener en cuenta es que cuando estás en una zona que es del mismo color,

201
00:11:50,427 --> 00:11:54,917
todo llega a cero ya que la suma de los valores en nuestra pequeña cuadrícula es cero.

202
00:11:54,917 --> 00:11:57,644
Esto es muy diferente de los dos ejemplos anteriores donde la suma

203
00:11:57,644 --> 00:12:00,046
de nuestra pequeña cuadrícula era uno, lo que nos permitió

204
00:12:00,046 --> 00:12:03,057
interpretarla como una media móvil y, por tanto, como una imagen borrosa.

205
00:12:03,057 --> 00:12:07,539
En general, este pequeño proceso básicamente detecta dónde hay variación en el

206
00:12:07,539 --> 00:12:11,907
valor del píxel a medida que te mueves de izquierda a derecha, por lo que te

207
00:12:11,907 --> 00:12:16,560
brinda una especie de forma de detectar todos los bordes verticales de tu imagen.

208
00:12:16,560 --> 00:12:20,972
Y de manera similar, si rotamos esa cuadrícula para que varíe a medida que te mueves de

209
00:12:20,972 --> 00:12:25,384
arriba a abajo, esto se recogerá en todos los bordes horizontales, lo que en el caso de

210
00:12:25,384 --> 00:12:29,446
nuestra imagen de la pequeña criatura de pastel resulta en algunos ojos bastante

211
00:12:29,446 --> 00:12:30,048
demoníacos.

212
00:12:30,048 --> 00:12:32,686
Por cierto, esta cuadrícula más pequeña a menudo se llama kernel, y

213
00:12:32,686 --> 00:12:35,247
la belleza aquí es cómo simplemente eligiendo un kernel diferente

214
00:12:35,247 --> 00:12:37,847
puedes obtener diferentes efectos de procesamiento de imágenes, no

215
00:12:37,847 --> 00:12:40,757
solo desenfocar la detección de bordes sino también cosas como la nitidez.

216
00:12:40,757 --> 00:12:44,121
Para aquellos de ustedes que han oído hablar de una red neuronal

217
00:12:44,121 --> 00:12:47,899
convolucional, la idea es utilizar datos para determinar cuáles deberían

218
00:12:47,899 --> 00:12:51,677
ser los núcleos en primer lugar, según lo que determine la red neuronal.

219
00:12:51,677 --> 00:12:55,421
Otra cosa que tal vez debería mencionar es la duración de la salida.

220
00:12:55,421 --> 00:12:59,227
Para algo como el ejemplo de media móvil, es posible que solo desee pensar en los

221
00:12:59,227 --> 00:13:03,172
términos cuando ambas ventanas se alinean completamente entre sí, o en el ejemplo de

222
00:13:03,172 --> 00:13:07,349
procesamiento de imágenes, tal vez desee que la salida final tenga el mismo tamaño que el

223
00:13:07,349 --> 00:13:07,813
original.

224
00:13:07,813 --> 00:13:10,584
Ahora bien, las convoluciones como operación matemática pura siempre

225
00:13:10,584 --> 00:13:13,436
producen una matriz que es más grande que las dos matrices con las que

226
00:13:13,436 --> 00:13:16,448
comenzó, al menos asumiendo que una de ellas no tiene una longitud de uno.

227
00:13:16,448 --> 00:13:18,907
Solo sepa que en ciertos contextos informáticos

228
00:13:18,907 --> 00:13:21,520
a menudo desea truncar deliberadamente esa salida.

229
00:13:21,520 --> 00:13:25,570
Otra cosa que vale la pena destacar es que en el contexto de las ciencias de la

230
00:13:25,570 --> 00:13:29,772
computación esta noción de darle la vuelta a ese núcleo antes de dejarlo avanzar a

231
00:13:29,772 --> 00:13:33,873
través del original a menudo parece realmente extraña y simplemente innecesaria,

232
00:13:33,873 --> 00:13:38,126
pero nuevamente tenga en cuenta que eso es lo que se hereda del contexto matemático

233
00:13:38,126 --> 00:13:42,582
puro donde, como nosotros Vi con las probabilidades que es algo increíblemente natural.

234
00:13:42,582 --> 00:13:45,879
Y de hecho, puedo mostrarles un ejemplo más de matemáticas puras en el

235
00:13:45,879 --> 00:13:49,222
que incluso los programadores deberían preocuparse por este porque abre

236
00:13:49,222 --> 00:13:52,426
las puertas a un algoritmo mucho más rápido para calcular todo esto.

237
00:13:52,426 --> 00:13:56,004
Para configurar lo que quiero decir con más rápido aquí, déjame regresar y abrir

238
00:13:56,004 --> 00:13:59,627
algo de Python nuevamente y crearé dos matrices diferentes relativamente grandes.

239
00:13:59,627 --> 00:14:03,807
Cada uno tendrá cien mil elementos aleatorios y voy a evaluar el tiempo

240
00:14:03,807 --> 00:14:07,638
de ejecución de la función de convolución de la biblioteca numpy.

241
00:14:07,638 --> 00:14:12,078
Y en este caso lo ejecuta durante múltiples iteraciones diferentes, intenta encontrar un

242
00:14:12,078 --> 00:14:16,419
promedio y parece que en esta computadora al menos tiene un promedio de 4.87 segundos.

243
00:14:16,419 --> 00:14:21,119
Por el contrario, si uso una función diferente de la biblioteca scipy llamada

244
00:14:21,119 --> 00:14:25,819
fftconvolve, que es lo mismo pero implementado de manera diferente, solo toma

245
00:14:25,819 --> 00:14:30,640
4.3 milisegundos en promedio, es decir, una mejora de tres órdenes de magnitud.

246
00:14:30,640 --> 00:14:33,343
Y nuevamente, aunque tiene un nombre diferente, está dando el

247
00:14:33,343 --> 00:14:36,133
mismo resultado que la otra función de convolución, simplemente

248
00:14:36,133 --> 00:14:38,880
está haciendo algo para hacerlo de una manera más inteligente.

249
00:14:38,880 --> 00:14:43,553
Recuerde que en el ejemplo de probabilidad dije que otra forma de pensar

250
00:14:43,553 --> 00:14:48,163
en la convolución era crear esta tabla de todos los productos por pares

251
00:14:48,163 --> 00:14:52,581
y luego sumar esos productos por pares a lo largo de las diagonales.

252
00:14:52,581 --> 00:14:55,818
Por supuesto, no hay nada específico sobre la probabilidad. Cada vez que

253
00:14:55,818 --> 00:14:59,365
convolucionas dos listas diferentes de números, puedes pensarlo de esta manera.

254
00:14:59,365 --> 00:15:02,906
Crea este tipo de tabla de multiplicar con todos los productos por pares y luego

255
00:15:02,906 --> 00:15:06,447
cada suma a lo largo de la diagonal corresponde a uno de tus resultados finales.

256
00:15:06,447 --> 00:15:09,665
Un contexto en el que esta visión resulta especialmente

257
00:15:09,665 --> 00:15:12,481
natural es cuando se multiplican dos polinomios.

258
00:15:12,481 --> 00:15:16,015
Por ejemplo, permítanme tomar la pequeña cuadrícula que ya

259
00:15:16,015 --> 00:15:19,787
tenemos y reemplazar los términos superiores con 1, 2x y 3x al

260
00:15:19,787 --> 00:15:23,920
cuadrado y reemplazar los otros términos con 4, 5x y 6x al cuadrado.

261
00:15:23,920 --> 00:15:26,235
Ahora piense en lo que significa cuando creamos todos

262
00:15:26,235 --> 00:15:28,721
estos productos diferentes en pares entre las dos listas.

263
00:15:28,721 --> 00:15:32,796
Lo que estás haciendo es esencialmente expandir el producto completo de los dos

264
00:15:32,796 --> 00:15:37,379
polinomios que he escrito y luego, cuando sumas a lo largo de la diagonal que corresponde

265
00:15:37,379 --> 00:15:41,607
a recolectar todos los términos semejantes, lo cual es bastante bueno, expandir un

266
00:15:41,607 --> 00:15:46,139
polinomio y recolectar términos semejantes es exactamente lo mismo. El mismo proceso que

267
00:15:46,139 --> 00:15:47,005
una convolución.

268
00:15:47,005 --> 00:15:50,129
Pero esto nos permite hacer algo muy bueno porque

269
00:15:50,129 --> 00:15:52,690
piensen en lo que estamos diciendo aquí.

270
00:15:52,690 --> 00:15:56,642
Estamos diciendo que si tomas dos funciones diferentes y las multiplicas,

271
00:15:56,642 --> 00:16:00,541
que es una operación puntual simple, es lo mismo que si primero hubieras

272
00:16:00,541 --> 00:16:04,708
extraído los coeficientes de cada una de ellas, asumiendo que son polinomios,

273
00:16:04,708 --> 00:16:08,820
y luego hubieras tomado una convolución de esas. dos listas de coeficientes.

274
00:16:08,820 --> 00:16:13,158
Lo que hace que esto sea tan interesante es que las convoluciones parecen, en principio,

275
00:16:13,158 --> 00:16:17,496
mucho más complicadas que una simple multiplicación y no me refiero sólo conceptualmente

276
00:16:17,496 --> 00:16:21,737
a que son más difíciles de pensar, sino que computacionalmente requiere más pasos para

277
00:16:21,737 --> 00:16:26,124
realizar una convolución que para realizar una Producto puntual de dos listas diferentes.

278
00:16:26,124 --> 00:16:29,992
Por ejemplo, digamos que te di dos polinomios realmente grandes, digamos cada

279
00:16:29,992 --> 00:16:34,109
uno con cien coeficientes diferentes, entonces, si la forma en que los multiplicas

280
00:16:34,109 --> 00:16:38,076
fuera expandir este producto, ya sabes, completando esta cuadrícula completa de

281
00:16:38,076 --> 00:16:42,044
100 por 100 de productos por pares que requerirían que realice 10.000 productos

282
00:16:42,044 --> 00:16:46,012
diferentes y luego, cuando recopile todos los términos semejantes a lo largo de

283
00:16:46,012 --> 00:16:49,731
las diagonales, ese será otro conjunto de alrededor de 10.000 operaciones.

284
00:16:49,731 --> 00:16:53,413
De manera más general, en la jerga diríamos que el algoritmo es O de n

285
00:16:53,413 --> 00:16:57,094
al cuadrado, lo que significa que para dos listas de tamaño n la forma

286
00:16:57,094 --> 00:17:00,880
en que el número de operaciones escala es proporcional al cuadrado de n.

287
00:17:00,880 --> 00:17:05,710
Por otro lado, si pienso en dos polinomios en términos de sus salidas, por ejemplo,

288
00:17:05,710 --> 00:17:10,656
muestreando sus valores en un puñado de entradas, multiplicarlos solo requiere tantas

289
00:17:10,656 --> 00:17:15,774
operaciones como el número de muestras, ya que nuevamente es una operación puntual y con

290
00:17:15,774 --> 00:17:20,374
polinomios solo necesitas un número finito de muestras para poder recuperar los

291
00:17:20,374 --> 00:17:21,179
coeficientes.

292
00:17:21,179 --> 00:17:25,261
Por ejemplo, dos salidas son suficientes para especificar de forma única un polinomio

293
00:17:25,261 --> 00:17:29,296
lineal, tres salidas serían suficientes para especificar de forma única un polinomio

294
00:17:29,296 --> 00:17:33,094
cuadrático y, en general, si conoce n salidas distintas, eso es suficiente para

295
00:17:33,094 --> 00:17:37,129
especificar de forma única un polinomio que tiene n coeficientes diferentes o, si lo

296
00:17:37,129 --> 00:17:41,259
prefiere, podríamos Expresa esto en el lenguaje de los sistemas de ecuaciones. Imagina

297
00:17:41,259 --> 00:17:45,483
que te digo que tengo un polinomio pero no te digo cuáles son los coeficientes. Esos son

298
00:17:45,483 --> 00:17:46,480
un misterio para ti.

299
00:17:46,480 --> 00:17:50,392
En nuestro ejemplo, podrías pensar en esto como el producto que estamos tratando de

300
00:17:50,392 --> 00:17:54,443
calcular y luego supongamos que te diré cuáles serían las salidas de este polinomio si

301
00:17:54,443 --> 00:17:58,354
ingresaras varias entradas diferentes como 0, 1, 2. , 3, una y otra vez y te doy lo

302
00:17:58,354 --> 00:18:02,312
suficiente para que tengas tantas ecuaciones como incógnitas, incluso resulta ser un

303
00:18:02,312 --> 00:18:06,502
sistema lineal de ecuaciones, así que eso es bueno y, en principio, al menos esto debería

304
00:18:06,502 --> 00:18:10,600
ser suficiente para recuperar los coeficientes.

305
00:18:10,600 --> 00:18:11,112



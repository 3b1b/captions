1
00:00:00,000 --> 00:00:02,398
Suponha que eu lhe dê duas listas diferentes de números,

2
00:00:02,398 --> 00:00:05,301
ou talvez duas funções diferentes, e peça que você pense em todas as

3
00:00:05,301 --> 00:00:08,205
maneiras pelas quais você pode combinar essas duas listas para obter

4
00:00:08,205 --> 00:00:11,782
uma nova lista de números, ou combinar as duas funções para obter uma nova função. .

5
00:00:11,782 --> 00:00:14,221
Talvez uma maneira simples que venha à mente seja

6
00:00:14,221 --> 00:00:16,320
simplesmente adicioná-los termo por termo.

7
00:00:16,320 --> 00:00:20,131
Da mesma forma com as funções, você pode adicionar todas as saídas correspondentes.

8
00:00:20,131 --> 00:00:23,327
Na mesma linha, você também pode multiplicar as duas listas

9
00:00:23,327 --> 00:00:26,202
termo por termo e fazer a mesma coisa com as funções.

10
00:00:26,202 --> 00:00:30,431
Mas há outro tipo de combinação tão fundamental quanto essas duas,

11
00:00:30,431 --> 00:00:33,840
mas muito menos discutida, conhecida como convolução.

12
00:00:33,840 --> 00:00:36,142
Mas, diferentemente dos dois casos anteriores,

13
00:00:36,142 --> 00:00:39,964
não é algo meramente herdado de uma operação que você pode fazer com números.

14
00:00:39,964 --> 00:00:44,756
É algo genuinamente novo para o contexto de listas de números ou de combinação de funções.

15
00:00:44,756 --> 00:00:44,809


16
00:00:44,809 --> 00:00:48,904
Eles aparecem em todos os lugares, são onipresentes no processamento de imagens,

17
00:00:48,904 --> 00:00:51,684
são uma construção central na teoria da probabilidade,

18
00:00:51,684 --> 00:00:55,626
são muito usados na resolução de equações diferenciais e são um contexto onde

19
00:00:55,626 --> 00:00:58,457
você quase certamente já os viu, se não. com este nome,

20
00:00:58,457 --> 00:01:00,277
está multiplicando dois polinômios.

21
00:01:00,277 --> 00:01:04,714
Como alguém no ramo de explicações visuais, este é um tópico especialmente excelente,

22
00:01:04,714 --> 00:01:08,790
porque a definição formulada isoladamente e sem contexto pode parecer um pouco

23
00:01:08,790 --> 00:01:13,330
intimidante, mas se reservarmos um tempo para realmente desvendar o que está dizendo e,

24
00:01:13,330 --> 00:01:16,890
antes disso, realmente motivar o porquê você gostaria de algo assim,

25
00:01:16,890 --> 00:01:18,800
é uma operação incrivelmente bonita.

26
00:01:18,800 --> 00:01:23,514
E tenho que admitir, na verdade aprendi uma coisinha ao montar o visual deste projeto.

27
00:01:23,514 --> 00:01:25,735
No caso da convolução de duas funções diferentes,

28
00:01:25,735 --> 00:01:29,288
eu estava tentando pensar em maneiras diferentes de imaginar o que isso poderia

29
00:01:29,288 --> 00:01:32,753
significar, e com uma delas tive um momento de surpresa para saber por que as

30
00:01:32,753 --> 00:01:36,306
distribuições normais desempenham o papel que eles fazem isso em probabilidade,

31
00:01:36,306 --> 00:01:38,483
por que é uma forma tão natural para uma função.

32
00:01:38,483 --> 00:01:41,645
Mas estou me adiantando, há muita configuração para isso.

33
00:01:41,645 --> 00:01:45,766
Neste vídeo, nosso foco principal será apenas no caso discreto e, em particular,

34
00:01:45,766 --> 00:01:50,293
na construção de um algoritmo muito inesperado, mas muito inteligente, para calculá-los.

35
00:01:50,293 --> 00:01:54,400
E vou estender a discussão do caso contínuo para uma segunda parte.

36
00:01:54,400 --> 00:01:58,206
É muito tentador começar com os exemplos de processamento de imagem,

37
00:01:58,206 --> 00:02:00,910
já que eles são visualmente os mais intrigantes,

38
00:02:00,910 --> 00:02:05,820
mas há alguns detalhes que tornam o caso de processamento de imagem menos representativo

39
00:02:05,820 --> 00:02:10,234
das convoluções em geral, então, em vez disso, vamos começar com probabilidade,

40
00:02:10,234 --> 00:02:14,703
e em particular um dos exemplos mais simples que tenho certeza que todos aqui já

41
00:02:14,703 --> 00:02:19,227
pensaram em algum momento de suas vidas, que é lançar um par de dados e descobrir

42
00:02:19,227 --> 00:02:21,600
as chances de ver várias somas diferentes.

43
00:02:21,600 --> 00:02:24,213
E você pode dizer, não é um problema, não é um problema.

44
00:02:24,213 --> 00:02:27,663
Cada um dos seus dois dados tem seis resultados possíveis diferentes,

45
00:02:27,663 --> 00:02:31,065
o que nos dá um total de 36 pares distintos de resultados possíveis,

46
00:02:31,065 --> 00:02:34,712
e se apenas olharmos para todos eles podemos contar quantos pares têm uma

47
00:02:34,712 --> 00:02:35,600
determinada soma.

48
00:02:35,600 --> 00:02:38,544
E organizando todos os pares numa grelha como esta,

49
00:02:38,544 --> 00:02:43,640
uma coisa muito boa é que todos os pares que têm uma soma constante são visíveis ao longo

50
00:02:43,640 --> 00:02:45,678
de uma destas diagonais diferentes.

51
00:02:45,678 --> 00:02:48,706
Portanto, simplesmente contar quantos existem em cada uma dessas

52
00:02:48,706 --> 00:02:51,920
diagonais lhe dirá a probabilidade de você ver uma determinada soma.

53
00:02:51,920 --> 00:02:55,443
E eu diria, muito bom, muito bom, mas você consegue pensar

54
00:02:55,443 --> 00:02:58,788
em alguma outra maneira de visualizar a mesma pergunta?

55
00:02:58,788 --> 00:03:01,382
Outras imagens que podem vir à mente ao pensar em todos

56
00:03:01,382 --> 00:03:03,836
os pares distintos que possuem uma determinada soma?

57
00:03:03,836 --> 00:03:07,586
E talvez um de vocês levante a mão e diga: sim, tenho um.

58
00:03:07,586 --> 00:03:11,458
Digamos que você imagine esses dois conjuntos diferentes de possibilidades,

59
00:03:11,458 --> 00:03:14,056
cada um seguido, mas você inverte a segunda linha.

60
00:03:14,056 --> 00:03:18,984
Dessa forma, todos os pares diferentes que somam sete se alinham verticalmente assim.

61
00:03:18,984 --> 00:03:22,138
E se deslizarmos a linha inferior totalmente para a direita,

62
00:03:22,138 --> 00:03:26,380
então o único par que soma dois, os olhos de cobra, são os únicos que se alinham.

63
00:03:26,380 --> 00:03:29,135
E se eu deslocar isso uma unidade para a direita,

64
00:03:29,135 --> 00:03:32,938
os pares que se alinham são os dois pares diferentes que somam três.

65
00:03:32,938 --> 00:03:36,523
E, em geral, diferentes valores de deslocamento desta matriz inferior,

66
00:03:36,523 --> 00:03:41,017
que lembro que tive que virar primeiro, revelam todos os pares distintos que possuem uma

67
00:03:41,017 --> 00:03:41,926
determinada soma.

68
00:03:41,926 --> 00:03:44,782
No que diz respeito às questões de probabilidade,

69
00:03:44,782 --> 00:03:48,379
isto ainda não é especialmente interessante, porque tudo o que

70
00:03:48,379 --> 00:03:53,120
estamos a fazer é contar quantos resultados existem em cada uma destas categorias.

71
00:03:53,120 --> 00:03:55,530
Mas isso ocorre com a suposição implícita de que há

72
00:03:55,530 --> 00:03:57,941
uma chance igual de cada uma dessas faces aparecer.

73
00:03:57,941 --> 00:04:01,909
Mas e se eu lhe dissesse que tenho um conjunto especial de dados que não é uniforme?

74
00:04:01,909 --> 00:04:05,758
Talvez o dado azul tenha seu próprio conjunto de números que descreve as probabilidades

75
00:04:05,758 --> 00:04:09,388
de cada face que aparece, e o dado vermelho tenha seu próprio conjunto distinto de

76
00:04:09,388 --> 00:04:09,782
números.

77
00:04:09,782 --> 00:04:14,154
Nesse caso, se quiser descobrir, digamos, a probabilidade de ver um dois,

78
00:04:14,154 --> 00:04:19,471
multiplicaria a probabilidade de o dado azul ser um pela probabilidade de o dado vermelho

79
00:04:19,471 --> 00:04:19,943
ser um.

80
00:04:19,943 --> 00:04:23,323
E para as chances de ver um três, você olha para os dois pares

81
00:04:23,323 --> 00:04:26,488
distintos onde isso é possível e, novamente, multiplica as

82
00:04:26,488 --> 00:04:30,029
probabilidades correspondentes e depois soma esses dois produtos.

83
00:04:30,029 --> 00:04:33,517
Da mesma forma, as chances de ver um quatro envolvem multiplicar

84
00:04:33,517 --> 00:04:36,845
três pares diferentes de possibilidades e adicioná-los todos.

85
00:04:36,845 --> 00:04:39,132
E no espírito de estabelecer algumas fórmulas,

86
00:04:39,132 --> 00:04:41,955
vamos nomear essas probabilidades superiores como a1, a2,

87
00:04:41,955 --> 00:04:45,946
a3 e assim por diante, e nomear as inferiores como b1, b2, b3 e assim por diante.

88
00:04:45,946 --> 00:04:50,009
E, em geral, este processo, onde pegamos duas matrizes diferentes de números,

89
00:04:50,009 --> 00:04:54,644
invertemos a segunda e depois as alinhamos em vários valores de deslocamento diferentes,

90
00:04:54,644 --> 00:04:57,353
pegamos um monte de produtos em pares e os somamos,

91
00:04:57,353 --> 00:05:01,311
esse é um dos maneiras fundamentais de pensar sobre o que é uma convolução.

92
00:05:01,311 --> 00:05:06,075
Então, só para explicar com mais exatidão, por meio desse processo,

93
00:05:06,075 --> 00:05:11,469
geramos probabilidades de ver dois, três, quatro, e assim por diante até 12,

94
00:05:11,469 --> 00:05:17,143
e as obtivemos misturando uma lista de valores, a, e outra. lista de valores, b.

95
00:05:17,143 --> 00:05:21,607
Na linguagem, diríamos que a convolução dessas duas sequências nos dá esta nova

96
00:05:21,607 --> 00:05:26,574
sequência, a nova sequência de 11 valores, cada um dos quais parece uma soma de produtos

97
00:05:26,574 --> 00:05:27,188
aos pares.

98
00:05:27,188 --> 00:05:32,049
Se preferir, outra maneira de pensar na mesma operação é primeiro criar uma tabela

99
00:05:32,049 --> 00:05:36,793
de todos os produtos aos pares e depois somar ao longo de todas essas diagonais.

100
00:05:36,793 --> 00:05:39,738
Novamente, essa é uma maneira de misturar essas duas sequências

101
00:05:39,738 --> 00:05:42,315
de números para obter uma nova sequência de 11 números.

102
00:05:42,315 --> 00:05:46,400
É a mesma operação que se pensava nas janelas de correr, apenas outra perspectiva.

103
00:05:46,400 --> 00:05:50,335
Colocando uma pequena notação nisso, veja como você pode vê-lo escrito.

104
00:05:50,335 --> 00:05:54,950
A convolução de a e b, denotada por este pequeno asterisco, é uma nova lista,

105
00:05:54,950 --> 00:05:57,909
e o enésimo elemento dessa lista parece uma soma,

106
00:05:57,909 --> 00:06:01,756
e essa soma abrange todos os diferentes pares de índices, i e j,

107
00:06:01,756 --> 00:06:04,833
de modo que a soma de esses índices são iguais a n.

108
00:06:04,833 --> 00:06:08,061
É meio complicado, mas por exemplo, se n fosse 6,

109
00:06:08,061 --> 00:06:12,645
os pares que estamos examinando são 1 e 5, 2 e 4, 3 e 3, 4 e 2, 5 e 1,

110
00:06:12,645 --> 00:06:15,680
todos os pares diferentes que se somam para 6.

111
00:06:15,680 --> 00:06:18,119
Mas, honestamente, não importa como você escreva,

112
00:06:18,119 --> 00:06:21,877
a notação é de importância secundária em relação ao visual que você pode ter

113
00:06:21,877 --> 00:06:23,145
em mente para o processo.

114
00:06:23,145 --> 00:06:26,198
Aqui, talvez ajude fazer um exemplo super simples,

115
00:06:26,198 --> 00:06:30,987
onde posso perguntar qual é a convolução da lista 1, 2, 3, com a lista 4, 5, 6.

116
00:06:30,987 --> 00:06:34,267
Você pode imaginar pegar essas duas listas, virar a

117
00:06:34,267 --> 00:06:37,926
segunda e começar com a tampa totalmente para a esquerda.

118
00:06:37,926 --> 00:06:40,437
Então, o par de valores que se alinham são 1 e 4,

119
00:06:40,437 --> 00:06:43,851
multiplique-os e isso nos dará nosso primeiro termo de nossa saída.

120
00:06:43,851 --> 00:06:46,971
Deslize a matriz inferior uma unidade para a direita,

121
00:06:46,971 --> 00:06:50,900
os pares que se alinham são 1 e 5 e 2 e 4, multiplique esses pares,

122
00:06:50,900 --> 00:06:54,367
some-os e isso nos dá 13, a próxima entrada em nossa saída.

123
00:06:54,367 --> 00:06:58,340
Deslize as coisas mais uma vez e pegaremos 1 vezes 6,

124
00:06:58,340 --> 00:07:01,651
mais 2 vezes 5, mais 3 vezes 4, o que dá 28.

125
00:07:01,651 --> 00:07:06,318
Mais um slide e obtemos 2 vezes 6, mais 3 vezes 5, e isso nos dá 27 e,

126
00:07:06,318 --> 00:07:10,000
finalmente, o último termo será parecido com 3 vezes 6.

127
00:07:10,000 --> 00:07:12,867
Se desejar, você pode acessar qualquer que seja sua linguagem de

128
00:07:12,867 --> 00:07:16,660
programação favorita e sua biblioteca favorita que inclui várias operações numéricas,

129
00:07:16,660 --> 00:07:18,910
e pode confirmar que não estou mentindo para você.

130
00:07:18,910 --> 00:07:21,587
Se você pegar a convolução de 1, 2, 3, contra 4,

131
00:07:21,587 --> 00:07:24,320
5, 6, este é de fato o resultado que você obterá.

132
00:07:24,320 --> 00:07:27,826
Vimos um caso em que esta é uma operação natural e desejável,

133
00:07:27,826 --> 00:07:32,916
somando-se a distribuições de probabilidade, e outro exemplo comum seria uma média móvel.

134
00:07:32,916 --> 00:07:35,833
Imagine que você tem uma longa lista de números

135
00:07:35,833 --> 00:07:38,811
e pega outra lista menor de números que somam 1.

136
00:07:38,811 --> 00:07:43,420
Nesse caso, tenho apenas uma pequena lista de 5 valores, e todos são iguais a 1 quinto.

137
00:07:43,420 --> 00:07:47,130
Então, se fizermos esse processo de convolução de janela deslizante,

138
00:07:47,130 --> 00:07:51,700
fecharmos os olhos e varrermos para debaixo do tapete o que acontece logo no início,

139
00:07:51,700 --> 00:07:55,732
uma vez que nossa lista menor de valores se sobrepõe inteiramente à maior,

140
00:07:55,732 --> 00:07:59,066
pense no que cada termo neste convolução realmente significa.

141
00:07:59,066 --> 00:08:02,899
A cada iteração, o que você faz é multiplicar cada um dos valores

142
00:08:02,899 --> 00:08:06,732
dos seus dados por 1/5 e somá-los todos, o que significa que você

143
00:08:06,732 --> 00:08:10,797
está calculando uma média dos seus dados dentro desta pequena janela.

144
00:08:10,797 --> 00:08:14,270
No geral, o processo fornece uma versão suavizada dos dados originais,

145
00:08:14,270 --> 00:08:18,231
e você pode modificar isso começando com uma pequena lista diferente de números,

146
00:08:18,231 --> 00:08:20,530
e contanto que toda essa pequena lista some 1,

147
00:08:20,530 --> 00:08:22,878
você ainda pode interpretá-la como uma mudança.

148
00:08:22,878 --> 00:08:27,822
média. No exemplo mostrado aqui, essa média móvel daria mais peso ao valor central.

149
00:08:27,822 --> 00:08:30,720
Isso também resulta em uma versão suavizada dos dados.

150
00:08:30,720 --> 00:08:34,563
Se você fizer um análogo bidimensional disso, terá um

151
00:08:34,563 --> 00:08:38,691
algoritmo divertido para desfocar uma determinada imagem.

152
00:08:38,691 --> 00:08:42,767
E devo dizer que as animações que estou prestes a mostrar são modificadas de algo que fiz

153
00:08:42,767 --> 00:08:46,797
originalmente para parte de um conjunto de palestras que fiz com o Julia Lab no MIT para

154
00:08:46,797 --> 00:08:50,872
uma determinada aula do OpenCourseWare que incluía uma unidade de processamento de imagem.

155
00:08:50,872 --> 00:08:50,918


156
00:08:50,918 --> 00:08:54,076
Lá fizemos um pouco mais para mergulhar no código por trás de tudo isso,

157
00:08:54,076 --> 00:08:56,456
então se você estiver curioso vou deixar alguns links.

158
00:08:56,456 --> 00:08:58,740
Mas focando novamente neste exemplo desfocado,

159
00:08:58,740 --> 00:09:02,871
o que está acontecendo é que eu tenho uma pequena grade 3x3 de valores que marcha ao

160
00:09:02,871 --> 00:09:07,051
longo de nossa imagem original, e se aumentarmos o zoom, cada um desses valores é 19,

161
00:09:07,051 --> 00:09:11,231
e o que estou fazendo em cada iteração está multiplicando cada um desses valores pelo

162
00:09:11,231 --> 00:09:13,369
pixel correspondente sobre o qual ele está.

163
00:09:13,369 --> 00:09:16,744
E é claro que na ciência da computação pensamos nas cores como pequenos

164
00:09:16,744 --> 00:09:20,400
vetores de três valores, representando os componentes vermelho, verde e azul.

165
00:09:20,400 --> 00:09:24,197
Quando multiplico todos esses pequenos valores por 19 e os adiciono,

166
00:09:24,197 --> 00:09:26,893
obtemos uma média ao longo de cada canal de cor,

167
00:09:26,893 --> 00:09:31,075
e o pixel correspondente para a imagem à direita é definido como essa soma.

168
00:09:31,075 --> 00:09:34,515
O efeito geral, ao fazermos isso para cada pixel da imagem,

169
00:09:34,515 --> 00:09:37,554
é que cada um se infiltra em todos os seus vizinhos,

170
00:09:37,554 --> 00:09:40,880
o que nos dá uma versão mais desfocada do que a original.

171
00:09:40,880 --> 00:09:44,469
Na linguagem diríamos que a imagem à direita é uma convolução

172
00:09:44,469 --> 00:09:47,885
da nossa imagem original com uma pequena grade de valores.

173
00:09:47,885 --> 00:09:51,103
Ou, mais tecnicamente, talvez eu devesse dizer que é a convolução

174
00:09:51,103 --> 00:09:54,468
com uma versão girada em 180 graus daquela pequena grade de valores.

175
00:09:54,468 --> 00:09:57,041
Não que isso importe quando a grade é simétrica,

176
00:09:57,041 --> 00:10:00,403
mas vale a pena ter em mente que a definição de uma convolução,

177
00:10:00,403 --> 00:10:04,184
herdada do contexto matemático puro, deve sempre convidá-lo a pensar em

178
00:10:04,184 --> 00:10:05,760
inverter essa segunda matriz.

179
00:10:05,760 --> 00:10:09,406
Se modificarmos um pouco isso, poderemos obter um efeito de desfoque muito mais elegante,

180
00:10:09,406 --> 00:10:11,148
escolhendo uma grade de valores diferente.

181
00:10:11,148 --> 00:10:15,920
Neste caso tenho uma pequena grade 5x5, mas a distinção não é tanto o seu tamanho.

182
00:10:15,920 --> 00:10:19,314
Se aumentarmos o zoom, notamos que o valor no meio é muito maior do que o

183
00:10:19,314 --> 00:10:22,570
valor nas bordas, e de onde isso vem é que todos eles são amostrados a

184
00:10:22,570 --> 00:10:26,102
partir de uma curva em forma de sino, conhecida como distribuição gaussiana.

185
00:10:26,102 --> 00:10:29,566
Dessa forma, quando multiplicamos todos esses valores pelo pixel

186
00:10:29,566 --> 00:10:33,029
correspondente sobre o qual eles estão, estamos dando muito mais

187
00:10:33,029 --> 00:10:36,439
peso a esse pixel central e muito menos aos que estão na borda.

188
00:10:36,439 --> 00:10:40,475
E assim como antes, o pixel correspondente à direita é definido como esta soma.

189
00:10:40,475 --> 00:10:43,282
À medida que fazemos esse processo para cada pixel,

190
00:10:43,282 --> 00:10:47,924
ocorre um efeito de desfoque que simula com muito mais autenticidade a noção de tirar

191
00:10:47,924 --> 00:10:49,760
o foco da lente ou algo parecido.

192
00:10:49,760 --> 00:10:53,504
Mas desfocar está longe de ser a única coisa que você pode fazer com essa ideia.

193
00:10:53,504 --> 00:10:56,348
Por exemplo, dê uma olhada nesta pequena grade de valores,

194
00:10:56,348 --> 00:11:00,495
que envolve alguns números positivos à esquerda e alguns números negativos à direita,

195
00:11:00,495 --> 00:11:03,099
que irei colorir com azul e vermelho respectivamente.

196
00:11:03,099 --> 00:11:06,486
Reserve um momento para ver se você consegue prever

197
00:11:06,486 --> 00:11:09,808
e entender o efeito que isso terá na imagem final.

198
00:11:09,808 --> 00:11:13,879
Então, neste caso, pensarei na imagem apenas em tons de cinza em vez de colorida,

199
00:11:13,879 --> 00:11:18,149
de modo que cada um dos pixels seja representado apenas por um número em vez de três.

200
00:11:18,149 --> 00:11:20,502
E uma coisa que vale a pena notar é que à medida que

201
00:11:20,502 --> 00:11:23,164
fazemos esta convolução é possível obter valores negativos.

202
00:11:23,164 --> 00:11:26,995
Por exemplo, neste ponto aqui, se ampliarmos a metade esquerda de nossa pequena grade,

203
00:11:26,995 --> 00:11:30,429
ela ficará inteiramente em cima dos pixels pretos, o que teria um valor zero,

204
00:11:30,429 --> 00:11:34,127
mas a metade direita dos valores negativos ficaria toda em cima dos pixels brancos,

205
00:11:34,127 --> 00:11:35,360
o que teria tem o valor um.

206
00:11:35,360 --> 00:11:38,446
Então, quando multiplicamos os termos correspondentes e os somamos,

207
00:11:38,446 --> 00:11:41,941
os resultados serão muito negativos, e a maneira como estou exibindo isso na

208
00:11:41,941 --> 00:11:45,709
imagem à direita é colorir os valores negativos em vermelho e os valores positivos

209
00:11:45,709 --> 00:11:46,117
em azul.

210
00:11:46,117 --> 00:11:50,578
Outra coisa a notar é que quando você está em um patch que é todo da mesma cor,

211
00:11:50,578 --> 00:11:54,871
tudo vai para zero, já que a soma dos valores em nossa pequena grade é zero.

212
00:11:54,871 --> 00:11:57,334
Isto é muito diferente dos dois exemplos anteriores,

213
00:11:57,334 --> 00:12:01,284
onde a soma da nossa pequena grelha era um, o que nos permite interpretá-la como uma

214
00:12:01,284 --> 00:12:03,050
média móvel e, portanto, um desfoque.

215
00:12:03,050 --> 00:12:06,477
Resumindo, esse pequeno processo basicamente detecta onde quer que haja

216
00:12:06,477 --> 00:12:10,237
variação no valor do pixel conforme você se move da esquerda para a direita e,

217
00:12:10,237 --> 00:12:13,760
assim, oferece uma maneira de captar todas as bordas verticais da imagem.

218
00:12:13,760 --> 00:12:19,201
E da mesma forma, se girarmos essa grade de modo que ela varie conforme você se move

219
00:12:19,201 --> 00:12:23,682
de cima para baixo, isso será captado em todas as bordas horizontais,

220
00:12:23,682 --> 00:12:28,867
o que no caso da imagem da nossa pequena criatura torta resulta em alguns lindos

221
00:12:28,867 --> 00:12:30,020
olhos demoníacos.

222
00:12:30,020 --> 00:12:33,501
A propósito, essa grade menor costuma ser chamada de kernel, e a beleza aqui é como,

223
00:12:33,501 --> 00:12:36,655
apenas escolhendo um kernel diferente, você pode obter diferentes efeitos de

224
00:12:36,655 --> 00:12:39,481
processamento de imagem, não apenas desfocando a detecção de bordas,

225
00:12:39,481 --> 00:12:40,792
mas também coisas como nitidez.

226
00:12:40,792 --> 00:12:44,461
Para aqueles que já ouviram falar de uma rede neural convolucional,

227
00:12:44,461 --> 00:12:48,076
a ideia é usar dados para descobrir quais deveriam ser os kernels,

228
00:12:48,076 --> 00:12:51,691
conforme determinado por tudo o que a rede neural deseja detectar.

229
00:12:51,691 --> 00:12:55,457
Outra coisa que talvez eu deva mencionar é a duração da saída.

230
00:12:55,457 --> 00:12:59,583
Para algo como o exemplo da média móvel, você pode querer pensar apenas nos termos quando

231
00:12:59,583 --> 00:13:02,700
ambas as janelas estiverem totalmente alinhadas uma com a outra ou,

232
00:13:02,700 --> 00:13:06,826
no exemplo de processamento de imagem, talvez você queira que a saída final tenha o mesmo

233
00:13:06,826 --> 00:13:07,789
tamanho do original.

234
00:13:07,789 --> 00:13:10,795
Agora, as convoluções como uma operação matemática pura sempre produzem

235
00:13:10,795 --> 00:13:13,717
um array que é maior do que os dois arrays com os quais você começou,

236
00:13:13,717 --> 00:13:16,431
pelo menos assumindo que um deles não tenha o comprimento de um.

237
00:13:16,431 --> 00:13:18,995
Saiba apenas que, em certos contextos da ciência da computação,

238
00:13:18,995 --> 00:13:21,440
muitas vezes você deseja truncar deliberadamente essa saída.

239
00:13:21,440 --> 00:13:26,070
Outra coisa que vale a pena destacar é que, no contexto da ciência da computação,

240
00:13:26,070 --> 00:13:30,080
essa noção de inverter o kernel antes de deixá-lo percorrer o original

241
00:13:30,080 --> 00:13:33,920
muitas vezes parece muito estranha e desnecessária, mas, novamente,

242
00:13:33,920 --> 00:13:37,760
observe que é isso que é herdado do contexto matemático puro, onde,

243
00:13:37,760 --> 00:13:42,560
como nós Vi com as probabilidades que é uma coisa incrivelmente natural de se fazer.

244
00:13:42,560 --> 00:13:45,823
E na verdade posso mostrar mais um exemplo de matemática pura onde

245
00:13:45,823 --> 00:13:49,086
até os programadores deveriam se preocupar com este porque abre as

246
00:13:49,086 --> 00:13:52,399
portas para um algoritmo muito mais rápido para calcular tudo isso.

247
00:13:52,399 --> 00:13:54,831
Para configurar o que quero dizer com mais rápido aqui,

248
00:13:54,831 --> 00:13:58,175
deixe-me voltar e puxar um pouco de python novamente e vou criar dois arrays

249
00:13:58,175 --> 00:13:59,651
relativamente grandes diferentes.

250
00:13:59,651 --> 00:14:03,625
Cada um terá cem mil elementos aleatórios e vou avaliar o

251
00:14:03,625 --> 00:14:07,598
tempo de execução da função convolve da biblioteca numpy.

252
00:14:07,598 --> 00:14:12,450
E neste caso ele executa várias iterações diferentes, tenta encontrar uma média,

253
00:14:12,450 --> 00:14:16,403
e parece que neste computador pelo menos a média é 4.87 segundos.

254
00:14:16,403 --> 00:14:21,661
Por outro lado, se eu usar uma função diferente da biblioteca scipy chamada fftconvolve,

255
00:14:21,661 --> 00:14:25,264
que é a mesma coisa, apenas implementada de forma diferente,

256
00:14:25,264 --> 00:14:30,580
leva apenas 4.3 milissegundos em média, ou seja, uma melhoria de três ordens de magnitude.

257
00:14:30,580 --> 00:14:30,640


258
00:14:30,640 --> 00:14:32,875
E, novamente, mesmo que voe com um nome diferente,

259
00:14:32,875 --> 00:14:35,636
ele está fornecendo a mesma saída que a outra função convolve,

260
00:14:35,636 --> 00:14:38,880
está apenas fazendo algo para fazer isso de uma maneira mais inteligente.

261
00:14:38,880 --> 00:14:41,758
Lembre-se de como, no exemplo da probabilidade,

262
00:14:41,758 --> 00:14:46,135
eu disse que outra maneira de pensar sobre a convolução seria criar esta

263
00:14:46,135 --> 00:14:49,313
tabela de todos os produtos aos pares e, em seguida,

264
00:14:49,313 --> 00:14:52,611
somar esses produtos aos pares ao longo das diagonais.

265
00:14:52,611 --> 00:14:55,050
É claro que não há nada específico para probabilidade.

266
00:14:55,050 --> 00:14:57,933
Sempre que você está reunindo duas listas diferentes de números,

267
00:14:57,933 --> 00:14:59,352
você pode pensar dessa maneira.

268
00:14:59,352 --> 00:15:02,947
Crie esse tipo de tabuada com todos os produtos aos pares e então cada

269
00:15:02,947 --> 00:15:06,492
soma ao longo da diagonal corresponde a um de seus resultados finais.

270
00:15:06,492 --> 00:15:09,823
Um contexto onde esta visão é especialmente natural

271
00:15:09,823 --> 00:15:12,513
é quando você multiplica dois polinômios.

272
00:15:12,513 --> 00:15:17,698
Por exemplo, deixe-me pegar a pequena grade que já temos e substituir os termos

273
00:15:17,698 --> 00:15:22,559
superiores por 1, 2x e 3x ao quadrado e substituir os outros termos por 4,

274
00:15:22,559 --> 00:15:23,920
5x e 6x ao quadrado.

275
00:15:23,920 --> 00:15:26,181
Agora pense no que significa quando criamos todos

276
00:15:26,181 --> 00:15:28,760
esses produtos diferentes em pares entre as duas listas.

277
00:15:28,760 --> 00:15:33,087
O que você está fazendo é essencialmente expandir o produto completo dos dois

278
00:15:33,087 --> 00:15:37,025
polinômios que escrevi e então, quando você soma ao longo da diagonal,

279
00:15:37,025 --> 00:15:41,408
isso corresponde à coleta de todos os termos semelhantes, o que é muito legal,

280
00:15:41,408 --> 00:15:45,901
expandir um polinômio e coletar termos semelhantes é exatamente o mesmo processo

281
00:15:45,901 --> 00:15:47,011
que uma convolução.

282
00:15:47,011 --> 00:15:52,696
Mas isso nos permite fazer algo muito legal, porque pense no que estamos dizendo aqui.

283
00:15:52,696 --> 00:15:56,879
Estamos dizendo que se você pegar duas funções diferentes e multiplicá-las,

284
00:15:56,879 --> 00:16:01,006
o que é uma operação pontual simples, é a mesma coisa que se você primeiro

285
00:16:01,006 --> 00:16:05,079
extraísse os coeficientes de cada uma delas, assumindo que são polinômios

286
00:16:05,079 --> 00:16:08,821
e depois fizesse uma convolução dessas duas listas de coeficientes.

287
00:16:08,821 --> 00:16:12,501
O que torna isso tão interessante é que as convoluções parecem, em princípio,

288
00:16:12,501 --> 00:16:15,898
muito mais complicadas do que a simples multiplicação e não quero dizer

289
00:16:15,898 --> 00:16:19,248
apenas conceitualmente, elas são mais difíceis de pensar, quero dizer,

290
00:16:19,248 --> 00:16:22,881
computacionalmente, são necessárias mais etapas para realizar uma convolução

291
00:16:22,881 --> 00:16:26,089
do que para realizar uma produto pontual de duas listas diferentes.

292
00:16:26,089 --> 00:16:29,801
Por exemplo, digamos que eu lhe dei dois polinômios realmente grandes,

293
00:16:29,801 --> 00:16:32,415
digamos, cada um com cem coeficientes diferentes,

294
00:16:32,415 --> 00:16:36,336
então se a maneira como você os multiplicou fosse expandindo este produto,

295
00:16:36,336 --> 00:16:40,310
você sabe preencher toda essa grade de 100 por 100 de produtos pareados que

296
00:16:40,310 --> 00:16:43,290
exigiriam que você execute 10.000 produtos diferentes e,

297
00:16:43,290 --> 00:16:47,054
quando você coletar todos os termos semelhantes ao longo das diagonais,

298
00:16:47,054 --> 00:16:49,773
haverá outro conjunto de cerca de 10.000 operações.

299
00:16:49,773 --> 00:16:54,162
De maneira mais geral, no jargão, diríamos que o algoritmo é O de n ao quadrado,

300
00:16:54,162 --> 00:16:57,846
significando para duas listas de tamanho n, da maneira que o número

301
00:16:57,846 --> 00:17:00,935
de escalas de operações é proporcional ao quadrado de n.

302
00:17:00,935 --> 00:17:05,946
Por outro lado, se eu pensar em dois polinômios em termos de suas saídas, por exemplo,

303
00:17:05,946 --> 00:17:10,842
amostrar seus valores em algumas entradas, então multiplicá-los requer apenas tantas

304
00:17:10,842 --> 00:17:15,737
operações quanto o número de amostras, já que novamente é uma operação pontual e com

305
00:17:15,737 --> 00:17:20,345
polinômios você só precisa um número finito de amostras para poder recuperar os

306
00:17:20,345 --> 00:17:21,152
coeficientes.

307
00:17:21,152 --> 00:17:23,139
Por exemplo, duas saídas são suficientes para

308
00:17:23,139 --> 00:17:25,214
especificar exclusivamente um polinômio linear.

309
00:17:25,214 --> 00:17:29,360
Três saídas seriam suficientes para especificar exclusivamente um polinômio quadrático.

310
00:17:29,360 --> 00:17:31,823
E, em geral, se você conhece n saídas distintas,

311
00:17:31,823 --> 00:17:35,544
isso é suficiente para especificar exclusivamente um polinômio que possui

312
00:17:35,544 --> 00:17:36,901
n coeficientes diferentes.

313
00:17:36,901 --> 00:17:41,188
Ou, se preferir, poderíamos expressar isso na linguagem dos sistemas de equações.

314
00:17:41,188 --> 00:17:43,236
Imagine que eu lhe diga que tenho um polinômio,

315
00:17:43,236 --> 00:17:46,480
mas não lhe diga quais são os coeficientes, eles são um mistério para você.

316
00:17:46,480 --> 00:17:50,666
Em nosso exemplo, você pode pensar nisso como o produto que estamos tentando descobrir.

317
00:17:50,666 --> 00:17:54,974
Então suponha que eu diga que vou apenas dizer quais seriam as saídas deste polinômio

318
00:17:54,974 --> 00:17:59,082
se você inserisse várias entradas diferentes como 0, 1, 2, 3, e assim por diante,

319
00:17:59,082 --> 00:18:03,190
e eu lhe daria o suficiente para que você tivesse tantas equações quanto você tem

320
00:18:03,190 --> 00:18:03,791
incógnitas.

321
00:18:03,791 --> 00:18:07,245
Acontece que é até um sistema linear de equações, então isso é legal.

322
00:18:07,245 --> 00:18:11,137
E, pelo menos em princípio, isto deveria ser suficiente para recuperar os coeficientes.

323
00:18:11,137 --> 00:18:13,611
Portanto, o esboço aproximado do algoritmo seria:

324
00:18:13,611 --> 00:18:16,432
sempre que você quiser convolver duas listas de números,

325
00:18:16,432 --> 00:18:19,253
trate-as como se fossem coeficientes de dois polinômios.

326
00:18:19,253 --> 00:18:22,323
Você amostra esses polinômios com saídas suficientes,

327
00:18:22,323 --> 00:18:25,451
multiplica essas amostras ponto a ponto e, em seguida,

328
00:18:25,451 --> 00:18:29,204
resolve o sistema para recuperar os coeficientes como uma maneira

329
00:18:29,204 --> 00:18:31,364
sorrateira de encontrar a convolução.

330
00:18:31,364 --> 00:18:35,448
E como afirmei até agora, pelo menos, alguns de vocês poderiam reclamar com razão:

331
00:18:35,448 --> 00:18:37,564
&quot;Grant, esse é um plano idiota&quot;.

332
00:18:37,564 --> 00:18:41,323
Porque, por um lado, apenas calcular todas essas amostras para um dos

333
00:18:41,323 --> 00:18:45,190
polinômios que conhecemos já assume a ordem de n operações ao quadrado,

334
00:18:45,190 --> 00:18:49,218
sem mencionar que resolver esse sistema certamente será computacionalmente

335
00:18:49,218 --> 00:18:52,656
tão difícil quanto apenas fazer a convolução em primeiro lugar.

336
00:18:52,656 --> 00:18:56,657
Então, claro que temos essa conexão entre multiplicação e convoluções,

337
00:18:56,657 --> 00:19:01,054
mas toda a complexidade acontece na tradução de um ponto de vista para outro.

338
00:19:01,054 --> 00:19:04,364
Mas há um truque, e aqueles que conhecem as transformadas

339
00:19:04,364 --> 00:19:07,673
de Fourier e o algoritmo FFT podem ver onde isso vai dar.

340
00:19:07,673 --> 00:19:09,598
Se você não está familiarizado com esses tópicos,

341
00:19:09,598 --> 00:19:12,176
o que estou prestes a dizer pode parecer completamente inesperado.

342
00:19:12,176 --> 00:19:14,923
Apenas saiba que existem certos caminhos que você poderia ter

343
00:19:14,923 --> 00:19:17,582
trilhado na matemática que tornam esse passo mais esperado.

344
00:19:17,582 --> 00:19:20,697
Basicamente, a ideia é que tenhamos liberdade de escolha aqui.

345
00:19:20,697 --> 00:19:24,298
Se, em vez de avaliar em algum conjunto arbitrário de entradas como 0,

346
00:19:24,298 --> 00:19:27,189
1, 2, 3 e assim por diante, você optar por avaliar em um

347
00:19:27,189 --> 00:19:30,080
conjunto especialmente selecionado de números complexos.

348
00:19:30,080 --> 00:19:33,416
Especificamente aqueles que ficam uniformemente espaçados no círculo unitário,

349
00:19:33,416 --> 00:19:34,894
conhecidos como raízes da unidade.

350
00:19:34,894 --> 00:19:37,364
Isso nos dá um sistema mais amigável.

351
00:19:37,364 --> 00:19:41,523
A ideia básica é que, ao encontrar um número em que as suas potências se

352
00:19:41,523 --> 00:19:46,023
enquadram neste padrão de ciclo, isso significa que o sistema que geramos terá

353
00:19:46,023 --> 00:19:49,783
muita redundância nos diferentes termos que você está calculando,

354
00:19:49,783 --> 00:19:53,429
e sendo inteligente sobre como você aproveita essa redundância,

355
00:19:53,429 --> 00:19:55,252
pode economizar muito trabalho.

356
00:19:55,252 --> 00:19:58,654
Este conjunto de resultados que escrevi tem um nome especial,

357
00:19:58,654 --> 00:20:02,166
é chamado de transformada discreta de Fourier dos coeficientes.

358
00:20:02,166 --> 00:20:05,533
E se você quiser saber mais, na verdade fiz outra palestra para a

359
00:20:05,533 --> 00:20:09,103
mesma aula da Julia no MIT, sobre transformadas discretas de Fourier.

360
00:20:09,103 --> 00:20:12,931
E também há um vídeo realmente excelente no canal Redutível falando sobre a

361
00:20:12,931 --> 00:20:17,263
transformada rápida de Fourier, que é um algoritmo para calculá-los mais rapidamente.

362
00:20:17,263 --> 00:20:20,595
Além disso, o Veritasium fez recentemente um vídeo muito bom sobre FFT,

363
00:20:20,595 --> 00:20:21,984
então você tem muitas opções.

364
00:20:21,984 --> 00:20:24,786
E esse algoritmo rápido é realmente o que importa para nós.

365
00:20:24,786 --> 00:20:27,113
Novamente, por causa de toda essa redundância,

366
00:20:27,113 --> 00:20:30,281
existe um método para ir dos coeficientes a todas essas saídas,

367
00:20:30,281 --> 00:20:33,153
onde em vez de fazer na ordem de n operações ao quadrado,

368
00:20:33,153 --> 00:20:35,678
você faz na ordem de n vezes o log de n operações,

369
00:20:35,678 --> 00:20:39,293
o que é muito muito melhor à medida que você escala para listas grandes.

370
00:20:39,293 --> 00:20:42,386
E o mais importante, esse algoritmo fft funciona nos dois sentidos.

371
00:20:42,386 --> 00:20:45,515
Também permite passar das saídas aos coeficientes.

372
00:20:45,515 --> 00:20:49,054
Então, juntando tudo, vamos dar uma olhada no esboço do nosso algoritmo.

373
00:20:49,054 --> 00:20:53,406
Agora podemos dizer que sempre que você recebe duas longas listas de números e deseja

374
00:20:53,406 --> 00:20:57,758
calcular sua convolução, primeiro calcule a transformada rápida de Fourier de cada um

375
00:20:57,758 --> 00:21:02,009
deles, o que no fundo da sua mente você pode pensar como tratá-los como eles são os

376
00:21:02,009 --> 00:21:06,108
coeficientes de um polinômio e avaliam-no em um conjunto de pontos especialmente

377
00:21:06,108 --> 00:21:06,766
selecionado.

378
00:21:06,766 --> 00:21:10,621
Em seguida, multiplique os dois resultados que você acabou de obter pontualmente,

379
00:21:10,621 --> 00:21:14,381
o que é bom e rápido, e então faça uma transformação rápida inversa de Fourier,

380
00:21:14,381 --> 00:21:18,282
e o que isso fornece é a maneira sorrateira de calcular a convolução que estávamos

381
00:21:18,282 --> 00:21:18,847
procurando.

382
00:21:18,847 --> 00:21:22,957
Mas desta vez envolve apenas O de n log n operações.

383
00:21:22,957 --> 00:21:24,865
Isso é muito legal para mim!

384
00:21:24,865 --> 00:21:27,723
Este contexto muito específico onde as convoluções aparecem,

385
00:21:27,723 --> 00:21:30,722
multiplicando dois polinômios, abre as portas para um algoritmo

386
00:21:30,722 --> 00:21:34,235
que é relevante em qualquer outro lugar onde as convoluções possam surgir.

387
00:21:34,235 --> 00:21:36,489
Se você quiser adicionar distribuições de probabilidade,

388
00:21:36,489 --> 00:21:38,822
faça um grande processamento de imagem, seja ela qual for.

389
00:21:38,822 --> 00:21:41,765
E eu acho que esse é um bom exemplo de por que você deveria

390
00:21:41,765 --> 00:21:45,002
ficar animado quando vê alguma operação ou conceito em matemática

391
00:21:45,002 --> 00:21:47,798
aparecer em muitas áreas aparentemente não relacionadas.

392
00:21:47,798 --> 00:21:51,967
Se você quiser um pouco de lição de casa, aqui está algo divertido de se pensar.

393
00:21:51,967 --> 00:21:54,963
Explique por que quando você multiplica dois números diferentes,

394
00:21:54,963 --> 00:21:58,374
apenas uma multiplicação comum, como todos aprendemos na escola primária,

395
00:21:58,374 --> 00:22:01,924
o que você faz é basicamente uma convolução entre os dígitos desses números.

396
00:22:01,924 --> 00:22:04,933
Existem algumas etapas adicionais com carregamentos e similares,

397
00:22:04,933 --> 00:22:06,785
mas a etapa principal é uma convolução.

398
00:22:06,785 --> 00:22:09,187
Tendo em conta a existência de um algoritmo rápido,

399
00:22:09,187 --> 00:22:12,698
o que isso significa é que se tivermos dois números inteiros muito grandes,

400
00:22:12,698 --> 00:22:16,624
então existe uma forma de determinar o seu produto que é mais rápida do que o método

401
00:22:16,624 --> 00:22:18,240
que aprendemos na escola primária.

402
00:22:18,240 --> 00:22:21,154
Que, em vez de exigir O de n operações quadradas,

403
00:22:21,154 --> 00:22:25,291
requer apenas O de n log n, o que nem parece que deveria ser possível.

404
00:22:25,291 --> 00:22:28,512
O problema é que antes que isso seja realmente útil na prática,

405
00:22:28,512 --> 00:22:31,280
seus números teriam que ser absolutamente monstruosos.

406
00:22:31,280 --> 00:22:34,445
Mesmo assim, é legal que tal algoritmo exista.

407
00:22:34,445 --> 00:22:42,495
A seguir voltaremos nossa atenção para o caso contínuo

408
00:22:42,495 --> 00:22:50,400
com foco especial nas distribuições de probabilidade.


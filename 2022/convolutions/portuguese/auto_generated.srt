1
00:00:00,000 --> 00:00:02,304
Suponha que eu lhe dê duas listas diferentes de números, 

2
00:00:02,304 --> 00:00:05,094
ou talvez duas funções diferentes, e peça que você pense em todas as 

3
00:00:05,094 --> 00:00:07,883
maneiras pelas quais você pode combinar essas duas listas para obter 

4
00:00:07,883 --> 00:00:11,320
uma nova lista de números, ou combinar as duas funções para obter uma nova função. . 

5
00:00:12,120 --> 00:00:14,614
Talvez uma maneira simples que venha à mente seja 

6
00:00:14,614 --> 00:00:16,760
simplesmente adicioná-los termo por termo. 

7
00:00:17,160 --> 00:00:19,920
Da mesma forma com as funções, você pode adicionar todas as saídas correspondentes. 

8
00:00:20,540 --> 00:00:23,245
Na mesma linha, você também pode multiplicar as duas listas 

9
00:00:23,245 --> 00:00:25,680
termo por termo e fazer a mesma coisa com as funções. 

10
00:00:26,360 --> 00:00:30,313
Mas há outro tipo de combinação tão fundamental quanto essas duas, 

11
00:00:30,313 --> 00:00:33,500
mas muito menos discutida, conhecida como convolução. 

12
00:00:34,080 --> 00:00:36,238
Mas, diferentemente dos dois casos anteriores, 

13
00:00:36,238 --> 00:00:39,820
não é algo meramente herdado de uma operação que você pode fazer com números. 

14
00:00:39,980 --> 00:00:44,648
É algo genuinamente novo para o contexto de listas de números ou de combinação de funções.

15
00:00:44,648 --> 00:00:44,700
 

16
00:00:45,320 --> 00:00:49,269
Eles aparecem em todos os lugares, são onipresentes no processamento de imagens, 

17
00:00:49,269 --> 00:00:51,951
são uma construção central na teoria da probabilidade, 

18
00:00:51,951 --> 00:00:55,754
são muito usados na resolução de equações diferenciais e são um contexto onde 

19
00:00:55,754 --> 00:00:58,484
você quase certamente já os viu, se não. com este nome, 

20
00:00:58,484 --> 00:01:00,240
está multiplicando dois polinômios. 

21
00:01:00,740 --> 00:01:04,951
Como alguém no ramo de explicações visuais, este é um tópico especialmente excelente, 

22
00:01:04,951 --> 00:01:08,819
porque a definição formulada isoladamente e sem contexto pode parecer um pouco 

23
00:01:08,819 --> 00:01:13,129
intimidante, mas se reservarmos um tempo para realmente desvendar o que está dizendo e, 

24
00:01:13,129 --> 00:01:16,508
antes disso, realmente motivar o porquê você gostaria de algo assim, 

25
00:01:16,508 --> 00:01:18,320
é uma operação incrivelmente bonita. 

26
00:01:18,960 --> 00:01:23,540
E tenho que admitir, na verdade aprendi uma coisinha ao montar o visual deste projeto. 

27
00:01:23,540 --> 00:01:25,762
No caso da convolução de duas funções diferentes, 

28
00:01:25,762 --> 00:01:29,318
eu estava tentando pensar em maneiras diferentes de imaginar o que isso poderia 

29
00:01:29,318 --> 00:01:32,785
significar, e com uma delas tive um momento de surpresa para saber por que as 

30
00:01:32,785 --> 00:01:36,341
distribuições normais desempenham o papel que eles fazem isso em probabilidade, 

31
00:01:36,341 --> 00:01:38,520
por que é uma forma tão natural para uma função. 

32
00:01:39,020 --> 00:01:41,520
Mas estou me adiantando, há muita configuração para isso. 

33
00:01:41,840 --> 00:01:45,851
Neste vídeo, nosso foco principal será apenas no caso discreto e, em particular, 

34
00:01:45,851 --> 00:01:50,260
na construção de um algoritmo muito inesperado, mas muito inteligente, para calculá-los. 

35
00:01:50,260 --> 00:01:54,480
E vou estender a discussão do caso contínuo para uma segunda parte. 

36
00:01:58,580 --> 00:02:01,787
É muito tentador começar com os exemplos de processamento de imagem, 

37
00:02:01,787 --> 00:02:04,065
já que eles são visualmente os mais intrigantes, 

38
00:02:04,065 --> 00:02:08,203
mas há alguns detalhes que tornam o caso de processamento de imagem menos representativo 

39
00:02:08,203 --> 00:02:11,922
das convoluções em geral, então, em vez disso, vamos começar com probabilidade, 

40
00:02:11,922 --> 00:02:15,688
e em particular um dos exemplos mais simples que tenho certeza que todos aqui já 

41
00:02:15,688 --> 00:02:19,500
pensaram em algum momento de suas vidas, que é lançar um par de dados e descobrir 

42
00:02:19,500 --> 00:02:21,500
as chances de ver várias somas diferentes. 

43
00:02:22,460 --> 00:02:24,460
E você pode dizer, não é um problema, não é um problema. 

44
00:02:24,680 --> 00:02:28,067
Cada um dos seus dois dados tem seis resultados possíveis diferentes, 

45
00:02:28,067 --> 00:02:31,407
o que nos dá um total de 36 pares distintos de resultados possíveis, 

46
00:02:31,407 --> 00:02:34,988
e se apenas olharmos para todos eles podemos contar quantos pares têm uma 

47
00:02:34,988 --> 00:02:35,860
determinada soma. 

48
00:02:36,600 --> 00:02:39,182
E organizando todos os pares numa grelha como esta, 

49
00:02:39,182 --> 00:02:43,652
uma coisa muito boa é que todos os pares que têm uma soma constante são visíveis ao longo 

50
00:02:43,652 --> 00:02:45,440
de uma destas diagonais diferentes. 

51
00:02:45,440 --> 00:02:48,680
Portanto, simplesmente contar quantos existem em cada uma dessas 

52
00:02:48,680 --> 00:02:52,120
diagonais lhe dirá a probabilidade de você ver uma determinada soma. 

53
00:02:53,220 --> 00:02:56,010
E eu diria, muito bom, muito bom, mas você consegue pensar 

54
00:02:56,010 --> 00:02:58,660
em alguma outra maneira de visualizar a mesma pergunta? 

55
00:02:59,300 --> 00:03:01,745
Outras imagens que podem vir à mente ao pensar em todos 

56
00:03:01,745 --> 00:03:04,060
os pares distintos que possuem uma determinada soma? 

57
00:03:04,860 --> 00:03:07,980
E talvez um de vocês levante a mão e diga: sim, tenho um. 

58
00:03:08,280 --> 00:03:11,559
Digamos que você imagine esses dois conjuntos diferentes de possibilidades, 

59
00:03:11,559 --> 00:03:13,760
cada um seguido, mas você inverte a segunda linha. 

60
00:03:13,760 --> 00:03:18,760
Dessa forma, todos os pares diferentes que somam sete se alinham verticalmente assim. 

61
00:03:19,360 --> 00:03:22,311
E se deslizarmos a linha inferior totalmente para a direita, 

62
00:03:22,311 --> 00:03:26,280
então o único par que soma dois, os olhos de cobra, são os únicos que se alinham. 

63
00:03:26,620 --> 00:03:28,914
E se eu deslocar isso uma unidade para a direita, 

64
00:03:28,914 --> 00:03:32,080
os pares que se alinham são os dois pares diferentes que somam três. 

65
00:03:32,880 --> 00:03:36,302
E, em geral, diferentes valores de deslocamento desta matriz inferior, 

66
00:03:36,302 --> 00:03:40,592
que lembro que tive que virar primeiro, revelam todos os pares distintos que possuem uma 

67
00:03:40,592 --> 00:03:41,460
determinada soma. 

68
00:03:44,820 --> 00:03:46,814
No que diz respeito às questões de probabilidade, 

69
00:03:46,814 --> 00:03:49,328
isto ainda não é especialmente interessante, porque tudo o que 

70
00:03:49,328 --> 00:03:52,640
estamos a fazer é contar quantos resultados existem em cada uma destas categorias. 

71
00:03:52,980 --> 00:03:55,550
Mas isso ocorre com a suposição implícita de que há 

72
00:03:55,550 --> 00:03:58,120
uma chance igual de cada uma dessas faces aparecer. 

73
00:03:58,360 --> 00:04:01,620
Mas e se eu lhe dissesse que tenho um conjunto especial de dados que não é uniforme? 

74
00:04:02,060 --> 00:04:05,824
Talvez o dado azul tenha seu próprio conjunto de números que descreve as probabilidades 

75
00:04:05,824 --> 00:04:09,375
de cada face que aparece, e o dado vermelho tenha seu próprio conjunto distinto de 

76
00:04:09,375 --> 00:04:09,760
números. 

77
00:04:10,299 --> 00:04:14,197
Nesse caso, se quiser descobrir, digamos, a probabilidade de ver um dois, 

78
00:04:14,197 --> 00:04:18,938
multiplicaria a probabilidade de o dado azul ser um pela probabilidade de o dado vermelho 

79
00:04:18,938 --> 00:04:19,360
ser um. 

80
00:04:19,360 --> 00:04:22,818
E para as chances de ver um três, você olha para os dois pares 

81
00:04:22,818 --> 00:04:26,057
distintos onde isso é possível e, novamente, multiplica as 

82
00:04:26,057 --> 00:04:29,680
probabilidades correspondentes e depois soma esses dois produtos. 

83
00:04:30,100 --> 00:04:33,539
Da mesma forma, as chances de ver um quatro envolvem multiplicar 

84
00:04:33,539 --> 00:04:36,820
três pares diferentes de possibilidades e adicioná-los todos. 

85
00:04:36,820 --> 00:04:39,117
E no espírito de estabelecer algumas fórmulas, 

86
00:04:39,117 --> 00:04:41,952
vamos nomear essas probabilidades superiores como a1, a2, 

87
00:04:41,952 --> 00:04:45,960
a3 e assim por diante, e nomear as inferiores como b1, b2, b3 e assim por diante. 

88
00:04:46,400 --> 00:04:50,191
E, em geral, este processo, onde pegamos duas matrizes diferentes de números, 

89
00:04:50,191 --> 00:04:54,517
invertemos a segunda e depois as alinhamos em vários valores de deslocamento diferentes, 

90
00:04:54,517 --> 00:04:57,045
pegamos um monte de produtos em pares e os somamos, 

91
00:04:57,045 --> 00:05:00,740
esse é um dos maneiras fundamentais de pensar sobre o que é uma convolução. 

92
00:05:00,740 --> 00:05:05,626
Então, só para explicar com mais exatidão, por meio desse processo, 

93
00:05:05,626 --> 00:05:11,159
geramos probabilidades de ver dois, três, quatro, e assim por diante até 12, 

94
00:05:11,159 --> 00:05:16,980
e as obtivemos misturando uma lista de valores, a, e outra. lista de valores, b. 

95
00:05:17,440 --> 00:05:21,840
Na linguagem, diríamos que a convolução dessas duas sequências nos dá esta nova 

96
00:05:21,840 --> 00:05:26,734
sequência, a nova sequência de 11 valores, cada um dos quais parece uma soma de produtos 

97
00:05:26,734 --> 00:05:27,340
aos pares. 

98
00:05:27,340 --> 00:05:32,218
Se preferir, outra maneira de pensar na mesma operação é primeiro criar uma tabela 

99
00:05:32,218 --> 00:05:36,980
de todos os produtos aos pares e depois somar ao longo de todas essas diagonais. 

100
00:05:37,460 --> 00:05:40,286
Novamente, essa é uma maneira de misturar essas duas sequências 

101
00:05:40,286 --> 00:05:42,760
de números para obter uma nova sequência de 11 números. 

102
00:05:43,240 --> 00:05:46,460
É a mesma operação que se pensava nas janelas de correr, apenas outra perspectiva. 

103
00:05:47,140 --> 00:05:49,800
Colocando uma pequena notação nisso, veja como você pode vê-lo escrito. 

104
00:05:50,220 --> 00:05:54,880
A convolução de a e b, denotada por este pequeno asterisco, é uma nova lista, 

105
00:05:54,880 --> 00:05:57,868
e o enésimo elemento dessa lista parece uma soma, 

106
00:05:57,868 --> 00:06:01,752
e essa soma abrange todos os diferentes pares de índices, i e j, 

107
00:06:01,752 --> 00:06:04,860
de modo que a soma de esses índices são iguais a n. 

108
00:06:05,280 --> 00:06:08,410
É meio complicado, mas por exemplo, se n fosse 6, 

109
00:06:08,410 --> 00:06:12,856
os pares que estamos examinando são 1 e 5, 2 e 4, 3 e 3, 4 e 2, 5 e 1, 

110
00:06:12,856 --> 00:06:15,800
todos os pares diferentes que se somam para 6. 

111
00:06:16,620 --> 00:06:18,489
Mas, honestamente, não importa como você escreva, 

112
00:06:18,489 --> 00:06:21,367
a notação é de importância secundária em relação ao visual que você pode ter 

113
00:06:21,367 --> 00:06:22,340
em mente para o processo. 

114
00:06:23,280 --> 00:06:26,199
Aqui, talvez ajude fazer um exemplo super simples, 

115
00:06:26,199 --> 00:06:30,780
onde posso perguntar qual é a convolução da lista 1, 2, 3, com a lista 4, 5, 6. 

116
00:06:31,480 --> 00:06:34,410
Você pode imaginar pegar essas duas listas, virar a 

117
00:06:34,410 --> 00:06:37,680
segunda e começar com a tampa totalmente para a esquerda. 

118
00:06:38,180 --> 00:06:40,451
Então, o par de valores que se alinham são 1 e 4, 

119
00:06:40,451 --> 00:06:43,540
multiplique-os e isso nos dará nosso primeiro termo de nossa saída. 

120
00:06:43,960 --> 00:06:47,075
Deslize a matriz inferior uma unidade para a direita, 

121
00:06:47,075 --> 00:06:50,998
os pares que se alinham são 1 e 5 e 2 e 4, multiplique esses pares, 

122
00:06:50,998 --> 00:06:54,460
some-os e isso nos dá 13, a próxima entrada em nossa saída. 

123
00:06:54,960 --> 00:06:58,560
Deslize as coisas mais uma vez e pegaremos 1 vezes 6, 

124
00:06:58,560 --> 00:07:01,560
mais 2 vezes 5, mais 3 vezes 4, o que dá 28. 

125
00:07:02,020 --> 00:07:06,548
Mais um slide e obtemos 2 vezes 6, mais 3 vezes 5, e isso nos dá 27 e, 

126
00:07:06,548 --> 00:07:10,120
finalmente, o último termo será parecido com 3 vezes 6. 

127
00:07:10,660 --> 00:07:13,337
Se desejar, você pode acessar qualquer que seja sua linguagem de 

128
00:07:13,337 --> 00:07:16,879
programação favorita e sua biblioteca favorita que inclui várias operações numéricas, 

129
00:07:16,879 --> 00:07:18,980
e pode confirmar que não estou mentindo para você. 

130
00:07:18,980 --> 00:07:21,702
Se você pegar a convolução de 1, 2, 3, contra 4, 

131
00:07:21,702 --> 00:07:24,480
5, 6, este é de fato o resultado que você obterá. 

132
00:07:25,920 --> 00:07:29,077
Vimos um caso em que esta é uma operação natural e desejável, 

133
00:07:29,077 --> 00:07:33,660
somando-se a distribuições de probabilidade, e outro exemplo comum seria uma média móvel. 

134
00:07:34,080 --> 00:07:36,890
Imagine que você tem uma longa lista de números 

135
00:07:36,890 --> 00:07:39,760
e pega outra lista menor de números que somam 1. 

136
00:07:40,100 --> 00:07:44,060
Nesse caso, tenho apenas uma pequena lista de 5 valores, e todos são iguais a 1 quinto. 

137
00:07:44,060 --> 00:07:47,531
Então, se fizermos esse processo de convolução de janela deslizante, 

138
00:07:47,531 --> 00:07:51,807
fecharmos os olhos e varrermos para debaixo do tapete o que acontece logo no início, 

139
00:07:51,807 --> 00:07:55,580
uma vez que nossa lista menor de valores se sobrepõe inteiramente à maior, 

140
00:07:55,580 --> 00:07:58,700
pense no que cada termo neste convolução realmente significa. 

141
00:07:59,400 --> 00:08:03,033
A cada iteração, o que você faz é multiplicar cada um dos valores 

142
00:08:03,033 --> 00:08:06,666
dos seus dados por 1/5 e somá-los todos, o que significa que você 

143
00:08:06,666 --> 00:08:10,520
está calculando uma média dos seus dados dentro desta pequena janela. 

144
00:08:11,100 --> 00:08:14,440
No geral, o processo fornece uma versão suavizada dos dados originais, 

145
00:08:14,440 --> 00:08:18,250
e você pode modificar isso começando com uma pequena lista diferente de números, 

146
00:08:18,250 --> 00:08:20,461
e contanto que toda essa pequena lista some 1, 

147
00:08:20,461 --> 00:08:22,720
você ainda pode interpretá-la como uma mudança. 

148
00:08:23,400 --> 00:08:27,760
média. No exemplo mostrado aqui, essa média móvel daria mais peso ao valor central. 

149
00:08:28,420 --> 00:08:30,800
Isso também resulta em uma versão suavizada dos dados. 

150
00:08:33,140 --> 00:08:35,830
Se você fizer um análogo bidimensional disso, terá um 

151
00:08:35,830 --> 00:08:38,720
algoritmo divertido para desfocar uma determinada imagem. 

152
00:08:38,720 --> 00:08:42,840
E devo dizer que as animações que estou prestes a mostrar são modificadas de algo que fiz 

153
00:08:42,840 --> 00:08:46,914
originalmente para parte de um conjunto de palestras que fiz com o Julia Lab no MIT para 

154
00:08:46,914 --> 00:08:51,034
uma determinada aula do OpenCourseWare que incluía uma unidade de processamento de imagem.

155
00:08:51,034 --> 00:08:51,080
 

156
00:08:51,560 --> 00:08:54,251
Lá fizemos um pouco mais para mergulhar no código por trás de tudo isso, 

157
00:08:54,251 --> 00:08:56,280
então se você estiver curioso vou deixar alguns links. 

158
00:08:56,620 --> 00:08:58,915
Mas focando novamente neste exemplo desfocado, 

159
00:08:58,915 --> 00:09:03,068
o que está acontecendo é que eu tenho uma pequena grade 3x3 de valores que marcha ao 

160
00:09:03,068 --> 00:09:07,269
longo de nossa imagem original, e se aumentarmos o zoom, cada um desses valores é 19, 

161
00:09:07,269 --> 00:09:11,470
e o que estou fazendo em cada iteração está multiplicando cada um desses valores pelo 

162
00:09:11,470 --> 00:09:13,620
pixel correspondente sobre o qual ele está. 

163
00:09:13,900 --> 00:09:16,924
E é claro que na ciência da computação pensamos nas cores como pequenos 

164
00:09:16,924 --> 00:09:20,200
vetores de três valores, representando os componentes vermelho, verde e azul. 

165
00:09:20,560 --> 00:09:24,344
Quando multiplico todos esses pequenos valores por 19 e os adiciono, 

166
00:09:24,344 --> 00:09:27,031
obtemos uma média ao longo de cada canal de cor, 

167
00:09:27,031 --> 00:09:31,200
e o pixel correspondente para a imagem à direita é definido como essa soma. 

168
00:09:31,940 --> 00:09:35,069
O efeito geral, ao fazermos isso para cada pixel da imagem, 

169
00:09:35,069 --> 00:09:37,834
é que cada um se infiltra em todos os seus vizinhos, 

170
00:09:37,834 --> 00:09:40,860
o que nos dá uma versão mais desfocada do que a original. 

171
00:09:41,720 --> 00:09:44,804
Na linguagem diríamos que a imagem à direita é uma convolução 

172
00:09:44,804 --> 00:09:47,740
da nossa imagem original com uma pequena grade de valores. 

173
00:09:48,140 --> 00:09:51,200
Ou, mais tecnicamente, talvez eu devesse dizer que é a convolução 

174
00:09:51,200 --> 00:09:54,400
com uma versão girada em 180 graus daquela pequena grade de valores. 

175
00:09:54,620 --> 00:09:57,040
Não que isso importe quando a grade é simétrica, 

176
00:09:57,040 --> 00:10:00,201
mas vale a pena ter em mente que a definição de uma convolução, 

177
00:10:00,201 --> 00:10:03,758
herdada do contexto matemático puro, deve sempre convidá-lo a pensar em 

178
00:10:03,758 --> 00:10:05,240
inverter essa segunda matriz. 

179
00:10:05,960 --> 00:10:09,438
Se modificarmos um pouco isso, poderemos obter um efeito de desfoque muito mais elegante, 

180
00:10:09,438 --> 00:10:11,100
escolhendo uma grade de valores diferente. 

181
00:10:11,440 --> 00:10:15,780
Neste caso tenho uma pequena grade 5x5, mas a distinção não é tanto o seu tamanho. 

182
00:10:15,980 --> 00:10:19,300
Se aumentarmos o zoom, notamos que o valor no meio é muito maior do que o 

183
00:10:19,300 --> 00:10:22,485
valor nas bordas, e de onde isso vem é que todos eles são amostrados a 

184
00:10:22,485 --> 00:10:25,940
partir de uma curva em forma de sino, conhecida como distribuição gaussiana. 

185
00:10:26,800 --> 00:10:30,009
Dessa forma, quando multiplicamos todos esses valores pelo pixel 

186
00:10:30,009 --> 00:10:33,219
correspondente sobre o qual eles estão, estamos dando muito mais 

187
00:10:33,219 --> 00:10:36,380
peso a esse pixel central e muito menos aos que estão na borda. 

188
00:10:36,800 --> 00:10:40,560
E assim como antes, o pixel correspondente à direita é definido como esta soma. 

189
00:10:41,320 --> 00:10:43,859
À medida que fazemos esse processo para cada pixel, 

190
00:10:43,859 --> 00:10:48,059
ocorre um efeito de desfoque que simula com muito mais autenticidade a noção de tirar 

191
00:10:48,059 --> 00:10:49,720
o foco da lente ou algo parecido. 

192
00:10:49,900 --> 00:10:53,360
Mas desfocar está longe de ser a única coisa que você pode fazer com essa ideia. 

193
00:10:53,800 --> 00:10:56,497
Por exemplo, dê uma olhada nesta pequena grade de valores, 

194
00:10:56,497 --> 00:11:00,430
que envolve alguns números positivos à esquerda e alguns números negativos à direita, 

195
00:11:00,430 --> 00:11:02,900
que irei colorir com azul e vermelho respectivamente. 

196
00:11:03,640 --> 00:11:06,083
Reserve um momento para ver se você consegue prever 

197
00:11:06,083 --> 00:11:08,480
e entender o efeito que isso terá na imagem final. 

198
00:11:10,720 --> 00:11:14,331
Então, neste caso, pensarei na imagem apenas em tons de cinza em vez de colorida, 

199
00:11:14,331 --> 00:11:18,120
de modo que cada um dos pixels seja representado apenas por um número em vez de três. 

200
00:11:18,440 --> 00:11:20,606
E uma coisa que vale a pena notar é que à medida que 

201
00:11:20,606 --> 00:11:23,060
fazemos esta convolução é possível obter valores negativos. 

202
00:11:23,060 --> 00:11:26,954
Por exemplo, neste ponto aqui, se ampliarmos a metade esquerda de nossa pequena grade, 

203
00:11:26,954 --> 00:11:30,446
ela ficará inteiramente em cima dos pixels pretos, o que teria um valor zero, 

204
00:11:30,446 --> 00:11:34,206
mas a metade direita dos valores negativos ficaria toda em cima dos pixels brancos, 

205
00:11:34,206 --> 00:11:35,460
o que teria tem o valor um. 

206
00:11:36,180 --> 00:11:39,100
Então, quando multiplicamos os termos correspondentes e os somamos, 

207
00:11:39,100 --> 00:11:42,408
os resultados serão muito negativos, e a maneira como estou exibindo isso na 

208
00:11:42,408 --> 00:11:45,973
imagem à direita é colorir os valores negativos em vermelho e os valores positivos 

209
00:11:45,973 --> 00:11:46,360
em azul. 

210
00:11:46,880 --> 00:11:50,548
Outra coisa a notar é que quando você está em um patch que é todo da mesma cor, 

211
00:11:50,548 --> 00:11:54,080
tudo vai para zero, já que a soma dos valores em nossa pequena grade é zero. 

212
00:11:55,180 --> 00:11:57,287
Isto é muito diferente dos dois exemplos anteriores, 

213
00:11:57,287 --> 00:12:00,668
onde a soma da nossa pequena grelha era um, o que nos permite interpretá-la como uma 

214
00:12:00,668 --> 00:12:02,180
média móvel e, portanto, um desfoque. 

215
00:12:03,640 --> 00:12:06,929
Resumindo, esse pequeno processo basicamente detecta onde quer que haja 

216
00:12:06,929 --> 00:12:10,539
variação no valor do pixel conforme você se move da esquerda para a direita e, 

217
00:12:10,539 --> 00:12:13,920
assim, oferece uma maneira de captar todas as bordas verticais da imagem. 

218
00:12:16,500 --> 00:12:20,796
E da mesma forma, se girarmos essa grade de modo que ela varie conforme você se move 

219
00:12:20,796 --> 00:12:24,335
de cima para baixo, isso será captado em todas as bordas horizontais, 

220
00:12:24,335 --> 00:12:28,430
o que no caso da imagem da nossa pequena criatura torta resulta em alguns lindos 

221
00:12:28,430 --> 00:12:29,340
olhos demoníacos. 

222
00:12:30,400 --> 00:12:33,774
A propósito, essa grade menor costuma ser chamada de kernel, e a beleza aqui é como, 

223
00:12:33,774 --> 00:12:36,830
apenas escolhendo um kernel diferente, você pode obter diferentes efeitos de 

224
00:12:36,830 --> 00:12:39,569
processamento de imagem, não apenas desfocando a detecção de bordas, 

225
00:12:39,569 --> 00:12:40,840
mas também coisas como nitidez. 

226
00:12:40,840 --> 00:12:44,421
Para aqueles que já ouviram falar de uma rede neural convolucional, 

227
00:12:44,421 --> 00:12:47,950
a ideia é usar dados para descobrir quais deveriam ser os kernels, 

228
00:12:47,950 --> 00:12:51,480
conforme determinado por tudo o que a rede neural deseja detectar. 

229
00:12:52,760 --> 00:12:55,520
Outra coisa que talvez eu deva mencionar é a duração da saída. 

230
00:12:55,820 --> 00:12:59,654
Para algo como o exemplo da média móvel, você pode querer pensar apenas nos termos quando 

231
00:12:59,654 --> 00:13:02,551
ambas as janelas estiverem totalmente alinhadas uma com a outra ou, 

232
00:13:02,551 --> 00:13:06,385
no exemplo de processamento de imagem, talvez você queira que a saída final tenha o mesmo 

233
00:13:06,385 --> 00:13:07,280
tamanho do original. 

234
00:13:07,280 --> 00:13:10,375
Agora, as convoluções como uma operação matemática pura sempre produzem 

235
00:13:10,375 --> 00:13:13,385
um array que é maior do que os dois arrays com os quais você começou, 

236
00:13:13,385 --> 00:13:16,180
pelo menos assumindo que um deles não tenha o comprimento de um. 

237
00:13:16,720 --> 00:13:19,177
Saiba apenas que, em certos contextos da ciência da computação, 

238
00:13:19,177 --> 00:13:21,520
muitas vezes você deseja truncar deliberadamente essa saída. 

239
00:13:24,720 --> 00:13:28,605
Outra coisa que vale a pena destacar é que, no contexto da ciência da computação, 

240
00:13:28,605 --> 00:13:31,969
essa noção de inverter o kernel antes de deixá-lo percorrer o original 

241
00:13:31,969 --> 00:13:35,190
muitas vezes parece muito estranha e desnecessária, mas, novamente, 

242
00:13:35,190 --> 00:13:38,412
observe que é isso que é herdado do contexto matemático puro, onde, 

243
00:13:38,412 --> 00:13:42,440
como nós Vi com as probabilidades que é uma coisa incrivelmente natural de se fazer. 

244
00:13:43,020 --> 00:13:46,005
E na verdade posso mostrar mais um exemplo de matemática pura onde 

245
00:13:46,005 --> 00:13:48,990
até os programadores deveriam se preocupar com este porque abre as 

246
00:13:48,990 --> 00:13:52,020
portas para um algoritmo muito mais rápido para calcular tudo isso. 

247
00:13:52,620 --> 00:13:55,020
Para configurar o que quero dizer com mais rápido aqui, 

248
00:13:55,020 --> 00:13:58,322
deixe-me voltar e puxar um pouco de python novamente e vou criar dois arrays 

249
00:13:58,322 --> 00:13:59,780
relativamente grandes diferentes. 

250
00:13:59,940 --> 00:14:03,740
Cada um terá cem mil elementos aleatórios e vou avaliar o 

251
00:14:03,740 --> 00:14:07,540
tempo de execução da função convolve da biblioteca numpy. 

252
00:14:08,180 --> 00:14:12,775
E neste caso ele executa várias iterações diferentes, tenta encontrar uma média, 

253
00:14:12,775 --> 00:14:16,520
e parece que neste computador pelo menos a média é 4.87 segundos. 

254
00:14:16,960 --> 00:14:21,834
Por outro lado, se eu usar uma função diferente da biblioteca scipy chamada fftconvolve, 

255
00:14:21,834 --> 00:14:25,175
que é a mesma coisa, apenas implementada de forma diferente, 

256
00:14:25,175 --> 00:14:30,105
leva apenas 4.3 milissegundos em média, ou seja, uma melhoria de três ordens de magnitude.

257
00:14:30,105 --> 00:14:30,160
 

258
00:14:30,160 --> 00:14:32,590
E, novamente, mesmo que voe com um nome diferente, 

259
00:14:32,590 --> 00:14:35,593
ele está fornecendo a mesma saída que a outra função convolve, 

260
00:14:35,593 --> 00:14:39,120
está apenas fazendo algo para fazer isso de uma maneira mais inteligente. 

261
00:14:42,200 --> 00:14:44,396
Lembre-se de como, no exemplo da probabilidade, 

262
00:14:44,396 --> 00:14:47,737
eu disse que outra maneira de pensar sobre a convolução seria criar esta 

263
00:14:47,737 --> 00:14:50,162
tabela de todos os produtos aos pares e, em seguida, 

264
00:14:50,162 --> 00:14:52,680
somar esses produtos aos pares ao longo das diagonais. 

265
00:14:53,660 --> 00:14:55,606
É claro que não há nada específico para probabilidade. 

266
00:14:55,606 --> 00:14:57,907
Sempre que você está reunindo duas listas diferentes de números, 

267
00:14:57,907 --> 00:14:59,040
você pode pensar dessa maneira. 

268
00:14:59,040 --> 00:15:02,776
Crie esse tipo de tabuada com todos os produtos aos pares e então cada 

269
00:15:02,776 --> 00:15:06,460
soma ao longo da diagonal corresponde a um de seus resultados finais. 

270
00:15:07,600 --> 00:15:10,476
Um contexto onde esta visão é especialmente natural 

271
00:15:10,476 --> 00:15:12,800
é quando você multiplica dois polinômios. 

272
00:15:13,300 --> 00:15:17,981
Por exemplo, deixe-me pegar a pequena grade que já temos e substituir os termos 

273
00:15:17,981 --> 00:15:22,371
superiores por 1, 2x e 3x ao quadrado e substituir os outros termos por 4, 

274
00:15:22,371 --> 00:15:23,600
5x e 6x ao quadrado. 

275
00:15:24,000 --> 00:15:26,261
Agora pense no que significa quando criamos todos 

276
00:15:26,261 --> 00:15:28,840
esses produtos diferentes em pares entre as duas listas. 

277
00:15:29,040 --> 00:15:33,165
O que você está fazendo é essencialmente expandir o produto completo dos dois 

278
00:15:33,165 --> 00:15:36,920
polinômios que escrevi e então, quando você soma ao longo da diagonal, 

279
00:15:36,920 --> 00:15:41,098
isso corresponde à coleta de todos os termos semelhantes, o que é muito legal, 

280
00:15:41,098 --> 00:15:45,382
expandir um polinômio e coletar termos semelhantes é exatamente o mesmo processo 

281
00:15:45,382 --> 00:15:46,440
que uma convolução. 

282
00:15:47,740 --> 00:15:52,340
Mas isso nos permite fazer algo muito legal, porque pense no que estamos dizendo aqui. 

283
00:15:52,340 --> 00:15:56,619
Estamos dizendo que se você pegar duas funções diferentes e multiplicá-las, 

284
00:15:56,619 --> 00:16:00,843
o que é uma operação pontual simples, é a mesma coisa que se você primeiro 

285
00:16:00,843 --> 00:16:05,010
extraísse os coeficientes de cada uma delas, assumindo que são polinômios 

286
00:16:05,010 --> 00:16:08,840
e depois fizesse uma convolução dessas duas listas de coeficientes. 

287
00:16:09,620 --> 00:16:13,059
O que torna isso tão interessante é que as convoluções parecem, em princípio, 

288
00:16:13,059 --> 00:16:16,234
muito mais complicadas do que a simples multiplicação e não quero dizer 

289
00:16:16,234 --> 00:16:19,365
apenas conceitualmente, elas são mais difíceis de pensar, quero dizer, 

290
00:16:19,365 --> 00:16:22,761
computacionalmente, são necessárias mais etapas para realizar uma convolução 

291
00:16:22,761 --> 00:16:25,760
do que para realizar uma produto pontual de duas listas diferentes. 

292
00:16:26,319 --> 00:16:30,009
Por exemplo, digamos que eu lhe dei dois polinômios realmente grandes, 

293
00:16:30,009 --> 00:16:32,607
digamos, cada um com cem coeficientes diferentes, 

294
00:16:32,607 --> 00:16:36,505
então se a maneira como você os multiplicou fosse expandindo este produto, 

295
00:16:36,505 --> 00:16:40,454
você sabe preencher toda essa grade de 100 por 100 de produtos pareados que 

296
00:16:40,454 --> 00:16:43,416
exigiriam que você execute 10.000 produtos diferentes e, 

297
00:16:43,416 --> 00:16:47,157
quando você coletar todos os termos semelhantes ao longo das diagonais, 

298
00:16:47,157 --> 00:16:49,860
haverá outro conjunto de cerca de 10.000 operações. 

299
00:16:50,700 --> 00:16:54,805
De maneira mais geral, no jargão, diríamos que o algoritmo é O de n ao quadrado, 

300
00:16:54,805 --> 00:16:58,251
significando para duas listas de tamanho n, da maneira que o número 

301
00:16:58,251 --> 00:17:01,140
de escalas de operações é proporcional ao quadrado de n. 

302
00:17:01,820 --> 00:17:06,460
Por outro lado, se eu pensar em dois polinômios em termos de suas saídas, por exemplo, 

303
00:17:06,460 --> 00:17:10,993
amostrar seus valores em algumas entradas, então multiplicá-los requer apenas tantas 

304
00:17:10,993 --> 00:17:15,526
operações quanto o número de amostras, já que novamente é uma operação pontual e com 

305
00:17:15,526 --> 00:17:19,793
polinômios você só precisa um número finito de amostras para poder recuperar os 

306
00:17:19,793 --> 00:17:20,540
coeficientes. 

307
00:17:20,540 --> 00:17:22,775
Por exemplo, duas saídas são suficientes para 

308
00:17:22,775 --> 00:17:25,060
especificar exclusivamente um polinômio linear.

309
00:17:25,660 --> 00:17:29,400
Três saídas seriam suficientes para especificar exclusivamente um polinômio quadrático.

310
00:17:29,640 --> 00:17:32,270
E, em geral, se você conhece n saídas distintas, 

311
00:17:32,270 --> 00:17:36,244
isso é suficiente para especificar exclusivamente um polinômio que possui 

312
00:17:36,244 --> 00:17:37,640
n coeficientes diferentes.

313
00:17:37,780 --> 00:17:40,720
Ou, se preferir, poderíamos expressar isso na linguagem dos sistemas de equações.

314
00:17:41,200 --> 00:17:43,276
Imagine que eu lhe diga que tenho um polinômio, 

315
00:17:43,276 --> 00:17:46,520
mas não lhe diga quais são os coeficientes, eles são um mistério para você.

316
00:17:46,700 --> 00:17:50,800
Em nosso exemplo, você pode pensar nisso como o produto que estamos tentando descobrir.

317
00:17:50,800 --> 00:17:54,971
Então suponha que eu diga que vou apenas dizer quais seriam as saídas deste polinômio 

318
00:17:54,971 --> 00:17:58,948
se você inserisse várias entradas diferentes como 0, 1, 2, 3, e assim por diante, 

319
00:17:58,948 --> 00:18:02,926
e eu lhe daria o suficiente para que você tivesse tantas equações quanto você tem 

320
00:18:02,926 --> 00:18:03,460
incógnitas.

321
00:18:04,140 --> 00:18:07,340
Acontece que é até um sistema linear de equações, então isso é legal.

322
00:18:07,780 --> 00:18:10,900
E, pelo menos em princípio, isto deveria ser suficiente para recuperar os coeficientes.

323
00:18:11,740 --> 00:18:13,966
Portanto, o esboço aproximado do algoritmo seria: 

324
00:18:13,966 --> 00:18:16,505
sempre que você quiser convolver duas listas de números, 

325
00:18:16,505 --> 00:18:19,000
trate-as como se fossem coeficientes de dois polinômios.

326
00:18:19,420 --> 00:18:22,257
Você amostra esses polinômios com saídas suficientes, 

327
00:18:22,257 --> 00:18:25,147
multiplica essas amostras ponto a ponto e, em seguida, 

328
00:18:25,147 --> 00:18:28,615
resolve o sistema para recuperar os coeficientes como uma maneira 

329
00:18:28,615 --> 00:18:30,560
sorrateira de encontrar a convolução.

330
00:18:31,420 --> 00:18:35,350
E como afirmei até agora, pelo menos, alguns de vocês poderiam reclamar com razão: 

331
00:18:35,350 --> 00:18:37,340
&quot;Grant, esse é um plano idiota&quot;.

332
00:18:37,580 --> 00:18:41,210
Porque, por um lado, apenas calcular todas essas amostras para um dos 

333
00:18:41,210 --> 00:18:44,943
polinômios que conhecemos já assume a ordem de n operações ao quadrado, 

334
00:18:44,943 --> 00:18:48,832
sem mencionar que resolver esse sistema certamente será computacionalmente 

335
00:18:48,832 --> 00:18:52,100
tão difícil quanto apenas fazer a convolução em primeiro lugar.

336
00:18:52,600 --> 00:18:56,380
Então, claro que temos essa conexão entre multiplicação e convoluções, 

337
00:18:56,380 --> 00:19:00,480
mas toda a complexidade acontece na tradução de um ponto de vista para outro.

338
00:19:01,600 --> 00:19:04,696
Mas há um truque, e aqueles que conhecem as transformadas 

339
00:19:04,696 --> 00:19:07,740
de Fourier e o algoritmo FFT podem ver onde isso vai dar.

340
00:19:07,740 --> 00:19:09,653
Se você não está familiarizado com esses tópicos, 

341
00:19:09,653 --> 00:19:12,180
o que estou prestes a dizer pode parecer completamente inesperado.

342
00:19:12,260 --> 00:19:14,464
Apenas saiba que existem certos caminhos que você poderia 

343
00:19:14,464 --> 00:19:16,860
ter trilhado na matemática que tornam esse passo mais esperado.

344
00:19:17,720 --> 00:19:20,360
Basicamente, a ideia é que tenhamos liberdade de escolha aqui.

345
00:19:20,540 --> 00:19:24,074
Se, em vez de avaliar em algum conjunto arbitrário de entradas como 0, 

346
00:19:24,074 --> 00:19:26,912
1, 2, 3 e assim por diante, você optar por avaliar em um 

347
00:19:26,912 --> 00:19:29,700
conjunto especialmente selecionado de números complexos.

348
00:19:30,240 --> 00:19:33,455
Especificamente aqueles que ficam uniformemente espaçados no círculo unitário, 

349
00:19:33,455 --> 00:19:34,840
conhecidos como raízes da unidade.

350
00:19:35,200 --> 00:19:36,880
Isso nos dá um sistema mais amigável.

351
00:19:38,360 --> 00:19:42,114
A ideia básica é que, ao encontrar um número em que as suas potências se 

352
00:19:42,114 --> 00:19:46,178
enquadram neste padrão de ciclo, isso significa que o sistema que geramos terá 

353
00:19:46,178 --> 00:19:49,573
muita redundância nos diferentes termos que você está calculando, 

354
00:19:49,573 --> 00:19:52,865
e sendo inteligente sobre como você aproveita essa redundância, 

355
00:19:52,865 --> 00:19:54,460
pode economizar muito trabalho.

356
00:19:56,020 --> 00:19:59,124
Este conjunto de resultados que escrevi tem um nome especial, 

357
00:19:59,124 --> 00:20:02,280
é chamado de transformada discreta de Fourier dos coeficientes.

358
00:20:02,500 --> 00:20:05,746
E se você quiser saber mais, na verdade fiz outra palestra para a 

359
00:20:05,746 --> 00:20:09,140
mesma aula da Julia no MIT, sobre transformadas discretas de Fourier.

360
00:20:09,220 --> 00:20:12,949
E também há um vídeo realmente excelente no canal Redutível falando sobre a 

361
00:20:12,949 --> 00:20:17,120
transformada rápida de Fourier, que é um algoritmo para calculá-los mais rapidamente.

362
00:20:17,480 --> 00:20:20,531
Além disso, o Veritasium fez recentemente um vídeo muito bom sobre FFT, 

363
00:20:20,531 --> 00:20:21,760
então você tem muitas opções.

364
00:20:22,260 --> 00:20:24,660
E esse algoritmo rápido é realmente o que importa para nós.

365
00:20:25,120 --> 00:20:27,386
Novamente, por causa de toda essa redundância, 

366
00:20:27,386 --> 00:20:30,472
existe um método para ir dos coeficientes a todas essas saídas, 

367
00:20:30,472 --> 00:20:33,269
onde em vez de fazer na ordem de n operações ao quadrado, 

368
00:20:33,269 --> 00:20:35,728
você faz na ordem de n vezes o log de n operações, 

369
00:20:35,728 --> 00:20:39,200
o que é muito muito melhor à medida que você escala para listas grandes.

370
00:20:39,660 --> 00:20:42,540
E o mais importante, esse algoritmo fft funciona nos dois sentidos.

371
00:20:42,700 --> 00:20:45,480
Também permite passar das saídas aos coeficientes.

372
00:20:46,220 --> 00:20:49,060
Então, juntando tudo, vamos dar uma olhada no esboço do nosso algoritmo.

373
00:20:49,420 --> 00:20:53,599
Agora podemos dizer que sempre que você recebe duas longas listas de números e deseja 

374
00:20:53,599 --> 00:20:57,778
calcular sua convolução, primeiro calcule a transformada rápida de Fourier de cada um 

375
00:20:57,778 --> 00:21:01,860
deles, o que no fundo da sua mente você pode pensar como tratá-los como eles são os 

376
00:21:01,860 --> 00:21:05,796
coeficientes de um polinômio e avaliam-no em um conjunto de pontos especialmente 

377
00:21:05,796 --> 00:21:06,380
selecionado.

378
00:21:06,899 --> 00:21:10,743
Em seguida, multiplique os dois resultados que você acabou de obter pontualmente, 

379
00:21:10,743 --> 00:21:14,493
o que é bom e rápido, e então faça uma transformação rápida inversa de Fourier, 

380
00:21:14,493 --> 00:21:18,384
e o que isso fornece é a maneira sorrateira de calcular a convolução que estávamos 

381
00:21:18,384 --> 00:21:18,900
procurando.

382
00:21:19,040 --> 00:21:22,240
Mas desta vez envolve apenas O de n log n operações.

383
00:21:23,139 --> 00:21:24,740
Isso é muito legal para mim!

384
00:21:25,120 --> 00:21:27,872
Este contexto muito específico onde as convoluções aparecem, 

385
00:21:27,872 --> 00:21:30,760
multiplicando dois polinômios, abre as portas para um algoritmo 

386
00:21:30,760 --> 00:21:34,100
que é relevante em qualquer outro lugar onde as convoluções possam surgir.

387
00:21:34,180 --> 00:21:36,569
Se você quiser adicionar distribuições de probabilidade, 

388
00:21:36,569 --> 00:21:39,000
faça um grande processamento de imagem, seja ela qual for.

389
00:21:39,220 --> 00:21:41,943
E eu acho que esse é um bom exemplo de por que você deveria 

390
00:21:41,943 --> 00:21:44,439
ficar animado quando vê alguma operação ou conceito em 

391
00:21:44,439 --> 00:21:47,480
matemática aparecer em muitas áreas aparentemente não relacionadas.

392
00:21:48,480 --> 00:21:51,500
Se você quiser um pouco de lição de casa, aqui está algo divertido de se pensar.

393
00:21:51,720 --> 00:21:54,821
Explique por que quando você multiplica dois números diferentes, 

394
00:21:54,821 --> 00:21:58,353
apenas uma multiplicação comum, como todos aprendemos na escola primária, 

395
00:21:58,353 --> 00:22:01,980
o que você faz é basicamente uma convolução entre os dígitos desses números.

396
00:22:02,500 --> 00:22:04,975
Existem algumas etapas adicionais com carregamentos e similares, 

397
00:22:04,975 --> 00:22:06,460
mas a etapa principal é uma convolução.

398
00:22:07,280 --> 00:22:09,511
Tendo em conta a existência de um algoritmo rápido, 

399
00:22:09,511 --> 00:22:12,773
o que isso significa é que se tivermos dois números inteiros muito grandes, 

400
00:22:12,773 --> 00:22:16,420
então existe uma forma de determinar o seu produto que é mais rápida do que o método 

401
00:22:16,420 --> 00:22:17,880
que aprendemos na escola primária.

402
00:22:18,140 --> 00:22:20,965
Que, em vez de exigir O de n operações quadradas, 

403
00:22:20,965 --> 00:22:24,920
requer apenas O de n log n, o que nem parece que deveria ser possível.

404
00:22:25,380 --> 00:22:28,341
O problema é que antes que isso seja realmente útil na prática, 

405
00:22:28,341 --> 00:22:30,840
seus números teriam que ser absolutamente monstruosos.

406
00:22:31,220 --> 00:22:35,340
Mesmo assim, é legal que tal algoritmo exista.

407
00:22:35,340 --> 00:22:37,529
A seguir voltaremos nossa atenção para o caso contínuo 

408
00:22:37,529 --> 00:22:39,640
com foco especial nas distribuições de probabilidade.


1
00:00:00,000 --> 00:00:03,505
Supponiamo che ti dia due diversi elenchi di numeri, o forse due diverse funzioni, 

2
00:00:03,505 --> 00:00:07,180
e ti chieda di pensare a tutti i modi in cui potresti combinare questi due elenchi per 

3
00:00:07,180 --> 00:00:10,855
ottenere un nuovo elenco di numeri, o combinare le due funzioni per ottenere una nuova 

4
00:00:10,855 --> 00:00:11,320
funzione . 

5
00:00:12,120 --> 00:00:16,709
Forse un modo semplice che mi viene in mente è semplicemente sommarli termine per termine.

6
00:00:16,709 --> 00:00:16,760
 

7
00:00:17,160 --> 00:00:19,920
Allo stesso modo con le funzioni è possibile aggiungere tutte le uscite corrispondenti. 

8
00:00:20,540 --> 00:00:23,131
Allo stesso modo, potresti anche moltiplicare i due elenchi 

9
00:00:23,131 --> 00:00:25,680
termine per termine e fare la stessa cosa con le funzioni. 

10
00:00:26,360 --> 00:00:30,395
Ma esiste un altro tipo di combinazione altrettanto fondamentale di entrambi, 

11
00:00:30,395 --> 00:00:33,500
ma molto meno comunemente discussa, nota come convoluzione. 

12
00:00:34,080 --> 00:00:36,755
Ma a differenza dei due casi precedenti, non è qualcosa che è 

13
00:00:36,755 --> 00:00:39,820
semplicemente ereditato da un&#39;operazione che puoi fare sui numeri. 

14
00:00:39,980 --> 00:00:42,340
È qualcosa di veramente nuovo nel contesto di 

15
00:00:42,340 --> 00:00:44,700
elenchi di numeri o combinazioni di funzioni. 

16
00:00:45,320 --> 00:00:48,946
Si presentano ovunque, sono onnipresenti nell&#39;elaborazione delle immagini, 

17
00:00:48,946 --> 00:00:51,701
è un costrutto fondamentale nella teoria della probabilità, 

18
00:00:51,701 --> 00:00:55,465
sono usati molto nella risoluzione di equazioni differenziali e in un contesto in 

19
00:00:55,465 --> 00:00:58,357
cui quasi sicuramente l&#39;hai visto, se non con questo nome, 

20
00:00:58,357 --> 00:01:00,240
sta moltiplicando due polinomi tra loro. 

21
00:01:00,740 --> 00:01:03,048
Come qualcuno nel settore delle spiegazioni visive, 

22
00:01:03,048 --> 00:01:05,356
questo è un argomento particolarmente interessante, 

23
00:01:05,356 --> 00:01:09,086
perché la definizione stereotipata isolata e senza contesto può sembrare un po&#39; 

24
00:01:09,086 --> 00:01:13,081
intimidatoria, ma se ci prendiamo il tempo per scompattare veramente ciò che sta dicendo, 

25
00:01:13,081 --> 00:01:16,411
e prima di motivare effettivamente il perché vorresti qualcosa del genere, 

26
00:01:16,411 --> 00:01:18,320
è un&#39;operazione incredibilmente bella. 

27
00:01:18,960 --> 00:01:21,165
E devo ammettere che in realtà ho imparato qualcosa 

28
00:01:21,165 --> 00:01:23,540
mentre mettevo insieme le immagini per questo progetto. 

29
00:01:23,540 --> 00:01:25,895
Nel caso della convoluzione di due funzioni diverse, 

30
00:01:25,895 --> 00:01:29,718
stavo cercando di pensare a diversi modi in cui potresti immaginare cosa ciò potrebbe 

31
00:01:29,718 --> 00:01:33,185
significare, e con uno di essi ho avuto un piccolo momento ahah sul perché le 

32
00:01:33,185 --> 00:01:36,252
distribuzioni normali svolgono il ruolo che lo fanno in probabilità, 

33
00:01:36,252 --> 00:01:38,520
perché è una forma così naturale per una funzione. 

34
00:01:39,020 --> 00:01:41,520
Ma sto andando troppo avanti, c&#39;è molta preparazione per quello. 

35
00:01:41,840 --> 00:01:45,149
In questo video, il nostro focus principale sarà sul caso discreto, 

36
00:01:45,149 --> 00:01:49,481
e in particolare sulla creazione di un algoritmo molto inaspettato ma molto intelligente 

37
00:01:49,481 --> 00:01:50,260
per calcolarli. 

38
00:01:50,260 --> 00:01:54,480
E tirerò fuori la discussione per il caso continuo in una seconda parte. 

39
00:01:58,580 --> 00:02:02,194
È molto forte la tentazione di aprire con gli esempi di elaborazione delle immagini, 

40
00:02:02,194 --> 00:02:04,363
dal momento che sono visivamente i più intriganti, 

41
00:02:04,363 --> 00:02:08,062
ma ci sono un paio di pignoli che rendono il caso dell&#39;elaborazione delle immagini 

42
00:02:08,062 --> 00:02:10,316
meno rappresentativo delle convoluzioni in generale, 

43
00:02:10,316 --> 00:02:14,143
quindi iniziamo invece con la probabilità, e in particolare uno degli esempi più semplici 

44
00:02:14,143 --> 00:02:17,672
a cui sono sicuro che tutti qui abbiano pensato ad un certo punto della loro vita, 

45
00:02:17,672 --> 00:02:21,500
ovvero lanciare un paio di dadi e calcolare le possibilità di vedere varie somme diverse. 

46
00:02:22,460 --> 00:02:24,460
E potresti dire, non è un problema, non è un problema. 

47
00:02:24,680 --> 00:02:27,925
Ciascuno dei tuoi due dadi ha sei diversi risultati possibili, 

48
00:02:27,925 --> 00:02:31,480
il che ci dà un totale di 36 distinte coppie di risultati possibili, 

49
00:02:31,480 --> 00:02:35,860
e se li esaminiamo tutti possiamo contare quante coppie hanno una determinata somma. 

50
00:02:36,600 --> 00:02:39,446
E disponendo tutte le coppie in una griglia come questa, 

51
00:02:39,446 --> 00:02:43,791
una cosa carina è che tutte le coppie che hanno una somma costante sono visibili lungo 

52
00:02:43,791 --> 00:02:45,440
una di queste diverse diagonali. 

53
00:02:45,440 --> 00:02:48,756
Quindi semplicemente contando quanti ne esistono su ciascuna di quelle 

54
00:02:48,756 --> 00:02:52,120
diagonali ti dirà quanto è probabile che tu veda una somma particolare. 

55
00:02:53,220 --> 00:02:55,844
E direi molto bene, molto bene, ma riesci a pensare ad 

56
00:02:55,844 --> 00:02:58,660
altri modi in cui potresti visualizzare la stessa domanda? 

57
00:02:59,300 --> 00:03:01,616
Altre immagini che possono venirvi in mente pensando a 

58
00:03:01,616 --> 00:03:04,060
tutte le coppie distinte che hanno una determinata somma? 

59
00:03:04,860 --> 00:03:07,980
E forse uno di voi alza la mano e dice: sì, ne ho uno. 

60
00:03:08,280 --> 00:03:12,467
Diciamo che immagini questi due diversi insiemi di possibilità ciascuno in fila, 

61
00:03:12,467 --> 00:03:13,760
ma giri la seconda fila. 

62
00:03:13,760 --> 00:03:16,282
In questo modo tutte le diverse coppie che sommate danno 

63
00:03:16,282 --> 00:03:18,760
fino a sette si allineano verticalmente in questo modo. 

64
00:03:19,360 --> 00:03:22,077
E se facciamo scorrere la riga in basso completamente a destra, 

65
00:03:22,077 --> 00:03:25,006
allora l&#39;unica coppia che sommata dà due, gli occhi di serpente, 

66
00:03:25,006 --> 00:03:26,280
sono gli unici ad allinearsi. 

67
00:03:26,620 --> 00:03:29,303
E se lo sposto su un&#39;unità a destra, le coppie che si 

68
00:03:29,303 --> 00:03:32,080
allineano sono le due coppie diverse che sommate danno tre. 

69
00:03:32,880 --> 00:03:36,222
E in generale, diversi valori di offset di questo array inferiore, 

70
00:03:36,222 --> 00:03:40,512
che ricorda che dovevo prima girarlo, rivelano tutte le coppie distinte che hanno una 

71
00:03:40,512 --> 00:03:41,460
determinata somma. 

72
00:03:44,820 --> 00:03:46,736
Per quanto riguarda le domande sulla probabilità, 

73
00:03:46,736 --> 00:03:48,653
questo non è ancora particolarmente interessante, 

74
00:03:48,653 --> 00:03:51,183
perché tutto ciò che stiamo facendo è contare quanti risultati ci 

75
00:03:51,183 --> 00:03:52,640
sono in ciascuna di queste categorie. 

76
00:03:52,980 --> 00:03:55,528
Ma questo avviene con il presupposto implicito che ci sia 

77
00:03:55,528 --> 00:03:58,120
la stessa possibilità che ciascuno di questi volti emerga. 

78
00:03:58,360 --> 00:04:01,620
E se ti dicessi che ho un set speciale di dadi che non è uniforme? 

79
00:04:02,060 --> 00:04:05,820
Forse il dado blu ha il proprio insieme di numeri che descrivono le probabilità che 

80
00:04:05,820 --> 00:04:09,760
esca ciascuna faccia, e il dado rosso ha il proprio insieme di numeri unico e distinto. 

81
00:04:10,299 --> 00:04:12,639
In tal caso, se volessi calcolare, ad esempio, 

82
00:04:12,639 --> 00:04:15,875
la probabilità di vedere un due, moltiplicheresti la probabilità 

83
00:04:15,875 --> 00:04:19,360
che il dado blu sia uno per la probabilità che il dado rosso sia uno. 

84
00:04:19,360 --> 00:04:24,320
E per le probabilità di vedere un tre, guardi le due coppie distinte dove è possibile, 

85
00:04:24,320 --> 00:04:27,342
e ancora, moltiplichi le probabilità corrispondenti, 

86
00:04:27,342 --> 00:04:29,680
e poi sommi questi due prodotti insieme. 

87
00:04:30,100 --> 00:04:33,668
Allo stesso modo, le possibilità di vedere un quattro implicano moltiplicare 

88
00:04:33,668 --> 00:04:36,820
insieme tre diverse coppie di possibilità e sommarle tutte insieme. 

89
00:04:36,820 --> 00:04:41,858
E nello spirito di impostare alcune formule, chiamiamo queste probabilità massime a1, 

90
00:04:41,858 --> 00:04:45,960
a2, a3 e così via, e chiamiamo quelle in basso b1, b2, b3 e così via. 

91
00:04:46,400 --> 00:04:50,310
E in generale, questo processo, in cui prendiamo due diversi array di numeri, 

92
00:04:50,310 --> 00:04:54,171
capovolgiamo il secondo e poi li allineiamo a vari valori di offset diversi, 

93
00:04:54,171 --> 00:04:56,929
prendendo un gruppo di prodotti a coppie e sommandoli, 

94
00:04:56,929 --> 00:05:00,740
questo è uno dei Modi fondamentali per pensare a cosa sia una convoluzione. 

95
00:05:00,740 --> 00:05:05,949
Quindi, giusto per spiegarlo un po&#39; più esattamente, attraverso questo processo, 

96
00:05:05,949 --> 00:05:10,790
abbiamo appena generato le probabilità di vedere due, tre, quattro, fino a 12, 

97
00:05:10,790 --> 00:05:14,589
e le abbiamo ottenute mescolando insieme una lista di valori, 

98
00:05:14,589 --> 00:05:16,980
a e un&#39;altra elenco dei valori, b. 

99
00:05:17,440 --> 00:05:20,740
Nel gergo, diremmo che la convoluzione di queste due sequenze 

100
00:05:20,740 --> 00:05:23,986
ci dà questa nuova sequenza, la nuova sequenza di 11 valori, 

101
00:05:23,986 --> 00:05:27,340
ognuno dei quali assomiglia ad una somma di prodotti a coppie. 

102
00:05:27,340 --> 00:05:31,995
Se preferisci, un altro modo in cui potresti pensare alla stessa operazione è creare 

103
00:05:31,995 --> 00:05:36,925
prima una tabella di tutti i prodotti a coppie e poi sommare lungo tutte queste diagonali.

104
00:05:36,925 --> 00:05:36,980
 

105
00:05:37,460 --> 00:05:40,150
Ancora una volta, questo è un modo di mescolare insieme queste due 

106
00:05:40,150 --> 00:05:42,760
sequenze di numeri per ottenere una nuova sequenza di 11 numeri. 

107
00:05:43,240 --> 00:05:45,386
È lo stesso funzionamento pensato per le finestre scorrevoli, 

108
00:05:45,386 --> 00:05:46,460
solo un&#39;altra prospettiva. 

109
00:05:47,140 --> 00:05:49,800
Mettendogli una piccola annotazione, ecco come potresti vederlo scritto. 

110
00:05:50,220 --> 00:05:55,042
La convoluzione di a e b, indicata con questo piccolo asterisco, è una nuova lista, 

111
00:05:55,042 --> 00:05:58,487
e l&#39;ennesimo elemento di quella lista sembra una somma, 

112
00:05:58,487 --> 00:06:02,104
e quella somma va su tutte le diverse coppie di indici, i e j, 

113
00:06:02,104 --> 00:06:04,860
in modo che la somma di tali indici è pari a n. 

114
00:06:05,280 --> 00:06:11,066
È un po&#39; lungo, ma per esempio, se n fosse 6, le coppie che esamineremo sono 1 e 5, 

115
00:06:11,066 --> 00:06:15,800
2 e 4, 3 e 3, 4 e 2, 5 e 1, tutte le diverse coppie che si sommano a 6. 

116
00:06:16,620 --> 00:06:19,480
Ma onestamente, comunque la scrivi, la notazione è di importanza secondaria 

117
00:06:19,480 --> 00:06:22,340
rispetto all&#39;immagine che potresti tenere in testa durante il processo. 

118
00:06:23,280 --> 00:06:26,280
Ecco, forse può essere utile fare un esempio semplicissimo, 

119
00:06:26,280 --> 00:06:30,780
in cui potrei chiederti qual è la convoluzione della lista 1, 2, 3, con la lista 4, 5, 6. 

120
00:06:31,480 --> 00:06:34,078
Potresti immaginare di prendere entrambi questi elenchi, 

121
00:06:34,078 --> 00:06:37,680
sfogliare il secondo e poi iniziare con il coperchio completamente a sinistra. 

122
00:06:38,180 --> 00:06:40,525
Quindi la coppia di valori che si allineano sono 1 e 4, 

123
00:06:40,525 --> 00:06:43,540
moltiplicali insieme e questo ci dà il primo termine del nostro output. 

124
00:06:43,960 --> 00:06:47,251
Fai scorrere la matrice in basso di un&#39;unità verso destra, 

125
00:06:47,251 --> 00:06:51,064
le coppie che si allineano sono 1 e 5 e 2 e 4, moltiplica quelle coppie, 

126
00:06:51,064 --> 00:06:54,460
sommale e questo ci dà 13, la voce successiva nel nostro output. 

127
00:06:54,960 --> 00:06:58,420
Scorri le cose ancora una volta e prenderemo 1 per 6, 

128
00:06:58,420 --> 00:07:01,560
più 2 per 5, più 3 per 4, che risulta essere 28. 

129
00:07:02,020 --> 00:07:05,812
Un&#39;altra diapositiva e otteniamo 2 per 6, più 3 per 5, 

130
00:07:05,812 --> 00:07:10,120
e questo ci dà 27, e infine l&#39;ultimo termine sembrerà 3 per 6. 

131
00:07:10,660 --> 00:07:13,446
Se lo desideri, puoi visualizzare qualunque sia il tuo linguaggio di 

132
00:07:13,446 --> 00:07:16,072
programmazione preferito e la tua libreria preferita che include 

133
00:07:16,072 --> 00:07:18,980
varie operazioni numeriche e potrai confermare che non ti sto mentendo. 

134
00:07:18,980 --> 00:07:21,673
Se prendi la convoluzione di 1, 2, 3, contro 4, 

135
00:07:21,673 --> 00:07:24,480
5, 6, questo è davvero il risultato che otterrai. 

136
00:07:25,920 --> 00:07:29,327
Abbiamo visto un caso in cui questa è un&#39;operazione naturale e desiderabile, 

137
00:07:29,327 --> 00:07:31,472
che si aggiunge alle distribuzioni di probabilità, 

138
00:07:31,472 --> 00:07:33,660
e un altro esempio comune sarebbe una media mobile. 

139
00:07:34,080 --> 00:07:36,736
Immagina di avere una lunga lista di numeri e di prendere 

140
00:07:36,736 --> 00:07:39,760
un&#39;altra lista più piccola di numeri la cui somma dà tutti 1. 

141
00:07:40,100 --> 00:07:44,060
In questo caso, ho solo una piccola lista di 5 valori, e sono tutti uguali a 1 5°. 

142
00:07:44,060 --> 00:07:47,484
Quindi, se eseguiamo questo processo di convoluzione della finestra scorrevole, 

143
00:07:47,484 --> 00:07:50,994
e chiudiamo gli occhi e spazziamo sotto il tappeto ciò che accade all&#39;inizio, 

144
00:07:50,994 --> 00:07:54,547
una volta che il nostro elenco più piccolo di valori si sovrappone completamente a 

145
00:07:54,547 --> 00:07:58,314
quello più grande, pensa a cosa significa ogni termine in questo convoluzione significa 

146
00:07:58,314 --> 00:07:58,700
davvero. 

147
00:07:59,400 --> 00:08:02,942
Ad ogni iterazione, quello che stai facendo è moltiplicare ciascuno dei 

148
00:08:02,942 --> 00:08:05,648
valori dei tuoi dati per 1 5 e sommarli tutti insieme, 

149
00:08:05,648 --> 00:08:09,289
vale a dire che stai prendendo una media dei tuoi dati all&#39;interno di 

150
00:08:09,289 --> 00:08:10,520
questa piccola finestra. 

151
00:08:11,100 --> 00:08:14,896
Nel complesso, il processo ti fornisce una versione attenuata dei dati originali, 

152
00:08:14,896 --> 00:08:18,136
e puoi modificarla iniziando con un piccolo elenco di numeri diverso, 

153
00:08:18,136 --> 00:08:21,932
e finché quel piccolo elenco dà come somma 1, puoi comunque interpretarlo come un 

154
00:08:21,932 --> 00:08:22,720
movimento media. 

155
00:08:23,400 --> 00:08:27,760
Nell&#39;esempio mostrato qui, la media mobile darebbe più peso al valore centrale. 

156
00:08:28,420 --> 00:08:30,800
Ciò si traduce anche in una versione livellata dei dati. 

157
00:08:33,140 --> 00:08:35,575
Se crei una sorta di analogo bidimensionale di questo, 

158
00:08:35,575 --> 00:08:38,720
otterrai un algoritmo divertente per sfocare una determinata immagine. 

159
00:08:38,720 --> 00:08:41,733
E dovrei dire che le animazioni che sto per mostrare sono modificate 

160
00:08:41,733 --> 00:08:44,878
da qualcosa che avevo originariamente realizzato per parte di una serie 

161
00:08:44,878 --> 00:08:47,848
di lezioni che ho tenuto con il Julia Lab al MIT per un certo corso 

162
00:08:47,848 --> 00:08:51,080
OpenCourseWare che includeva un&#39;unità di elaborazione delle immagini. 

163
00:08:51,560 --> 00:08:54,620
Lì abbiamo fatto un po&#39; di più per approfondire il codice dietro tutto questo, 

164
00:08:54,620 --> 00:08:56,280
quindi se sei curioso ti lascio alcuni link. 

165
00:08:56,620 --> 00:09:00,780
Ma tornando a questo esempio sfocato, quello che succede è che ho questa piccola 

166
00:09:00,780 --> 00:09:05,248
griglia di valori 3x3 che marcia lungo la nostra immagine originale, e se ingrandiamo, 

167
00:09:05,248 --> 00:09:09,665
ognuno di questi valori è 1 9, e quello che sto facendo ad ogni iterazione moltiplica 

168
00:09:09,665 --> 00:09:13,620
ciascuno di questi valori per il pixel corrispondente su cui si trova sopra. 

169
00:09:13,900 --> 00:09:17,773
E ovviamente in informatica pensiamo ai colori come piccoli vettori di tre valori, 

170
00:09:17,773 --> 00:09:20,200
che rappresentano le componenti rosso, verde e blu. 

171
00:09:20,560 --> 00:09:24,256
Quando moltiplico tutti questi piccoli valori per 19° e li somma insieme, 

172
00:09:24,256 --> 00:09:28,102
otteniamo una media lungo ciascun canale di colore e il pixel corrispondente 

173
00:09:28,102 --> 00:09:31,200
per l&#39;immagine a destra viene definito come quella somma. 

174
00:09:31,940 --> 00:09:35,845
L&#39;effetto complessivo, mentre lo facciamo per ogni singolo pixel dell&#39;immagine, 

175
00:09:35,845 --> 00:09:37,931
è che ognuno si fonde con tutti i suoi vicini, 

176
00:09:37,931 --> 00:09:40,860
il che ci dà una versione più sfocata rispetto all&#39;originale. 

177
00:09:41,720 --> 00:09:44,684
Nel gergo diremmo che l&#39;immagine a destra è una convoluzione 

178
00:09:44,684 --> 00:09:47,740
della nostra immagine originale con una piccola griglia di valori. 

179
00:09:48,140 --> 00:09:51,270
O più tecnicamente forse dovrei dire che è la convoluzione con una 

180
00:09:51,270 --> 00:09:54,400
versione ruotata di 180 gradi di quella piccola griglia di valori. 

181
00:09:54,620 --> 00:09:57,041
Non che abbia importanza quando la griglia è simmetrica, 

182
00:09:57,041 --> 00:10:00,524
ma vale semplicemente la pena tenere presente che la definizione di convoluzione, 

183
00:10:00,524 --> 00:10:03,880
ereditata dal contesto matematico puro, dovrebbe sempre invitarti a pensare di 

184
00:10:03,880 --> 00:10:05,240
capovolgere quel secondo array. 

185
00:10:05,960 --> 00:10:08,396
Se lo modifichiamo leggermente, possiamo ottenere un effetto di 

186
00:10:08,396 --> 00:10:11,100
sfocatura molto più elegante scegliendo una diversa griglia di valori. 

187
00:10:11,440 --> 00:10:13,563
In questo caso ho una piccola griglia 5x5, ma 

188
00:10:13,563 --> 00:10:15,780
la differenza non è tanto nelle sue dimensioni. 

189
00:10:15,980 --> 00:10:19,300
Se ingrandiamo notiamo che il valore al centro è molto più grande 

190
00:10:19,300 --> 00:10:22,418
del valore verso i bordi, e da dove proviene è che sono tutti 

191
00:10:22,418 --> 00:10:25,940
campionati da una curva a campana, nota come distribuzione gaussiana. 

192
00:10:26,800 --> 00:10:29,976
In questo modo, quando moltiplichiamo tutti questi valori per 

193
00:10:29,976 --> 00:10:32,486
il pixel corrispondente su cui si trovano sopra, 

194
00:10:32,486 --> 00:10:36,380
diamo molto più peso a quel pixel centrale e molto meno a quelli sul bordo. 

195
00:10:36,800 --> 00:10:40,560
E proprio come prima, il pixel corrispondente a destra è definito come questa somma. 

196
00:10:41,320 --> 00:10:43,726
Poiché eseguiamo questo processo per ogni singolo pixel, 

197
00:10:43,726 --> 00:10:46,638
si ottiene un effetto sfocato che simula in modo molto più autentico 

198
00:10:46,638 --> 00:10:49,720
l&#39;idea di mettere l&#39;obiettivo fuori fuoco o qualcosa del genere. 

199
00:10:49,900 --> 00:10:53,360
Ma la sfocatura non è l&#39;unica cosa che puoi fare con questa idea. 

200
00:10:53,800 --> 00:10:56,941
Ad esempio, dai un&#39;occhiata a questa piccola griglia di valori, 

201
00:10:56,941 --> 00:11:00,775
che coinvolge alcuni numeri positivi a sinistra e alcuni numeri negativi a destra, 

202
00:11:00,775 --> 00:11:02,900
che colorerò rispettivamente con blu e rosso. 

203
00:11:03,640 --> 00:11:05,975
Prenditi un momento per vedere se riesci a prevedere e 

204
00:11:05,975 --> 00:11:08,480
capire quale effetto questo avrà sull&#39;immagine finale. 

205
00:11:10,720 --> 00:11:13,133
Quindi in questo caso penserò all&#39;immagine semplicemente 

206
00:11:13,133 --> 00:11:15,547
come in scala di grigi anziché a colori, quindi ciascuno dei 

207
00:11:15,547 --> 00:11:18,120
pixel è rappresentato semplicemente da un numero anziché da tre. 

208
00:11:18,440 --> 00:11:20,837
E una cosa degna di nota è che mentre eseguiamo questa 

209
00:11:20,837 --> 00:11:23,060
convoluzione è possibile ottenere valori negativi. 

210
00:11:23,060 --> 00:11:25,990
Ad esempio, a questo punto se ingrandiamo la metà sinistra della 

211
00:11:25,990 --> 00:11:28,876
nostra piccola griglia si trova interamente sopra i pixel neri, 

212
00:11:28,876 --> 00:11:31,852
che avrebbero un valore pari a zero, ma la metà destra dei valori 

213
00:11:31,852 --> 00:11:35,460
negativi si trova tutta sopra i pixel bianchi, il che avrebbe hanno valore uno. 

214
00:11:36,180 --> 00:11:39,529
Quindi quando moltiplichiamo i termini corrispondenti e li sommiamo insieme 

215
00:11:39,529 --> 00:11:43,142
i risultati saranno molto negativi, e il modo in cui lo mostro con l&#39;immagine 

216
00:11:43,142 --> 00:11:46,360
a destra è colorare i valori negativi in rosso e quelli positivi in blu. 

217
00:11:46,880 --> 00:11:50,567
Un&#39;altra cosa da notare è che quando sei su una patch tutta dello stesso colore 

218
00:11:50,567 --> 00:11:54,080
tutto va a zero poiché la somma dei valori nella nostra piccola griglia è zero. 

219
00:11:55,180 --> 00:11:57,412
Questo è molto diverso dai due esempi precedenti in cui la 

220
00:11:57,412 --> 00:11:59,796
somma della nostra piccola griglia era uno, il che ci permette 

221
00:11:59,796 --> 00:12:02,180
di interpretarla come una media mobile e quindi una sfocatura. 

222
00:12:03,640 --> 00:12:07,066
Tutto sommato, questo piccolo processo rileva fondamentalmente ovunque ci sia una 

223
00:12:07,066 --> 00:12:10,033
variazione nel valore dei pixel mentre ti sposti da sinistra a destra, 

224
00:12:10,033 --> 00:12:13,502
e quindi ti offre una sorta di modo per rilevare tutti i bordi verticali della tua 

225
00:12:13,502 --> 00:12:13,920
immagine. 

226
00:12:16,500 --> 00:12:19,757
E allo stesso modo, se ruotassimo la griglia in modo che vari mentre 

227
00:12:19,757 --> 00:12:23,769
ti sposti dall&#39;alto verso il basso, questo riprenderà tutti i bordi orizzontali, 

228
00:12:23,769 --> 00:12:27,121
il che, nel caso della nostra immagine della piccola creatura a torta, 

229
00:12:27,121 --> 00:12:29,340
si traduce in degli occhi piuttosto demoniaci. 

230
00:12:30,400 --> 00:12:33,165
Questa griglia più piccola, tra l&#39;altro, è spesso chiamata kernel, 

231
00:12:33,165 --> 00:12:36,671
e il bello è che semplicemente scegliendo un kernel diverso puoi ottenere diversi effetti 

232
00:12:36,671 --> 00:12:40,099
di elaborazione delle immagini, non solo sfocare il rilevamento dei bordi ma anche cose 

233
00:12:40,099 --> 00:12:40,840
come la nitidezza. 

234
00:12:40,840 --> 00:12:44,371
Per quelli di voi che hanno sentito parlare di una rete neurale convoluzionale, 

235
00:12:44,371 --> 00:12:47,815
l&#39;idea è quella di utilizzare i dati per capire quali dovrebbero essere i 

236
00:12:47,815 --> 00:12:51,480
kernel in primo luogo, come determinato da ciò che la rete neurale vuole rilevare. 

237
00:12:52,760 --> 00:12:55,520
Un&#39;altra cosa che forse dovrei sollevare è la lunghezza dell&#39;output. 

238
00:12:55,820 --> 00:12:58,754
Per qualcosa come l&#39;esempio della media mobile potresti voler pensare 

239
00:12:58,754 --> 00:13:02,045
ai termini solo quando entrambe le finestre sono completamente allineate tra loro, 

240
00:13:02,045 --> 00:13:05,138
o nell&#39;esempio di elaborazione delle immagini forse vuoi che l&#39;output 

241
00:13:05,138 --> 00:13:07,280
finale abbia la stessa dimensione dell&#39;originale. 

242
00:13:07,280 --> 00:13:10,381
Ora le convoluzioni come operazione matematica pura producono sempre 

243
00:13:10,381 --> 00:13:12,898
un array più grande dei due array con cui hai iniziato, 

244
00:13:12,898 --> 00:13:16,180
almeno presupponendo che uno di essi non abbia una lunghezza pari a uno. 

245
00:13:16,720 --> 00:13:19,215
Sappi solo che in certi contesti informatici spesso 

246
00:13:19,215 --> 00:13:21,520
vuoi troncare deliberatamente quell&#39;output. 

247
00:13:24,720 --> 00:13:28,375
Un&#39;altra cosa che vale la pena sottolineare è che nel contesto informatico 

248
00:13:28,375 --> 00:13:32,030
l&#39;idea di girare il kernel prima di lasciarlo attraversare l&#39;originale 

249
00:13:32,030 --> 00:13:34,713
spesso sembra davvero strana e semplicemente fuori luogo, 

250
00:13:34,713 --> 00:13:38,229
ma ancora una volta nota che questo è ciò che è ereditato dal puro contesto 

251
00:13:38,229 --> 00:13:42,393
matematico dove come noi visto le probabilità è una cosa incredibilmente naturale da fare.

252
00:13:42,393 --> 00:13:42,440
 

253
00:13:43,020 --> 00:13:46,065
E in realtà posso mostrarti un altro esempio di matematica pura di 

254
00:13:46,065 --> 00:13:49,020
cui anche i programmatori dovrebbero interessarsi perché apre le 

255
00:13:49,020 --> 00:13:52,020
porte a un algoritmo molto più veloce per calcolare tutti questi. 

256
00:13:52,620 --> 00:13:54,829
Per impostare ciò che intendo per più veloce qui, 

257
00:13:54,829 --> 00:13:58,542
lasciami tornare indietro e richiamare di nuovo qualche Python e creerò due diversi 

258
00:13:58,542 --> 00:13:59,780
array relativamente grandi. 

259
00:13:59,940 --> 00:14:03,832
Ognuno conterrà centomila elementi casuali e valuterò il tempo 

260
00:14:03,832 --> 00:14:07,540
di esecuzione della funzione convolve dalla libreria Numpy. 

261
00:14:08,180 --> 00:14:11,279
E in questo caso lo esegue per più iterazioni diverse, 

262
00:14:11,279 --> 00:14:15,505
cerca di trovare una media e sembra che su questo computer almeno la media 

263
00:14:15,505 --> 00:14:16,520
sia 4.87 secondi. 

264
00:14:16,960 --> 00:14:21,125
Al contrario, se utilizzo una funzione diversa dalla libreria scipy chiamata 

265
00:14:21,125 --> 00:14:25,994
fftconvolve che è la stessa cosa solo implementata in modo diverso che ne richiede solo 4.

266
00:14:25,994 --> 00:14:30,160
3 millisecondi in media, quindi un miglioramento di tre ordini di grandezza. 

267
00:14:30,160 --> 00:14:34,513
E ancora, anche se vola con un nome diverso, fornisce lo stesso output dell&#39;altra 

268
00:14:34,513 --> 00:14:39,069
funzione di convoluzione, sta solo facendo qualcosa per farlo in un modo più intelligente.

269
00:14:39,069 --> 00:14:39,120
 

270
00:14:42,200 --> 00:14:45,738
Ricorda che con l&#39;esempio della probabilità ho detto che un altro modo in 

271
00:14:45,738 --> 00:14:49,186
cui potresti pensare alla convoluzione era creare questa tabella di tutti i 

272
00:14:49,186 --> 00:14:52,680
prodotti a coppie e poi sommare questi prodotti a coppie lungo le diagonali. 

273
00:14:53,660 --> 00:14:56,314
Ovviamente non c&#39;è nulla di specifico nella probabilità ogni volta che 

274
00:14:56,314 --> 00:14:59,040
stai convolgendo due diversi elenchi di numeri puoi pensarci in questo modo. 

275
00:14:59,040 --> 00:15:02,725
Crea questo tipo di tavola pitagorica con tutti i prodotti a coppie e poi 

276
00:15:02,725 --> 00:15:06,460
ogni somma lungo la diagonale corrisponde a uno dei tuoi risultati finali. 

277
00:15:07,600 --> 00:15:10,103
Un contesto in cui questa visione è particolarmente 

278
00:15:10,103 --> 00:15:12,800
naturale è quando si moltiplicano insieme due polinomi. 

279
00:15:13,300 --> 00:15:18,508
Ad esempio, prendiamo la piccola griglia che abbiamo già e sostituiamo i termini in alto 

280
00:15:18,508 --> 00:15:23,600
con 1, 2x e 3x al quadrato e sostituiamo gli altri termini con 4, 5x e 6x al quadrato. 

281
00:15:24,000 --> 00:15:26,323
Ora pensa a cosa significa quando creiamo tutti 

282
00:15:26,323 --> 00:15:28,840
questi diversi prodotti a coppie tra i due elenchi. 

283
00:15:29,040 --> 00:15:33,245
Quello che stai facendo è essenzialmente espandere il prodotto completo dei due 

284
00:15:33,245 --> 00:15:37,450
polinomi che ho scritto e poi quando sommi lungo la diagonale ciò corrisponde a 

285
00:15:37,450 --> 00:15:41,551
raccogliere tutti i termini simili, il che è abbastanza accurato espandere un 

286
00:15:41,551 --> 00:15:45,704
polinomio e raccogliere termini simili è esattamente il stesso processo di una 

287
00:15:45,704 --> 00:15:46,440
convoluzione. 

288
00:15:47,740 --> 00:15:49,850
Ma questo ci permette di fare qualcosa di davvero 

289
00:15:49,850 --> 00:15:52,340
interessante perché pensa a quello che stiamo dicendo qui. 

290
00:15:52,340 --> 00:15:56,492
Stiamo dicendo che se prendi due funzioni diverse e le moltiplichi insieme, 

291
00:15:56,492 --> 00:16:00,535
che è una semplice operazione puntuale che è la stessa cosa che se avessi 

292
00:16:00,535 --> 00:16:04,851
prima estratto i coefficienti da ciascuno di essi assumendo che siano polinomi 

293
00:16:04,851 --> 00:16:08,840
e poi avessi preso una convoluzione di quelli due liste di coefficienti. 

294
00:16:09,620 --> 00:16:12,927
Ciò che lo rende così interessante è che le convoluzioni sembrano in linea 

295
00:16:12,927 --> 00:16:16,058
di principio molto più complicate della semplice moltiplicazione e non 

296
00:16:16,058 --> 00:16:18,880
intendo solo concettualmente che sono più difficili da pensare, 

297
00:16:18,880 --> 00:16:21,923
intendo che a livello computazionale sono necessari più passaggi per 

298
00:16:21,923 --> 00:16:25,760
eseguire una convoluzione che per eseguire una prodotto puntuale di due liste diverse. 

299
00:16:26,319 --> 00:16:29,705
Ad esempio, diciamo che ti ho dato due polinomi davvero grandi, 

300
00:16:29,705 --> 00:16:32,403
ciascuno con un centinaio di coefficienti diversi, 

301
00:16:32,403 --> 00:16:36,793
quindi se il modo in cui li moltiplichi fosse quello di espandere questo prodotto, 

302
00:16:36,793 --> 00:16:41,554
sai riempire l&#39;intera griglia 100 per 100 di prodotti a coppie che richiederebbero di 

303
00:16:41,554 --> 00:16:46,209
farlo esegui 10.000 prodotti diversi e poi quando raccogli tutti i termini simili lungo 

304
00:16:46,209 --> 00:16:49,860
le diagonali si ottiene un altro insieme di circa 10.000 operazioni. 

305
00:16:50,700 --> 00:16:54,514
Più in generale nel gergo diremmo che l&#39;algoritmo è O di n al quadrato, 

306
00:16:54,514 --> 00:16:57,927
il che significa che per due elenchi di dimensione n il modo in cui 

307
00:16:57,927 --> 00:17:01,140
il numero di operazioni scala è proporzionale al quadrato di n. 

308
00:17:01,820 --> 00:17:05,247
D&#39;altra parte, se penso a due polinomi in termini di output, 

309
00:17:05,247 --> 00:17:08,569
ad esempio campionando i loro valori in una manciata di input, 

310
00:17:08,569 --> 00:17:13,210
moltiplicarli richiede solo tante operazioni quanto il numero di campioni poiché ancora 

311
00:17:13,210 --> 00:17:17,956
una volta è un&#39;operazione puntuale e con i polinomi hai solo bisogno un numero finito 

312
00:17:17,956 --> 00:17:20,540
di campioni per poter recuperare i coefficienti. 

313
00:17:20,540 --> 00:17:23,242
Ad esempio sono sufficienti due output per specificare 

314
00:17:23,242 --> 00:17:25,060
in modo univoco un polinomio lineare.

315
00:17:25,660 --> 00:17:29,400
Tre output sarebbero sufficienti per specificare in modo univoco un polinomio quadratico.

316
00:17:29,640 --> 00:17:33,287
E in generale se si conoscono n output distinti è sufficiente 

317
00:17:33,287 --> 00:17:37,640
specificare in modo univoco un polinomio che abbia n coefficienti diversi.

318
00:17:37,780 --> 00:17:40,720
O se preferisci, potremmo esprimerlo nel linguaggio dei sistemi di equazioni.

319
00:17:41,200 --> 00:17:45,107
Immagina che ti dica che ho un polinomio ma non ti dico quali sono i coefficienti, 

320
00:17:45,107 --> 00:17:46,520
quelli sono un mistero per te.

321
00:17:46,700 --> 00:17:48,928
Nel nostro esempio potresti pensare a questo come 

322
00:17:48,928 --> 00:17:50,800
al prodotto che stiamo cercando di capire.

323
00:17:50,800 --> 00:17:54,840
Quindi supponiamo che ti dica semplicemente quali sarebbero i risultati di 

324
00:17:54,840 --> 00:17:59,042
questo polinomio se inserisci vari input diversi come 0, 1, 2, 3, e così via, 

325
00:17:59,042 --> 00:18:03,460
e te ne do abbastanza in modo da avere tante equazioni quante hai delle incognite.

326
00:18:04,140 --> 00:18:07,340
Sembra anche che sia un sistema lineare di equazioni, quindi è carino.

327
00:18:07,780 --> 00:18:09,340
E questo, almeno in linea di principio, dovrebbe 

328
00:18:09,340 --> 00:18:10,900
essere sufficiente per recuperare i coefficienti.

329
00:18:11,740 --> 00:18:15,410
Quindi lo schema approssimativo dell&#39;algoritmo sarebbe quindi che ogni volta che vuoi 

330
00:18:15,410 --> 00:18:19,000
convolvere due elenchi di numeri li tratti come se fossero coefficienti di due polinomi.

331
00:18:19,420 --> 00:18:22,602
Campioni quei polinomi con un numero sufficiente di output, 

332
00:18:22,602 --> 00:18:26,369
moltiplichi quei campioni in modo puntuale e quindi risolvi il sistema 

333
00:18:26,369 --> 00:18:30,560
per recuperare i coefficienti come un modo subdolo per trovare la convoluzione.

334
00:18:31,420 --> 00:18:35,305
E almeno come ho affermato finora, alcuni di voi potrebbero giustamente lamentarsi: 

335
00:18:35,305 --> 00:18:37,340
&quot;Grant, questo è un piano idiota&quot;.

336
00:18:37,580 --> 00:18:41,059
Perché per prima cosa il solo calcolo di tutti questi campioni per uno dei 

337
00:18:41,059 --> 00:18:44,724
polinomi che conosciamo già richiede l&#39;ordine di n operazioni al quadrato, 

338
00:18:44,724 --> 00:18:47,924
per non parlare del fatto che risolvere quel sistema sarà certamente 

339
00:18:47,924 --> 00:18:52,100
computazionalmente difficile quanto eseguire semplicemente la convoluzione in primo luogo.

340
00:18:52,600 --> 00:18:56,490
Quindi, certo, abbiamo questa connessione tra moltiplicazione e convoluzioni, 

341
00:18:56,490 --> 00:19:00,480
ma tutta la complessità avviene nel tradurre da un punto di vista all&#39;altro.

342
00:19:01,600 --> 00:19:04,717
Ma c’è un trucco, e quelli di voi che conoscono le trasformate di 

343
00:19:04,717 --> 00:19:07,740
Fourier e l’algoritmo FFT potrebbero capire dove stiamo andando.

344
00:19:07,740 --> 00:19:09,858
Se non hai familiarità con questi argomenti, quello 

345
00:19:09,858 --> 00:19:12,180
che sto per dire potrebbe sembrare del tutto inaspettato.

346
00:19:12,260 --> 00:19:14,502
Sappi solo che ci sono alcuni percorsi che avresti potuto 

347
00:19:14,502 --> 00:19:16,860
percorrere in matematica che rendono questo passo più atteso.

348
00:19:17,720 --> 00:19:20,360
Fondamentalmente l’idea è che qui abbiamo libertà di scelta.

349
00:19:20,540 --> 00:19:25,265
Se invece di valutare un insieme arbitrario di input come 0, 1, 2, 3 e così via, 

350
00:19:25,265 --> 00:19:29,700
scegli di valutare un insieme di numeri complessi appositamente selezionati.

351
00:19:30,240 --> 00:19:32,940
In particolare quelli che si trovano equamente distanziati sul cerchio unitario, 

352
00:19:32,940 --> 00:19:34,840
quelli che sono conosciuti come le radici dell&#39;unità.

353
00:19:35,200 --> 00:19:36,880
Questo ci dà un sistema più amichevole.

354
00:19:38,360 --> 00:19:42,258
L&#39;idea di base è che trovando un numero in cui l&#39;assunzione dei suoi 

355
00:19:42,258 --> 00:19:46,359
poteri rientra in questo modello ciclico, significa che il sistema che generiamo 

356
00:19:46,359 --> 00:19:49,548
avrà molta ridondanza nei diversi termini che stai calcolando, 

357
00:19:49,548 --> 00:19:52,637
e essendo intelligente su come Sfruttando questa ridondanza, 

358
00:19:52,637 --> 00:19:54,460
puoi risparmiare un sacco di lavoro.

359
00:19:56,020 --> 00:19:59,202
Questo insieme di output che ho scritto ha un nome speciale, 

360
00:19:59,202 --> 00:20:02,280
si chiama trasformata discreta di Fourier dei coefficienti.

361
00:20:02,500 --> 00:20:05,820
E se vuoi saperne di più, in realtà ho tenuto un&#39;altra lezione per lo 

362
00:20:05,820 --> 00:20:09,140
stesso corso di Julia al MIT, tutta sulle trasformate discrete di Fourier.

363
00:20:09,220 --> 00:20:13,194
E c&#39;è anche un video davvero eccellente sul canale riducibile che parla della 

364
00:20:13,194 --> 00:20:17,120
trasformata veloce di Fourier, che è un algoritmo per calcolarli più velocemente.

365
00:20:17,480 --> 00:20:20,668
Inoltre Veritasium ha recentemente realizzato un ottimo video sulle FFT, 

366
00:20:20,668 --> 00:20:21,760
quindi hai molte opzioni.

367
00:20:22,260 --> 00:20:24,660
E questo algoritmo veloce è davvero il punto per noi.

368
00:20:25,120 --> 00:20:27,473
Ancora una volta, a causa di tutta questa ridondanza, 

369
00:20:27,473 --> 00:20:30,481
esiste un metodo per passare dai coefficienti a tutti questi output, 

370
00:20:30,481 --> 00:20:33,315
dove invece di fare nell&#39;ordine di n operazioni al quadrato, 

371
00:20:33,315 --> 00:20:36,235
si esegue nell&#39;ordine di n volte il logaritmo di n operazioni, 

372
00:20:36,235 --> 00:20:39,200
che è molto molto meglio se si passa a elenchi di grandi dimensioni.

373
00:20:39,660 --> 00:20:42,540
E, cosa più importante, questo algoritmo FFT funziona in entrambe le direzioni.

374
00:20:42,700 --> 00:20:45,480
Permette anche di passare dagli output ai coefficienti.

375
00:20:46,220 --> 00:20:49,060
Quindi, riunendo il tutto, diamo un&#39;occhiata allo schema del nostro algoritmo.

376
00:20:49,420 --> 00:20:52,738
Ora possiamo dire che ogni volta che ti vengono dati due lunghi elenchi 

377
00:20:52,738 --> 00:20:56,102
di numeri e vuoi fare la loro convoluzione, calcola prima la trasformata 

378
00:20:56,102 --> 00:20:59,420
veloce di Fourier di ciascuno di essi, che nel profondo della tua mente 

379
00:20:59,420 --> 00:21:02,785
puoi semplicemente pensare come se li trattassi come sono i coefficienti 

380
00:21:02,785 --> 00:21:06,380
di un polinomio e lo valutano in una serie di punti appositamente selezionati.

381
00:21:06,899 --> 00:21:10,791
Poi moltiplica insieme i due risultati che hai appena ottenuto in termini di punti, 

382
00:21:10,791 --> 00:21:14,405
il che è bello e veloce, e poi fai una trasformata di Fourier veloce inversa, 

383
00:21:14,405 --> 00:21:18,483
e quello che ti dà è il subdolo modo backdoor per calcolare la convoluzione che stavamo 

384
00:21:18,483 --> 00:21:18,900
cercando.

385
00:21:19,040 --> 00:21:22,240
Ma questa volta si tratta solo di O di n log n operazioni.

386
00:21:23,139 --> 00:21:24,740
Per me è davvero fantastico!

387
00:21:25,120 --> 00:21:28,468
Questo contesto molto specifico in cui compaiono le convoluzioni, 

388
00:21:28,468 --> 00:21:32,983
moltiplicando due polinomi, apre le porte a un algoritmo che è rilevante ovunque possano 

389
00:21:32,983 --> 00:21:34,100
emergere convoluzioni.

390
00:21:34,180 --> 00:21:36,010
Se vuoi aggiungere distribuzioni di probabilità, 

391
00:21:36,010 --> 00:21:39,000
esegui un&#39;elaborazione di immagini di grandi dimensioni, qualunque essa sia.

392
00:21:39,220 --> 00:21:42,003
E penso che sia un ottimo esempio del perché dovresti essere 

393
00:21:42,003 --> 00:21:44,559
emozionato quando vedi qualche operazione o concetto in 

394
00:21:44,559 --> 00:21:47,480
matematica comparire in molte aree apparentemente non correlate.

395
00:21:48,480 --> 00:21:51,500
Se vuoi fare qualche compito a casa, ecco qualcosa a cui è divertente pensare.

396
00:21:51,720 --> 00:21:54,169
Spiega perché quando moltiplichi due numeri diversi, 

397
00:21:54,169 --> 00:21:57,912
semplicemente la moltiplicazione ordinaria come tutti impariamo alle elementari, 

398
00:21:57,912 --> 00:22:01,980
quello che stai facendo è fondamentalmente una convoluzione tra le cifre di quei numeri.

399
00:22:02,500 --> 00:22:04,656
Ci sono alcuni passaggi aggiuntivi con carry e simili, 

400
00:22:04,656 --> 00:22:06,460
ma il passaggio principale è una convoluzione.

401
00:22:07,280 --> 00:22:09,845
Alla luce dell&#39;esistenza di un algoritmo veloce, 

402
00:22:09,845 --> 00:22:12,604
ciò significa che se hai due numeri interi molto grandi, 

403
00:22:12,604 --> 00:22:16,089
allora esiste un modo per trovare il loro prodotto che è più veloce del 

404
00:22:16,089 --> 00:22:17,880
metodo che impariamo alle elementari.

405
00:22:18,140 --> 00:22:22,188
Che invece di richiedere O di n operazioni al quadrato richiede solo O di n log n, 

406
00:22:22,188 --> 00:22:24,920
il che non sembra nemmeno che dovrebbe essere possibile.

407
00:22:25,380 --> 00:22:28,451
Il problema è che prima che ciò sia effettivamente utile nella pratica, 

408
00:22:28,451 --> 00:22:30,840
i tuoi numeri dovrebbero essere assolutamente mostruosi.

409
00:22:31,220 --> 00:22:35,340
Ma è comunque bello che esista un simile algoritmo.

410
00:22:35,340 --> 00:22:37,332
Successivamente rivolgeremo la nostra attenzione al caso 

411
00:22:37,332 --> 00:22:39,640
continuo con un focus speciale sulle distribuzioni di probabilità.


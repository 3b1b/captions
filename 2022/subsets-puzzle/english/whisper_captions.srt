1
00:00:00,000 --> 00:00:03,800
In a moment, I will ask you a puzzle, and it's a pretty hard puzzle, actually,

2
00:00:04,160 --> 00:00:08,820
but before I do, I want to lead with a spoiler, which is the fact that the way we're going to solve this

3
00:00:08,820 --> 00:00:10,900
involves the use of complex numbers.

4
00:00:11,560 --> 00:00:14,340
And once you hear it, you will agree that that seems absurd,

5
00:00:14,720 --> 00:00:17,480
given that the puzzle is going to be purely a discrete question.

6
00:00:17,800 --> 00:00:20,260
It only asks about whole numbers and their sums.

7
00:00:20,660 --> 00:00:24,560
There's not a whiff of the imaginary or even continuity anywhere on the horizon.

8
00:00:25,280 --> 00:00:27,840
It's certainly not the only time that complex numbers are

9
00:00:27,840 --> 00:00:30,720
unreasonably useful for discrete math, to borrow a phrase.

10
00:00:31,160 --> 00:00:35,020
The more famous example that I could bring up would be how the modern way that mathematicians

11
00:00:35,020 --> 00:00:38,220
understand prime numbers, you know, questions about how they're distributed,

12
00:00:38,400 --> 00:00:40,300
their density at certain regions, things like that,

13
00:00:40,520 --> 00:00:45,620
well, it involves studying specially designed functions whose inputs and outputs are complex numbers.

14
00:00:46,120 --> 00:00:49,360
Some of you may know that this is what the famous Riemann hypothesis is all about.

15
00:00:49,680 --> 00:00:52,700
Basically, there's a specially designed function, and on the face of it,

16
00:00:52,760 --> 00:00:54,960
it looks unrelated to the discrete world of primes.

17
00:00:55,060 --> 00:00:57,000
It's smooth, it's complex valued.

18
00:00:57,000 --> 00:01:00,600
But under the hood, it encodes all of the information that you could ever want

19
00:01:00,600 --> 00:01:02,180
about those discrete prime numbers.

20
00:01:02,600 --> 00:01:06,340
And most importantly, certain questions about primes are easier to answer

21
00:01:06,340 --> 00:01:10,600
by analyzing this function than they would be by directly analyzing the primes themselves.

22
00:01:11,260 --> 00:01:13,820
Of course, our puzzle, which I promise I'll share in just a moment,

23
00:01:13,980 --> 00:01:16,060
is a lot more innocent than the Riemann hypothesis.

24
00:01:16,260 --> 00:01:17,420
It's a toy problem.

25
00:01:17,880 --> 00:01:21,320
But at the end of the video, I'll share how the techniques that we use to solve it,

26
00:01:21,400 --> 00:01:24,480
the real reason that we're here, are actually pretty similar in spirit

27
00:01:24,480 --> 00:01:26,820
to the setup that leads to the Riemann hypothesis.

28
00:01:27,000 --> 00:01:30,180
And the prime number theorem and that whole circle of thoughts around it.

29
00:01:34,900 --> 00:01:39,380
Our puzzle for today comes from this book here by T2 Andrescu and Zhu Mingfeng.

30
00:01:39,480 --> 00:01:42,740
It's basically a collection of problems used in training the USA team

31
00:01:42,740 --> 00:01:44,320
for the International Math Olympiad.

32
00:01:44,940 --> 00:01:47,060
And if we turn to chapter 2, Advanced Problems,

33
00:01:47,300 --> 00:01:50,240
problem number 10 asks this seemingly innocent question.

34
00:01:50,920 --> 00:01:54,680
Find the number of subsets of the set 1 up to 2000,

35
00:01:54,680 --> 00:01:57,640
the sum of whose elements is divisible by 5.

36
00:01:59,180 --> 00:02:01,420
Okay, so that might take a little bit of a moment to parse.

37
00:02:01,640 --> 00:02:05,320
For example, something like the set 3, 1, 4, that would be a subset.

38
00:02:05,660 --> 00:02:08,060
All of its elements are also elements in the big set.

39
00:02:08,580 --> 00:02:12,500
And its sum, 3 plus 1 plus 4 is 8, so that wouldn't be considered.

40
00:02:12,600 --> 00:02:13,540
That's not in our count.

41
00:02:13,840 --> 00:02:18,120
Whereas something like the set 2, 3, 5, also a subset, has a sum of 10.

42
00:02:18,440 --> 00:02:20,920
That is divisible by 5, so it's one that we want to count.

43
00:02:21,400 --> 00:02:23,600
The preview animation that I had at the start

44
00:02:23,600 --> 00:02:27,140
is essentially a brute force program trying to answer this question.

45
00:02:27,720 --> 00:02:30,600
It will iterate through all of the different possible subsets,

46
00:02:30,720 --> 00:02:32,680
finding the sum of each one along the way,

47
00:02:33,120 --> 00:02:36,060
and it increments a counter each time that it finds a multiple of 5.

48
00:02:36,760 --> 00:02:40,100
And you know what, a nice warm-up question here would be to pause and think about

49
00:02:40,100 --> 00:02:42,520
how many total subsets are there overall?

50
00:02:42,820 --> 00:02:44,160
Forget this multiple of 5 stuff.

51
00:02:44,420 --> 00:02:46,560
How long will it take for this program to terminate?

52
00:02:48,060 --> 00:02:51,500
Many of you may know, the answer is 2 to the power 2,000.

53
00:02:52,120 --> 00:02:54,580
The basic idea there is that when you're constructing a subset,

54
00:02:55,080 --> 00:02:57,780
you have 2,000 different binary choices you can make.

55
00:02:58,000 --> 00:02:59,480
Do you include an element or do you not?

56
00:03:00,080 --> 00:03:02,420
And all of those choices are independent of each other,

57
00:03:02,680 --> 00:03:05,560
so the total number of choices you have in constructing a subset

58
00:03:05,560 --> 00:03:09,000
is 2 times 2 times 2 times 2 on and on 2,000 times.

59
00:03:09,800 --> 00:03:13,240
And thinking about our program, that is a monstrously huge number.

60
00:03:13,620 --> 00:03:16,540
So even if we gave this brute forcing approach all the time in the universe,

61
00:03:16,540 --> 00:03:19,800
with all the physical resources the universe could conceivably provide,

62
00:03:20,300 --> 00:03:22,460
it wouldn't even come close, it wouldn't scratch the surface.

63
00:03:23,060 --> 00:03:25,180
Obviously we have to be a lot cleverer than that.

64
00:03:25,560 --> 00:03:28,660
And if you were to just guess what the answer should be, make a rough approximation,

65
00:03:29,260 --> 00:03:32,340
you'd probably guess, you know, it should be around a fifth of all the total subsets.

66
00:03:32,540 --> 00:03:35,580
There's probably a roughly even distribution of all these sums mod 5.

67
00:03:36,000 --> 00:03:38,080
And yes, that is true, that's a decent approximation.

68
00:03:38,500 --> 00:03:42,220
But the heart of the question, the real challenge here, is to get a precise answer.

69
00:03:42,720 --> 00:03:45,220
This can't be the actual answer since it's not an integer,

70
00:03:45,220 --> 00:03:48,200
but is the true answer a little bit more or a little bit less?

71
00:03:48,520 --> 00:03:50,340
Or maybe it's a lot more or a lot less.

72
00:03:50,600 --> 00:03:53,540
What tactics could you possibly use to figure out that error?

73
00:03:55,680 --> 00:03:59,540
To be clear, this lesson is definitely much more about the journey than the destination.

74
00:04:00,260 --> 00:04:02,820
Will you ever need to filter and count subsets in this way?

75
00:04:03,300 --> 00:04:05,160
Almost certainly not, I wouldn't expect so.

76
00:04:05,360 --> 00:04:09,000
But toy problem or not, it is a legitimately challenging question,

77
00:04:09,260 --> 00:04:14,020
and navigating that challenge develops skills that are relevant to other sorts of challenging questions.

78
00:04:14,020 --> 00:04:18,860
For you and me, there are at least two very surprising and very beautiful twists and turns

79
00:04:18,860 --> 00:04:20,820
that the solution I'd like to share with you takes.

80
00:04:21,300 --> 00:04:24,320
I've already tipped my hand that complex numbers will make a surprise appearance,

81
00:04:24,860 --> 00:04:27,400
but before we even get to that, there is another strange turn,

82
00:04:27,460 --> 00:04:30,640
which is arguably even weirder and even more unexpected.

83
00:04:31,300 --> 00:04:33,860
To set the stage though, let's just get our bearings with the puzzle,

84
00:04:34,120 --> 00:04:37,760
and do what all good problem solvers should do, and start with a simpler example,

85
00:04:38,000 --> 00:04:40,320
maybe just trying it with the set 1, 2, 3, 4, 5.

86
00:04:40,980 --> 00:04:43,160
If you were solving this problem with pencil and paper,

87
00:04:43,160 --> 00:04:45,400
you're one of these kids training for the IMO,

88
00:04:45,780 --> 00:04:49,000
it's not a bad idea to simply list out all 2 to the 5 subsets.

89
00:04:49,340 --> 00:04:51,240
It's only 32, it's not that many.

90
00:04:55,680 --> 00:04:58,600
There's different ways that you might want to organize all of these in your mind,

91
00:04:58,620 --> 00:05:01,620
but since the thing that we care about is their sum,

92
00:05:02,040 --> 00:05:06,040
the natural thing to do would be to go through all of them one by one and compute those sums.

93
00:05:06,520 --> 00:05:08,660
Over here, just doing it on YouTube, I've got a computer,

94
00:05:08,820 --> 00:05:11,040
so I'll cheat a little and show what all their sums are.

95
00:05:11,040 --> 00:05:14,040
I'll also cheat a little bit and rearrange all of these,

96
00:05:14,120 --> 00:05:17,800
organizing them suggestively into collections that all have the same sum.

97
00:05:18,500 --> 00:05:21,280
For instance, there are 3 distinct subsets that add up to 6,

98
00:05:21,400 --> 00:05:22,720
and they'll all sit in this little box,

99
00:05:23,080 --> 00:05:26,600
and the 3 subsets adding up to 10 will all live in this little box.

100
00:05:27,260 --> 00:05:31,240
And all in all, the ones that we care about, the subsets with a sum divisible by 5,

101
00:05:31,560 --> 00:05:35,240
have been put over here on the left, and it looks like there's a total of 8 of them.

102
00:05:36,340 --> 00:05:39,180
Oh, and by the way, I should say we are counting the empty set,

103
00:05:39,180 --> 00:05:43,520
we consider its sum to be 0, and we consider that to be a multiple of 5.

104
00:05:43,940 --> 00:05:47,340
By the end, I hope you'll agree all of those are abundantly natural choices to make.

105
00:05:48,140 --> 00:05:51,260
Take a moment to compare this answer to what you might expect heuristically.

106
00:05:51,800 --> 00:05:56,200
Out of all 32 total subsets, a fifth of that would have been 6.4,

107
00:05:56,740 --> 00:06:00,060
so at least in this small example, the true answer is a little bit bigger than that.

108
00:06:00,360 --> 00:06:02,540
That's maybe something you want to talk in the back of your mind.

109
00:06:03,720 --> 00:06:07,040
Okay, and this is the part of the video where, I'll be honest with you,

110
00:06:07,260 --> 00:06:08,900
I have no idea how to motivate it.

111
00:06:08,900 --> 00:06:12,460
Personally, I like it when math feels like something you could have discovered yourself,

112
00:06:12,580 --> 00:06:15,140
and if you and I were sitting down together solving this problem,

113
00:06:15,560 --> 00:06:17,800
I think there's all sorts of natural steps that you might take.

114
00:06:18,240 --> 00:06:21,520
Maybe you try to understand if there's some sort of structure to the subsets,

115
00:06:21,520 --> 00:06:24,620
or you play around with how these sums are distributed mod 5

116
00:06:24,620 --> 00:06:27,180
at many different iterations for other small examples,

117
00:06:27,620 --> 00:06:30,320
and from that maybe you try to eke out some kind of proof by induction.

118
00:06:31,040 --> 00:06:33,260
When I shared an early version of this lesson with some patrons,

119
00:06:33,500 --> 00:06:35,400
people brought up some nice linear algebra approaches.

120
00:06:35,720 --> 00:06:37,580
All those are well and good, nothing wrong with those.

121
00:06:37,580 --> 00:06:41,660
But instead, my goal here is to teach you about something called a generating function.

122
00:06:42,120 --> 00:06:44,980
And it's one of those tactics where after the fact you can think,

123
00:06:45,240 --> 00:06:49,160
okay, yeah, I get that this works, but how on earth would you have thought of that?

124
00:06:49,920 --> 00:06:51,140
Honestly, I don't know.

125
00:06:51,420 --> 00:06:55,040
There's a time in your life before you understand generating functions, and a time after,

126
00:06:55,440 --> 00:06:58,480
and I can't think of anything that connects them other than a leap of faith.

127
00:06:59,380 --> 00:07:01,340
I'm going to ask you to consider the polynomial

128
00:07:01,340 --> 00:07:07,280
1 plus x times 1 plus x squared times 1 plus x cubed times 1 plus x to the fourth

129
00:07:07,280 --> 00:07:08,580
times 1 plus x to the fifth.

130
00:07:08,980 --> 00:07:11,540
Now, I know you could rightfully ask, where does this come from?

131
00:07:11,580 --> 00:07:13,160
What do polynomials have to do with things?

132
00:07:13,520 --> 00:07:16,340
What is the variable x even supposed to represent right now?

133
00:07:17,160 --> 00:07:19,120
And essentially x is purely a symbol.

134
00:07:19,440 --> 00:07:21,440
The only reason that we've written a polynomial here

135
00:07:21,440 --> 00:07:24,480
is that the act of algebraically expanding it

136
00:07:24,480 --> 00:07:28,300
is going to completely mirror the act of constructing subsets.

137
00:07:28,300 --> 00:07:33,120
And, importantly, this grouping that we want, where subsets with the same sum

138
00:07:33,120 --> 00:07:36,980
are all bunched together, kind of happens automatically when you do this.

139
00:07:37,400 --> 00:07:38,440
And let me show you what I mean.

140
00:07:39,020 --> 00:07:43,520
When you expand out this expression, it basically comes down to making five binary choices.

141
00:07:43,800 --> 00:07:45,800
Which term from each parenthetical do you choose?

142
00:07:46,600 --> 00:07:51,160
If you choose the 1 from each of those parentheticals, that will correspond to the empty

143
00:07:51,160 --> 00:07:53,260
set where we don't choose any of the elements.

144
00:07:53,980 --> 00:07:57,320
Whereas if I choose the x to the 1 term and then ones from everything else,

145
00:07:57,320 --> 00:08:01,540
that will correspond to the singleton set that just contains the number 1.

146
00:08:02,200 --> 00:08:05,580
Similarly, if I choose the x squared term but ones from everything else,

147
00:08:06,060 --> 00:08:08,000
that corresponds to the set just containing 2.

148
00:08:08,520 --> 00:08:12,320
Just choosing the x cubed term corresponds to the set just containing the number 3.

149
00:08:13,100 --> 00:08:16,960
But, interestingly, notice what happens if I choose the x to the 1 term

150
00:08:16,960 --> 00:08:19,800
and the x squared term and then ones from everything else.

151
00:08:20,280 --> 00:08:25,380
This corresponds to the choice of the subset that has 1 and 2 and nothing from everything else.

152
00:08:25,380 --> 00:08:30,120
But in the polynomial, the way it expands looks like x cubed.

153
00:08:30,260 --> 00:08:35,360
So we have two different x cubed terms, each of which came from a subset whose sum was 3.

154
00:08:36,080 --> 00:08:39,580
And honestly, the pattern that I'm going for here is one that's probably easiest if you

155
00:08:39,580 --> 00:08:44,060
just take the time to pause and think through for yourself what happens when you expand everything here.

156
00:08:44,660 --> 00:08:49,020
Essentially, every possible subset corresponds to one of the terms in this expansion.

157
00:08:49,680 --> 00:08:53,840
And then the critical point is that the exponent in the term that you get from that expansion

158
00:08:53,840 --> 00:08:56,940
equals the sum of that corresponding subset.

159
00:08:57,600 --> 00:08:59,000
Kind of confusing when you say it out loud,

160
00:08:59,000 --> 00:09:02,280
but again if you just kind of think it through yourself I think you can see what I mean.

161
00:09:02,620 --> 00:09:06,600
For example, when all of the dust settles and we collect all 32 terms here,

162
00:09:06,980 --> 00:09:09,380
three of those terms are x to the 10th,

163
00:09:09,380 --> 00:09:13,520
and each of those came from a choice of elements whose sum was equal to 10.

164
00:09:14,540 --> 00:09:18,400
Now normally when we write a polynomial, we collect together all like terms.

165
00:09:18,680 --> 00:09:21,140
Instead of having three copies of x to the 10th,

166
00:09:21,140 --> 00:09:24,440
we would just see the coefficient 3 in front of x to the 10th.

167
00:09:24,440 --> 00:09:29,640
So each of these coefficients is a way of encoding the number of subsets with a particular sum.

168
00:09:30,460 --> 00:09:34,260
So this, like I said at the start, is an example of something called a generating function,

169
00:09:34,600 --> 00:09:39,480
where the idea is if you have some question with an answer associated with each positive integer,

170
00:09:40,000 --> 00:09:42,900
so in our case how many subsets add up to a particular value.

171
00:09:43,480 --> 00:09:48,220
When you construct a polynomial whose coefficients correspond to the answers to that question,

172
00:09:48,220 --> 00:09:51,540
you can get a surprising amount of insight from your original question

173
00:09:51,540 --> 00:09:56,100
by mathematically manipulating and analyzing the properties of this polynomial.

174
00:09:56,660 --> 00:09:59,240
There are tons and tons of examples of generating functions,

175
00:09:59,320 --> 00:10:02,080
but just to bring up one other one which is especially fun,

176
00:10:02,080 --> 00:10:04,900
you can use the same idea to study Fibonacci numbers.

177
00:10:05,340 --> 00:10:08,660
So all the coefficients of this polynomial will be Fibonacci numbers,

178
00:10:08,780 --> 00:10:12,820
and in this case it's an infinite polynomial, so I should really be calling it a power series.

179
00:10:13,520 --> 00:10:15,320
I won't fully explain the details here,

180
00:10:15,320 --> 00:10:17,860
but I will leave them up on the screen for anyone who's curious.

181
00:10:18,220 --> 00:10:22,040
Basic idea is that the rule that's used to define Fibonacci numbers,

182
00:10:22,120 --> 00:10:23,780
each one being the sum of the previous two,

183
00:10:24,260 --> 00:10:26,820
can be expressed as an equation in terms of this function.

184
00:10:27,580 --> 00:10:31,200
That equation in turn lets you write that function in an alternate form.

185
00:10:32,180 --> 00:10:34,640
And then, and here's most of the details I'm skipping over,

186
00:10:35,020 --> 00:10:38,780
if you manipulate that, you know, throw in a little partial fraction decomposition here,

187
00:10:38,940 --> 00:10:41,420
a little bit of geometric series power expansion there,

188
00:10:41,740 --> 00:10:45,980
you can get yourself an exact closed form expression for each individual Fibonacci number,

189
00:10:46,200 --> 00:10:47,020
which is really cool.

190
00:10:47,580 --> 00:10:50,820
I mentioned this really just to show the tip of the iceberg of the fact

191
00:10:50,820 --> 00:10:55,260
that this idea of a generating function goes way, way beyond our particular example.

192
00:10:56,460 --> 00:11:01,700
Now, in our particular problem, if we extend from the simple example with just 12345

193
00:11:01,700 --> 00:11:04,460
to the big example with all the numbers up to 2000,

194
00:11:05,140 --> 00:11:09,700
our corresponding generating function involves these 2000 different binomial terms,

195
00:11:09,800 --> 00:11:13,500
you know, 1 plus x, 1 plus x squared, on and on, up to 1 plus x to the 2000.

196
00:11:13,500 --> 00:11:16,820
And the idea is that if you were to expand this,

197
00:11:17,140 --> 00:11:19,560
the coefficients tell us all the information we want.

198
00:11:20,060 --> 00:11:22,660
Now, it would be insane to actually expand it,

199
00:11:22,720 --> 00:11:26,400
but it is helpful to keep in the back of your mind, in principle, what that would look like.

200
00:11:26,800 --> 00:11:28,920
For example, in principle, if you expanded it,

201
00:11:29,100 --> 00:11:34,600
you would find that the coefficient in front of the x to the 25th term happens to be 142.

202
00:11:35,520 --> 00:11:41,640
And this corresponds to the fact that there are 142 distinct subsets that have a sum of 25.

203
00:11:42,280 --> 00:11:45,260
So the art of analyzing a generating function here

204
00:11:45,260 --> 00:11:51,200
will be to deduce facts about these coefficients without actually expanding the expression.

205
00:11:55,880 --> 00:11:59,640
So moving forward, I'm just going to write this expansion more abstractly,

206
00:11:59,780 --> 00:12:02,680
just a sum from n equals 0 up to capital N,

207
00:12:02,800 --> 00:12:05,520
where c sub n tells us the coefficients that we don't know.

208
00:12:05,880 --> 00:12:08,060
All of that starts off as a black box to us.

209
00:12:08,360 --> 00:12:11,280
And moving forward, we're going to start treating this as an actual function,

210
00:12:11,280 --> 00:12:14,000
something where we plug in x, we see what the output is,

211
00:12:14,160 --> 00:12:16,440
and then we ask, what does that tell us about the coefficients?

212
00:12:17,060 --> 00:12:20,620
For example, a very easy input would be to plug in something like x equals 0.

213
00:12:21,120 --> 00:12:25,100
In that case, importantly, we know how to evaluate it using the factored form above.

214
00:12:25,380 --> 00:12:30,020
If you plug in x equals 0 for everything, all of the terms look like 1, so the answer is 1.

215
00:12:30,360 --> 00:12:34,400
And in the expanded form, all of those terms involving an x will get killed, they go to 0,

216
00:12:34,780 --> 00:12:37,020
leaving us just with the first term, c sub 0.

217
00:12:37,800 --> 00:12:40,600
Now, in this case, that doesn't really tell us anything all that exciting.

218
00:12:40,600 --> 00:12:45,600
It essentially translates to saying there is a single empty set, but we're just getting our feet wet.

219
00:12:46,040 --> 00:12:49,640
As the next example, take a moment to think about evaluating f at 1.

220
00:12:50,460 --> 00:12:52,760
This is something we can do with the expression we know,

221
00:12:52,960 --> 00:12:56,420
when you plug in 1 for all of these x's, every term looks like a 2,

222
00:12:56,740 --> 00:13:00,200
so in total, we get 2 multiplied by itself 2,000 times.

223
00:13:00,720 --> 00:13:04,420
On the other hand, in the expanded expression, if you plug in x equals 1,

224
00:13:05,100 --> 00:13:09,300
all of these powers of x go to 1, so we're essentially adding up all of the coefficients,

225
00:13:09,300 --> 00:13:11,460
which is pretty cool when you think about it.

226
00:13:11,740 --> 00:13:14,000
Just by evaluating the function at a single number,

227
00:13:14,320 --> 00:13:17,160
we can deduce what the sum of all of the coefficients are.

228
00:13:17,680 --> 00:13:21,420
Now, again, in our particular example, it's not all that exciting,

229
00:13:21,480 --> 00:13:24,460
because we already know what the sum of these coefficients are.

230
00:13:24,960 --> 00:13:28,540
Remember, each coefficient counts how many subsets have a certain sum,

231
00:13:28,900 --> 00:13:31,520
and so when you add them up, we're just counting all of the subsets,

232
00:13:31,520 --> 00:13:33,320
which we know to be 2 to the 2,000.

233
00:13:34,220 --> 00:13:36,540
However, I can give you a genuinely new fact

234
00:13:36,540 --> 00:13:39,320
if I ask you to evaluate this function at negative 1.

235
00:13:39,720 --> 00:13:41,220
Take a moment to think about what that means.

236
00:13:43,340 --> 00:13:46,380
If you plug in negative 1, again, we start with the thing we know,

237
00:13:46,520 --> 00:13:50,100
the factored expression up top, and here, all you need is to look at the first term.

238
00:13:50,440 --> 00:13:53,140
When you plug in x, the first parenthetical goes to 0,

239
00:13:53,420 --> 00:13:55,060
so the whole expression has to be 0.

240
00:13:55,640 --> 00:13:58,900
But what does that tell you when we apply it to the expanded expression,

241
00:13:59,080 --> 00:14:00,220
using all of the coefficients?

242
00:14:00,720 --> 00:14:03,920
And in the spirit of being as suggestive as possible of the strange turns

243
00:14:03,920 --> 00:14:08,260
that this solution takes, I want you to really visualize the various powers of negative 1

244
00:14:08,260 --> 00:14:10,920
in this expression in terms of rotations.

245
00:14:11,460 --> 00:14:13,740
The first term, negative 1 to the 0, is just 1,

246
00:14:13,920 --> 00:14:16,000
which we'll picture as a vector from 0 to 1.

247
00:14:16,580 --> 00:14:19,760
Then negative 1 to the first power is just negative 1 itself,

248
00:14:20,080 --> 00:14:25,040
which I want you to be thinking about as a 180-degree rotation away from that last term.

249
00:14:25,540 --> 00:14:28,300
Then when we take negative 1 squared, that's positive 1.

250
00:14:28,540 --> 00:14:30,580
Again, a 180-degree rotation.

251
00:14:30,580 --> 00:14:35,820
And in general, each successive term here looks like another rotation by 180 degrees.

252
00:14:36,180 --> 00:14:39,280
Algebraically, what this translates to is that we have an oscillating sum

253
00:14:39,280 --> 00:14:41,780
between the even coefficients and the odd coefficients,

254
00:14:42,180 --> 00:14:43,860
but keep the visual in the back of your mind.

255
00:14:44,260 --> 00:14:46,640
This expression is true for any generating function,

256
00:14:46,800 --> 00:14:48,960
but again, for our special generating function,

257
00:14:49,360 --> 00:14:52,580
we know that this value, this alternating sum, should equal 0.

258
00:14:53,040 --> 00:14:56,240
And a way you can interpret that is that it's telling you there's an equal balance

259
00:14:56,240 --> 00:14:58,900
between the even coefficients and the odd coefficients.

260
00:14:59,460 --> 00:15:02,280
And remember, maybe in the context of our smaller example,

261
00:15:02,820 --> 00:15:06,520
these coefficients are encoding for us facts about subsets.

262
00:15:06,760 --> 00:15:10,880
So if there's an equal balance between all those even coefficients and the odd coefficients,

263
00:15:11,340 --> 00:15:16,160
it's telling you that half of all the subsets have an even sum, and half of them have an odd sum.

264
00:15:16,660 --> 00:15:18,080
That's probably what you would expect,

265
00:15:18,400 --> 00:15:20,640
but it's not obvious at first how you would show that,

266
00:15:20,820 --> 00:15:23,440
and with the generating function, it just kind of pops right out.

267
00:15:24,480 --> 00:15:28,140
And again, to be suggestive of where we're going, let me rewrite this a little bit

268
00:15:28,140 --> 00:15:33,620
by taking the last two things we evaluated, add up those two, and then divide by one half.

269
00:15:35,100 --> 00:15:38,660
If you think about it, this is a way of filtering out all of the even coefficients

270
00:15:39,060 --> 00:15:41,280
and killing all of the odd coefficients.

271
00:15:41,900 --> 00:15:46,440
So it becomes an especially clean way to write the fact that the sum of all of the even coefficients,

272
00:15:46,740 --> 00:15:50,440
which again in the back of your mind means the total number of subsets with an even sum,

273
00:15:50,820 --> 00:15:52,140
will look like half of the total.

274
00:15:52,620 --> 00:15:57,100
This is, needless to say, tantalizingly close to the actual question we want to answer.

275
00:15:57,100 --> 00:16:01,480
What we would like to do is find some clever thing that we can do to the function f,

276
00:16:01,720 --> 00:16:04,060
some well-chosen numbers to evaluate it on,

277
00:16:04,200 --> 00:16:07,460
so that we get all the coefficients corresponding to multiples of 5.

278
00:16:08,000 --> 00:16:10,600
Again, thinking back to what these coefficients encode for us,

279
00:16:10,900 --> 00:16:12,620
that will be answering our final question.

280
00:16:12,760 --> 00:16:16,860
That will be counting the total number of subsets whose sum is divisible by 5.

281
00:16:18,900 --> 00:16:21,900
The trick to doing this is to generalize what we just did,

282
00:16:21,960 --> 00:16:25,400
where the successive powers of the input were rotating back and forth.

283
00:16:25,900 --> 00:16:28,660
But this time we don't want them to rotate every other time,

284
00:16:28,720 --> 00:16:31,340
we'd like them to somehow rotate with a period of 5.

285
00:16:31,740 --> 00:16:34,220
And to do that, we extend into the complex plane.

286
00:16:34,640 --> 00:16:39,160
You see, up there we can find a value so that as we take successive powers of it,

287
00:16:39,640 --> 00:16:44,000
it will rotate by a fifth of a turn, giving us a process with a frequency of 5.

288
00:16:44,700 --> 00:16:47,380
And if you step back, I know that it's kind of absurd

289
00:16:47,380 --> 00:16:49,500
that I'm asking you to think about complex numbers.

290
00:16:49,860 --> 00:16:52,600
I mean, we started with a counting question, it's discrete math,

291
00:16:52,660 --> 00:16:54,640
but hopefully it's not all that wild.

292
00:16:55,400 --> 00:17:00,120
And again, the reason that I'm drawing things out to tee up the various strange turns in the solution

293
00:17:00,120 --> 00:17:03,800
is that they're actually not all that strange in the broader scheme of math.

294
00:17:04,140 --> 00:17:08,060
The trick we're about to apply has a heavy resemblance to many other instances

295
00:17:08,060 --> 00:17:12,360
of using complex numbers to better understand discrete questions of integers.

296
00:17:12,740 --> 00:17:15,920
So the more it feels like something that you could have discovered yourself,

297
00:17:16,280 --> 00:17:19,920
the more it might actually be the case that when you're working on some future problem

298
00:17:19,920 --> 00:17:23,220
in this circle of thoughts, you will discover it yourself.

299
00:17:28,560 --> 00:17:29,040
The complex number

300
00:17:29,040 --> 00:17:33,500
To be specific, the complex number that I care about is one that I'm going to label zeta,

301
00:17:33,840 --> 00:17:36,380
and it sits a fifth of a turn around the unit circle.

302
00:17:36,780 --> 00:17:41,340
So its angle is 2 pi fifths radians, and its magnitude is one.

303
00:17:42,060 --> 00:17:44,400
This means with the standard Euler's formula notation,

304
00:17:44,600 --> 00:17:49,360
we would write that number explicitly as e to the power 2 pi i divided by 5.

305
00:17:49,640 --> 00:17:51,360
If you're not as comfortable with that notation,

306
00:17:51,360 --> 00:17:55,840
you could think of it as something whose real part is the cosine of 72 degrees,

307
00:17:56,260 --> 00:18:01,560
72 being a fifth of a full turn, and the imaginary part is the sine of 72 degrees.

308
00:18:02,540 --> 00:18:05,940
But to be honest, you don't actually need to think about the explicit value.

309
00:18:06,200 --> 00:18:10,580
Instead, the important thing to focus on is the property that powers of this number have.

310
00:18:11,100 --> 00:18:14,240
For example, when you square it, because its magnitude was one,

311
00:18:14,520 --> 00:18:19,060
the magnitude of its square is also one, but it rotates a fifth of a turn around the unit circle,

312
00:18:19,060 --> 00:18:21,180
so it now sits two fifths of a turn around.

313
00:18:22,280 --> 00:18:26,020
Similarly, when you raise it to the third power, you end up three fifths of a turn around,

314
00:18:26,320 --> 00:18:28,600
raise it to the fourth power, you end up four fifths of a turn,

315
00:18:29,080 --> 00:18:32,520
and raise it to the fifth power, and you've gotten all the way back around to one.

316
00:18:32,860 --> 00:18:35,600
It's the same thing as if you had raised it to the zeroth power.

317
00:18:35,800 --> 00:18:39,200
We get this cycling every five terms. That's the thing that we care about.

318
00:18:39,760 --> 00:18:42,840
These numbers have a special name, they're called the fifth roots of unity,

319
00:18:43,580 --> 00:18:47,180
essentially because they solve the equation z to the fifth equals one.

320
00:18:47,180 --> 00:18:49,240
They are fifth roots of the number one.

321
00:18:49,460 --> 00:18:54,760
If you just presented someone with this equation, they would probably say the answer is clearly z equals one.

322
00:18:55,280 --> 00:18:58,520
But the idea is that there are four other answers in the complex plane.

323
00:18:58,980 --> 00:19:01,780
Four other numbers where when you raise them to the fifth, you get one,

324
00:19:02,100 --> 00:19:04,380
and considering them as a collective is often quite useful.

325
00:19:04,880 --> 00:19:07,440
Remember that equation, it'll come back for us a little bit later.

326
00:19:08,700 --> 00:19:13,480
So in analogy with what we did earlier, where we added together f of one and f of negative one

327
00:19:13,480 --> 00:19:16,100
to get this cancellation among the odd terms,

328
00:19:16,100 --> 00:19:19,700
what we're going to do is evaluate f at all five of these numbers,

329
00:19:19,960 --> 00:19:22,900
and then add them together, and hopefully we get some cancellation.

330
00:19:23,240 --> 00:19:26,640
That might seem kind of complicated, but let's just take a super simple example,

331
00:19:26,640 --> 00:19:29,540
like the case where f of x is simply equal to x.

332
00:19:30,000 --> 00:19:34,160
In that case, when we add up these five terms, we're just adding up the roots of unity themselves.

333
00:19:34,520 --> 00:19:37,680
Zeta to the zero plus zeta to the one, on and on, up to zeta to the fourth.

334
00:19:38,240 --> 00:19:42,480
When you add complex numbers, you can think of it like vector addition with the tip to the tail.

335
00:19:42,900 --> 00:19:46,060
So zeta to the zero plus zeta will look like this,

336
00:19:46,360 --> 00:19:47,980
and then if I add on zeta squared,

337
00:19:48,500 --> 00:19:52,280
bringing the tail of that vector to the tip of the last one, we get this.

338
00:19:52,980 --> 00:19:56,560
Then similarly, if I bring the tail of zeta cubed over to the tip of that one,

339
00:19:57,100 --> 00:19:59,020
and then do likewise for zeta to the fourth,

340
00:19:59,600 --> 00:20:02,820
you'll see how the overall sum actually loops back to be zero.

341
00:20:03,360 --> 00:20:05,920
Another way to think about this is that all five of these terms

342
00:20:05,920 --> 00:20:08,320
are evenly balanced around the number zero.

343
00:20:08,880 --> 00:20:10,620
Their center of mass is at the origin.

344
00:20:11,700 --> 00:20:14,500
Now it's helpful to think about a slightly less trivial example,

345
00:20:14,500 --> 00:20:16,460
if f of x was x squared.

346
00:20:17,360 --> 00:20:20,020
So when you square zeta to the zero, it stays zeta to the zero.

347
00:20:20,260 --> 00:20:21,980
This is just a fancy way of saying the number one.

348
00:20:22,640 --> 00:20:24,980
When you square zeta, you get zeta squared itself.

349
00:20:25,440 --> 00:20:30,240
So you might imagine this dot up here moving over to the zeta squared dot when we do it.

350
00:20:30,720 --> 00:20:32,680
Zeta squared moves to zeta to the fourth.

351
00:20:33,200 --> 00:20:35,760
You might imagine this dot moving over to zeta to the fourth.

352
00:20:36,580 --> 00:20:38,800
Zeta cubed moves to zeta to the sixth,

353
00:20:38,800 --> 00:20:42,940
which, because we loop around every five times, is the same thing as zeta to the one.

354
00:20:43,420 --> 00:20:44,880
So this dot will move up here.

355
00:20:46,420 --> 00:20:49,780
And finally, zeta to the fourth squares to give us zeta to the eighth,

356
00:20:50,020 --> 00:20:54,600
which reduces to be the same as zeta cubed, which I might draw like this.

357
00:20:55,560 --> 00:20:57,520
That might seem a little confusing to think about,

358
00:20:57,640 --> 00:20:59,660
especially with all the arrows I have drawn here,

359
00:20:59,660 --> 00:21:01,900
but it's worth thinking through at least once in your life,

360
00:21:01,960 --> 00:21:04,300
because the idea here is that when we square this,

361
00:21:04,620 --> 00:21:06,200
like go to all of these different terms,

362
00:21:06,200 --> 00:21:08,940
and I program them to double the angle that they have,

363
00:21:09,480 --> 00:21:11,660
the overall effect is to just shuffle those terms.

364
00:21:12,000 --> 00:21:14,220
We get the same numbers but written in a different order,

365
00:21:14,480 --> 00:21:16,200
so their sum is still going to be zero.

366
00:21:16,960 --> 00:21:19,920
Similarly, if you go through this exercise with x cubed,

367
00:21:20,020 --> 00:21:21,520
which I encourage you to do,

368
00:21:21,700 --> 00:21:24,900
and you follow around where are each one of these dots going to end up,

369
00:21:25,280 --> 00:21:27,380
you'll be able to see that when we cube these terms,

370
00:21:27,600 --> 00:21:30,700
when we take each one and we multiply the angle that it has by three,

371
00:21:31,280 --> 00:21:32,760
again we just shuffle them around.

372
00:21:33,140 --> 00:21:34,880
Same terms listed in a different order,

373
00:21:34,880 --> 00:21:38,240
unsurprisingly the same thing happens if our function was x to the fourth,

374
00:21:41,780 --> 00:21:46,420
but, critically, where things change is if we consider the function x to the fifth.

375
00:21:47,060 --> 00:21:49,760
In that case, when you raise zeta to the fifth power,

376
00:21:50,240 --> 00:21:51,820
by definition it goes to one.

377
00:21:52,540 --> 00:21:55,200
Similarly, zeta squared raised to the fifth power goes to one.

378
00:21:55,560 --> 00:21:57,960
All of these go to one, they are the roots of unity,

379
00:21:57,980 --> 00:21:59,940
this is after all their whole purpose in life.

380
00:22:00,440 --> 00:22:03,520
So in this case, when we apply the function and add them all up,

381
00:22:03,520 --> 00:22:05,940
instead of going to zero and getting cancellation,

382
00:22:06,280 --> 00:22:08,380
we get a kind of constructive interference.

383
00:22:08,780 --> 00:22:11,440
All of them equal one, so their sum is equal to five.

384
00:22:12,060 --> 00:22:15,060
So if you step back and think about what all those examples mean,

385
00:22:15,600 --> 00:22:18,380
essentially this expression is something that will go to zero

386
00:22:18,380 --> 00:22:21,100
for powers of x which are not divisible by five,

387
00:22:21,400 --> 00:22:25,480
but it goes to something non-zero for powers of x which are divisible by five.

388
00:22:25,900 --> 00:22:28,380
And that's exactly the kind of filter that we're looking for.

389
00:22:29,020 --> 00:22:32,040
If you're worried that our actual function is much more complicated

390
00:22:32,040 --> 00:22:33,460
than a simple power of x,

391
00:22:33,900 --> 00:22:37,000
essentially things play really nicely here because everything is linear.

392
00:22:37,700 --> 00:22:41,300
If f is some massive polynomial and we want to evaluate this big sum,

393
00:22:41,880 --> 00:22:43,960
you could sort of think of going column by column,

394
00:22:46,780 --> 00:22:50,000
where each time you really are just adding up powers of zeta,

395
00:22:50,360 --> 00:22:54,000
and in most cases all those powers cancel out with each other and you get zero,

396
00:22:54,380 --> 00:22:56,520
but when all of those powers are multiples of five,

397
00:22:56,820 --> 00:22:59,920
they constructively interfere and instead you get five times

398
00:22:59,920 --> 00:23:01,920
whatever the corresponding coefficient is.

399
00:23:02,040 --> 00:23:05,100
Deep in the weeds it's easy to forget why we're here in the first place,

400
00:23:05,360 --> 00:23:08,080
but remember each one of those coefficients tells us

401
00:23:08,080 --> 00:23:10,440
how many subsets add up to a certain value,

402
00:23:10,920 --> 00:23:14,980
and so what we want is to add up all of the coefficients that are multiples of five,

403
00:23:15,380 --> 00:23:18,540
and what we have right now is a way to explicitly do that.

404
00:23:18,800 --> 00:23:21,940
If we evaluate this function on these five different roots of unity,

405
00:23:22,200 --> 00:23:23,600
which I know seems kind of weird,

406
00:23:23,780 --> 00:23:27,540
then all we have to do is divide by five and it gives us the sum that we want.

407
00:23:28,480 --> 00:23:30,220
That's really cool if you ask me.

408
00:23:30,220 --> 00:23:33,720
We have a question that's just about subsets, it's a discrete math problem,

409
00:23:34,180 --> 00:23:38,460
and yet the way that we can answer it is to evaluate a crazy polynomial

410
00:23:38,460 --> 00:23:41,040
on some judiciously chosen complex numbers.

411
00:23:41,520 --> 00:23:43,500
The more math you do the less crazy that seems,

412
00:23:43,660 --> 00:23:46,800
because complex numbers have this bizarre relationship with discrete math,

413
00:23:46,920 --> 00:23:49,480
but it really is wonderful, there's no two ways about it.

414
00:23:50,340 --> 00:23:53,700
However, some of you might complain, the only way that this is useful

415
00:23:53,700 --> 00:23:58,100
is if we can actually evaluate this wild expression on our polynomial.

416
00:23:58,620 --> 00:24:02,160
Remember, the form of the polynomial we know, the one we're comfortable with,

417
00:24:02,180 --> 00:24:05,020
is the factored form, where you have this one plus x,

418
00:24:05,300 --> 00:24:08,520
one plus x squared, on and on, all the way up to one plus x to the two thousand.

419
00:24:09,220 --> 00:24:12,260
Everything up to this point is just meaningless symbolic play,

420
00:24:12,600 --> 00:24:14,660
pushing around one hard problem into another,

421
00:24:15,000 --> 00:24:18,420
unless we can actually roll up our sleeves and do some honest calculation here.

422
00:24:18,900 --> 00:24:22,320
This is the final thrust in our argument, so step back, take a deep breath.

423
00:24:22,700 --> 00:24:24,600
It's actually not as bad as you might think,

424
00:24:24,740 --> 00:24:27,360
but let's start just by thinking about how you might evaluate

425
00:24:27,360 --> 00:24:30,780
just one of the roots of unity that we need, maybe zeta itself.

426
00:24:31,780 --> 00:24:34,960
So what that looks like is one plus zeta, times one plus zeta squared,

427
00:24:35,100 --> 00:24:36,820
times one plus zeta cubed, on and on.

428
00:24:37,060 --> 00:24:39,800
Except, importantly, after those first five terms,

429
00:24:40,040 --> 00:24:42,700
everything starts repeating, because powers of zeta repeat.

430
00:24:43,220 --> 00:24:45,940
The entire expression up to two thousand is basically

431
00:24:45,940 --> 00:24:49,120
just going to be a copy of this expression four hundred times.

432
00:24:49,600 --> 00:24:51,760
It still might seem hard to evaluate this expression,

433
00:24:51,900 --> 00:24:55,280
but it's way easier than multiplying out two thousand different terms.

434
00:24:55,280 --> 00:24:59,240
A way you might visualize this is that we're taking each one of those roots of unity,

435
00:24:59,720 --> 00:25:02,540
but basically adding one, we're shifting them all to the right.

436
00:25:03,060 --> 00:25:06,020
This picture actually lends itself to a really nice geometric intuition

437
00:25:06,020 --> 00:25:08,360
for the numerical answer that we might expect.

438
00:25:08,880 --> 00:25:12,940
The thing that we want is the product of these five different complex numbers,

439
00:25:13,160 --> 00:25:14,260
these five yellow dots.

440
00:25:14,820 --> 00:25:16,900
And if you know a thing or two about complex numbers,

441
00:25:17,140 --> 00:25:18,660
since these come in conjugate pairs,

442
00:25:18,960 --> 00:25:23,020
all we really need is to multiply the lengths of these five yellow lines.

443
00:25:23,680 --> 00:25:28,600
For example, that dot furthest to the right corresponds to one plus zeta to the fifth,

444
00:25:28,960 --> 00:25:32,220
which in the diagram I'm labeling as zeta to the zero plus one.

445
00:25:32,720 --> 00:25:36,440
But it doesn't matter, in either case, they're both just fancy ways of writing the number two.

446
00:25:36,980 --> 00:25:40,840
Next to that, we have the values one plus zeta and one plus zeta to the fourth,

447
00:25:41,320 --> 00:25:44,600
both of which have the same magnitude, the lengths of these lines are the same.

448
00:25:44,940 --> 00:25:46,680
And let's just give that a name, L1.

449
00:25:47,080 --> 00:25:50,280
So we need to multiply two different copies of that length, L1 squared.

450
00:25:51,020 --> 00:25:55,320
Similarly, the remaining two values, zeta squared plus one and zeta cubed plus one,

451
00:25:55,720 --> 00:25:58,160
they also have the same length, and they're a conjugate pair.

452
00:25:58,580 --> 00:26:00,200
So let's just call that length L2.

453
00:26:00,880 --> 00:26:03,800
So our product needs to include two copies of that L2.

454
00:26:04,340 --> 00:26:06,320
If we were just making a loose heuristic guess,

455
00:26:06,520 --> 00:26:10,500
you might notice that L1 is a length that's something a little bit longer than one,

456
00:26:10,840 --> 00:26:13,680
and L2 is something a little bit shorter than one.

457
00:26:13,960 --> 00:26:17,700
So the final answer here probably comes to something around two-ish,

458
00:26:17,960 --> 00:26:19,700
we're not positive, but something in that ballpark.

459
00:26:19,700 --> 00:26:24,140
To turn this into an exact answer, we could just expand out the full expression.

460
00:26:24,520 --> 00:26:27,420
It's honestly not that bad, there's only 32 different terms.

461
00:26:33,320 --> 00:26:37,020
Okay, you've hung with me for a long time now, and I know that it's getting to be a lot.

462
00:26:37,280 --> 00:26:39,480
But there's one final trick in this whole argument

463
00:26:39,480 --> 00:26:42,680
that makes our last step much simpler than you might think it should be.

464
00:26:43,260 --> 00:26:45,620
And let's just recap to remind ourselves of where we are.

465
00:26:45,820 --> 00:26:47,540
So we started with this question asking us,

466
00:26:47,540 --> 00:26:52,280
count the number of subsets of 1 up to 2000 whose sum is divisible by 5.

467
00:26:52,740 --> 00:26:55,920
We then constructed this polynomial whose coefficients tell us

468
00:26:55,920 --> 00:26:59,040
how many subsets have a particular sum for each value n.

469
00:26:59,960 --> 00:27:03,620
So what we want is to add up every fifth coefficient of that polynomial.

470
00:27:04,780 --> 00:27:09,600
Then we saw how evaluating this polynomial as a function on all of the fifth roots of unity,

471
00:27:09,820 --> 00:27:13,340
then adding them up, ends up giving us exactly this filter that we want.

472
00:27:13,600 --> 00:27:16,640
And here we're evaluating just one of those terms, f of zeta,

473
00:27:16,640 --> 00:27:19,800
which essentially comes down to a product of five complex numbers.

474
00:27:20,540 --> 00:27:24,640
As a super slick way to actually evaluate that product, here's the final trick.

475
00:27:25,320 --> 00:27:27,820
Remember, I described these numbers as roots of unity.

476
00:27:28,200 --> 00:27:30,580
They solve the equation z to the fifth equals one.

477
00:27:31,060 --> 00:27:36,180
Another way to think about that is that they are roots of the polynomial z to the fifth minus one.

478
00:27:36,920 --> 00:27:42,320
Now what that means is we can factor the polynomial z to the fifth minus one to look like this,

479
00:27:42,720 --> 00:27:45,300
where there's one factor corresponding to each one of the roots.

480
00:27:45,300 --> 00:27:47,160
You take z minus each one of the roots.

481
00:27:47,840 --> 00:27:51,140
This expression is kind of magical when you think about all of the crazy cancellation

482
00:27:51,140 --> 00:27:56,780
that has to happen when you expand it all out, but it is true and it's super useful for us right now,

483
00:27:56,940 --> 00:28:00,260
because the expression on the right hand side looks almost identical

484
00:28:00,260 --> 00:28:02,880
to the thing we need to evaluate up at the top here.

485
00:28:03,300 --> 00:28:06,360
It basically just has minus signs where we wish there were plus signs.

486
00:28:07,680 --> 00:28:10,240
The trick is to plug in z equals negative one.

487
00:28:10,800 --> 00:28:13,900
If you do that, you essentially have the negative of what we want.

488
00:28:13,900 --> 00:28:18,280
If you multiply it by negative one, notice how the left hand side here,

489
00:28:18,420 --> 00:28:22,520
which started out as negative one minus one or negative two, that just becomes two.

490
00:28:23,240 --> 00:28:26,320
And then the right hand side turns into the thing that we want to evaluate.

491
00:28:27,000 --> 00:28:30,020
So just as our geometric intuition earlier might have suggested,

492
00:28:30,420 --> 00:28:35,500
not only is the answer around two, the answer quite magically turns out to be precisely two.

493
00:28:36,380 --> 00:28:41,020
That is actually super nice and very lovely, because it means this bigger expression that

494
00:28:41,020 --> 00:28:44,800
we want to evaluate, where we're adding up f on all of the different roots of unity,

495
00:28:45,240 --> 00:28:49,220
we know its value on the first root of unity. It will be two to the power four hundred.

496
00:28:49,820 --> 00:28:53,660
Essentially identical reasoning shows that its value on the next three roots of unity

497
00:28:53,660 --> 00:28:57,900
is also two to the power four hundred, because remember when you take powers of zeta squared

498
00:28:57,900 --> 00:29:02,180
or zeta cubed, you get the same list of numbers that are just shuffled in a different order.

499
00:29:02,880 --> 00:29:06,120
The only one that's different is when we evaluate it as zeta to the zero.

500
00:29:06,840 --> 00:29:09,840
But zeta to the zero is a fancy way of saying the number one,

501
00:29:09,840 --> 00:29:13,900
and we know how to evaluate this at one. That's one of the easy things. We did this earlier.

502
00:29:14,200 --> 00:29:18,860
All of these parentheticals turn into two, so it looks like taking two multiplied by itself

503
00:29:18,860 --> 00:29:24,980
two thousand times. And so finally with that, we have a highly explicit honest answer to our

504
00:29:24,980 --> 00:29:29,280
counting question. To add up all of these coefficients which are divisible by five,

505
00:29:29,680 --> 00:29:34,400
which remember is a way of counting how many total subsets have a sum divisible by five,

506
00:29:34,400 --> 00:29:40,680
the answer is one fifth of this weird complex expression, which we just computed to be two to

507
00:29:40,680 --> 00:29:46,360
the two thousand plus four different copies of two to the four hundred. And here you might want

508
00:29:46,360 --> 00:29:51,100
to do just a quick sanity check on does this answer make any sense. For example, if you do

509
00:29:51,100 --> 00:29:55,420
it in the smaller case with the set one two three four five, and you walk through all the same

510
00:29:55,420 --> 00:30:00,060
reasoning that we just did, it tells you that the answer is one fifth of two to the fifth,

511
00:30:00,060 --> 00:30:05,960
the total number of subsets, plus four times two to the one in this case, which is a fifth of 32

512
00:30:05,960 --> 00:30:11,460
plus eight, which is eight. And if you'll remember when we explicitly looked at them all, that was in

513
00:30:11,460 --> 00:30:21,260
fact the answer. Look, this is a hard puzzle, and when it's worth putting in the time to solve a

514
00:30:21,260 --> 00:30:30,040
hard problem, it's also worth taking some time to reflect on it. What do you get out of this? What's

515
00:30:30,040 --> 00:30:34,500
indeed one fifth of all the total subsets like we might have guessed, and how this error term came

516
00:30:34,500 --> 00:30:39,300
about from the not quite destructive interference in a massive combination of roots of unity.

517
00:30:40,120 --> 00:30:45,400
But again, what makes this question interesting is not the answer, it's the way that we solved it,

518
00:30:45,500 --> 00:30:50,140
namely taking a discrete sequence that we want to understand and treating it as the coefficients

519
00:30:50,140 --> 00:30:57,380
on a polynomial, then evaluating that polynomial on complex values. Both of those steps are probably

520
00:30:57,380 --> 00:31:01,940
highly unexpected at the outset, but both of those steps relate to some very general and

521
00:31:01,940 --> 00:31:06,440
powerful techniques that you'll find elsewhere in math. For example, at the top of the lesson,

522
00:31:06,680 --> 00:31:11,540
I promised that the technique that we would use would be similar in spirit to the way that primes

523
00:31:11,540 --> 00:31:16,120
are studied, and the set of ideas that leads up to the Riemann hypothesis and things like that.

524
00:31:16,500 --> 00:31:21,240
Now this is a very beautiful topic, enough so that I think it seems a little criminal to cram some

525
00:31:21,240 --> 00:31:26,740
kind of rushed version into the end here. The right thing to do, I think, is to just make that video I

526
00:31:26,740 --> 00:31:31,720
promised a while back about the zeta function, take the time, do it right. But if you're curious,

527
00:31:31,960 --> 00:31:36,020
and if you'll allow me to throw some things up on the screen without explaining them, here's the two

528
00:31:36,020 --> 00:31:40,980
or three sentence version of how the two are parallel. Just like our subsets puzzle, the way

529
00:31:40,980 --> 00:31:45,680
that Riemann studied primes involved a discrete sequence we want to understand, something carrying

530
00:31:45,680 --> 00:31:51,240
information about prime numbers, and then considering a function whose coefficients are the

531
00:31:51,240 --> 00:31:56,360
terms in that sequence. In that case, it's not quite a polynomial, instead it's a related structure

532
00:31:56,360 --> 00:32:01,020
known as a Dirichlet series, or Dirichlet series depending on who you ask, but it's the same

533
00:32:01,020 --> 00:32:07,520
essential idea. Then the way to suss out information about those coefficients comes from studying how

534
00:32:07,520 --> 00:32:13,940
this function behaves with, you guessed it, complex valued inputs. The techniques in his case get a

535
00:32:13,940 --> 00:32:19,440
lot more sophisticated, after all Riemann was a pioneer in complex analysis, but the fact remains

536
00:32:19,440 --> 00:32:25,000
extending your domain beyond real numbers like this offers you, the mathematician, a lot more

537
00:32:25,000 --> 00:32:30,500
power in making deductions about the coefficients. For some viewers this all might leave the lingering

538
00:32:30,500 --> 00:32:37,060
question of why exactly complex numbers are so unreasonably useful in this way. It's a hard

539
00:32:37,060 --> 00:32:42,020
question to answer exactly, but if you think about our puzzle, everything we just did, as soon as we

540
00:32:42,020 --> 00:32:46,220
were in this situation where plugging in different inputs revealed hidden information about the

541
00:32:46,220 --> 00:32:51,740
coefficients, it's sort of like the more inputs you can work with the better, so you might as well

542
00:32:51,740 --> 00:32:57,440
open yourself up to a richer space of numbers like the complex plane. But there is a more specific

543
00:32:57,440 --> 00:33:02,380
intuition that I want you to come away with here. In our puzzle the relevant fact that we wanted,

544
00:33:02,640 --> 00:33:08,520
the sum of every fifth coefficient, was a kind of frequency question, and the real reason the complex

545
00:33:08,520 --> 00:33:13,580
numbers as opposed to some other structure proved to be useful for us is that we could find a value

546
00:33:13,580 --> 00:33:18,880
so that successive products have this cycling behavior. This use of values on the unit circle

547
00:33:18,880 --> 00:33:24,140
and roots of unity in particular to suss out frequency information is extremely fruitful.

548
00:33:24,400 --> 00:33:30,260
It is almost impossible to overstate how helpful that idea is. Just to give one out of thousands of

549
00:33:30,260 --> 00:33:36,460
examples, in the 1990s Peter Shor found a way for quantum computers to factor large numbers way way

550
00:33:36,460 --> 00:33:41,400
faster than classical computers can. And if you go in and you look at the details of how what we now

551
00:33:41,400 --> 00:33:47,640
call Shor's algorithm works, the idea is essentially this, the use of roots of unity to detect a kind

552
00:33:47,640 --> 00:33:52,320
of frequency information. More generally this is the core idea that underlies Fourier transforms

553
00:33:52,320 --> 00:33:57,680
and Fourier series and the infinite swell of topics that follow from those. As to the topic

554
00:33:57,680 --> 00:34:02,120
of generating functions themselves, we've really only just scratched the surface here, and if you

555
00:34:02,120 --> 00:34:07,160
want to learn more I highly recommend this kind of hilariously named book Generating Functionology

556
00:34:07,160 --> 00:34:11,760
by Herbert Wilf. And I'll also leave up a few fun puzzles on the screen here for anyone who wants to

557
00:34:11,760 --> 00:34:13,500
flex their muscles a bit with the idea.

